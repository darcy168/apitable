(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2436],{742436:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return Hn}});var n=t(552322),i=t(351253),o=t(202784),a=t(449857),s=t(323440),l=t(829051),c=t(187872),d=t(798788),u=t(745680),p=t(178234),h=t(960946),f=t(470865),m=t(914463),g=function(e){return e.map((function(e){return{value:"triggerTypeId"in e?e.triggerTypeId:e.actionTypeId,label:e.name,prefixIcon:(0,o.createElement)("img",{src:(0,s.integrateCdnHost)(e.service.logo),style:{width:"16px",height:"16px"}},null)}}))},x=function(e,r){var t={title:"\u5217\u5c5e\u6027",type:"object",properties:{}};return e.forEach((function(e){var n=s.Field.bindModel(e).openValueJsonSchema;t.properties[e.id]=(0,f.Z)({},n,function(e){var t=s.Selectors.getFieldRoleByFieldId(r,e.id)===s.ConfigConstant.Role.None;return{title:t?(0,s.t)(s.Strings.robot_variables_cant_view_field):e.name,disabled:t}}(e))})),t},y=function(e,r){var t=e;return(null===m.isWecomFunc||void 0===m.isWecomFunc?void 0:(0,m.isWecomFunc)())&&t&&(t=t.filter((function(e){return!["sendLarkMsg","sendDingtalkMsg"].includes(e.endpoint)||e.actionTypeId===r}))),t},v=t(151269),b=t(561666),_=t(789644),j=t.n(_),S=t(996670),C=t(223258),w=t(850930),T=t(676665),O=t(469716),I=t(581938),k=new s.MagicVariableParser(s.ACTION_INPUT_PARSER_BASE_FUNCTIONS),A=new s.InputParser(k),Z={length:(0,s.t)(s.Strings.robot_variables_array_length),JSONStringify:(0,s.t)(s.Strings.robot_variables_stringify_json),flatten:(0,s.t)(s.Strings.robot_variables_array_flatten)},F=function(e){var r=e.schema,t=e.expression,n=e.isJSONField;return r.properties?Object.keys(r.properties).map((function(e){var i=r.properties[e];return function(e){var r=e.expression,t=e.propertySchema,n=e.key,i=e.isJSONField,o=["string","number","boolean"].includes(t.type.toString()),a=i&&"string"===t.type||["array","object"].includes(t.type.toString());"array"===t.type&&(o=["string","number","boolean"].includes(t.items.type));var l={operator:s.OperatorEnums.GetObjectProperty,operands:[{type:s.OperandTypeEnums.Expression,value:r},{type:s.OperandTypeEnums.Literal,value:[n]}]};return{key:n,label:t.title,schema:t,disabled:t.disabled,expression:l,hasChildren:a,canInsert:o}}({expression:t,propertySchema:i,key:e,isJSONField:n})})):[]},E=function(e){var r=e.schema,t=e.shouldFlatten,n=e.isJSONField,i=e.expression,o=r.items,a={key:"length",label:(0,s.t)(s.Strings.robot_variables_array_length),schema:o,expression:{operator:s.OperatorEnums.Length,operands:[{type:s.OperandTypeEnums.Expression,value:i}]},hasChildren:!1,canInsert:!0,isPrototype:!0},l=[];if(t&&(i={operator:s.OperatorEnums.Flatten,operands:[{type:s.OperandTypeEnums.Expression,value:i}]}),["array","object"].includes(o.type.toString())){var c,d;if("object"===o.type)(c=l).push.apply(c,(0,w.Z)(F({expression:i,schema:o,isJSONField:n})));if("array"===o.type)(d=l).push.apply(d,(0,w.Z)(E({expression:i,schema:o,shouldFlatten:!0,isJSONField:n})))}return t||l.push(a),l},N=function(e){var r=e.schemaExpressionList,t=e.nodeOutputSchemaList,n=e.isJSONField,i=void 0!==n&&n;if(0===r.length)return t.map((function(e){var r=e.id,t=e.title,n=e.schema;return{key:r,label:t,schema:n,uiSchema:e.uiSchema,expression:{operator:s.OperatorEnums.GetNodeOutput,operands:[{type:s.OperandTypeEnums.Literal,value:r}]},canInsert:!1,disabled:!n,hasChildren:Boolean((null===n||void 0===n?void 0:n.properties)&&Object.keys(null===n||void 0===n?void 0:n.properties).length>0)}}));var o=r[r.length-1],a=o.schema,l=o.expression;return function(e){var r=e.schema,t=e.expression,n=e.key,i=e.isJSONField,o=void 0!==i&&i;if(!r)return o&&t?[{key:n,label:Z[t.operator],schema:r,disabled:!1,expression:t,hasChildren:!1,canInsert:!0}]:[];switch(r.type){case"string":case"number":case"boolean":var a={operator:s.OperatorEnums.GetObjectProperty,operands:[{type:s.OperandTypeEnums.Expression,value:t},{type:s.OperandTypeEnums.Literal,value:[n]}]};return[{key:n,label:r.title,schema:r,disabled:r.disabled,expression:a,hasChildren:!1,canInsert:!0}];case"array":return E({expression:t,schema:r,isJSONField:o});case"object":return F({expression:t,schema:r,isJSONField:o});default:return[]}}({schema:a,uiSchema:o.uiSchema,expression:l,isJSONField:i})},B=function(e){var r=[];switch(e.operator){case"getObjectProperty":var t,n=e.operands[1].value.map((function(e){return{type:"property",name:e,value:e}}));(t=r).push.apply(t,(0,w.Z)(n).concat((0,w.Z)(B(e.operands[0].value))));break;case"getNodeOutput":r.push({type:"function",name:e.operator,value:e.operands[0].value});break;case"JSONStringify":case"length":case"uppercase":case"lowercase":case"capitalize":case"trim":case"flatten":var i;(i=r).push.apply(i,[{type:"function",name:Z[e.operator],value:e.operator}].concat((0,w.Z)(B(e.operands[0].value))))}return r},D=function(e){return function(e){return"object"===typeof e&&"Expression"===e.type}(e)?function(e){var r=[];return e.value.operands.forEach((function(e){var t={type:"paragraph",children:[]};e.value.operands.forEach((function(e){switch(e.type){case s.OperandTypeEnums.Literal:t.children.push({text:e.value});break;case s.OperandTypeEnums.Expression:t.children.push({type:"magicVariable",data:e.value,children:[{text:""}]})}})),r.push(t)})),r}(e):[{type:"paragraph",children:[{text:function(e){return"object"===typeof e&&"Literal"===e.type}(e)&&e.value||""}]}]},R=function(e){var r=function(e){var r=function(e){return"magicVariable"===(null===e||void 0===e?void 0:e.type)||("paragraph"===(null===e||void 0===e?void 0:e.type)?e.children.some((function(e){return r(e)})):void 0)};return e.some((function(e){return r(e)}))}(e),t={type:s.OperandTypeEnums.Expression,value:{operator:"concatParagraph",operands:[]}};if((e.forEach((function(e){t.value.operands.push(function(e){var r={type:s.OperandTypeEnums.Expression,value:{operator:"concatString",operands:[]}};return e.children.forEach((function(e){"magicVariable"===e.type?r.value.operands.push({type:s.OperandTypeEnums.Expression,value:e.data}):r.value.operands.push({type:s.OperandTypeEnums.Literal,value:e.text})})),r}(e))})),!r)&&0===A.render(t,{}).length)return{isMagicVariable:r,value:JSON.parse(JSON.stringify(s.EmptyNullOperand))};return{isMagicVariable:r,value:t}},P=function(e,r,t){return(0,T.ZP)(e,(function(e){var n=x(r,t);return e.schema.properties=(0,f.Z)({},e.schema.properties,n.properties),e.uiSchema={layout:[{title:(0,s.t)(s.Strings.robot_variables_select_columns),items:Object.keys(n.properties)},{title:(0,s.t)(s.Strings.robot_variables_select_basics),items:["recordId","recordUrl","datasheetId","datasheetName"]}]},e}))},M=t(165846),L=function(e){var r=e.element,t=e.children,o=(0,i.useTheme)(),a=e.nodeOutputSchemaList,l=B(r.data).reverse(),c=a.findIndex((function(e){return e.id===l[0].value})),d=a[c],u=[{type:"property",title:(0,s.t)(s.Strings.robot_inserted_variable_part_1,{number:c+1})}],p=null===d||void 0===d?void 0:d.schema,h=!1,m=function(e){if("function"!==e.type){if(p)switch(p.type){case"object":if(!(p=p.properties[e.value]))return h=!0,void u.push({type:"property",title:(0,s.t)(s.Strings.robot_inserted_variable_invalid)});u.push({type:"property",title:p.title});break;case"array":p=p.items,["number","string","boolean"].includes(p.type)?u.push({type:"property",title:p.title}):m(e);break;case"string":case"number":case"boolean":u.push({type:"property",title:p.title})}}else u.push({type:"function",title:e.name})};return l.slice(1).forEach((function(e){m(e)})),(0,n.jsxs)(i.Box,{contentEditable:"false",display:"inline-flex",margin:"0 2px",verticalAlign:"middle",children:[u.map((function(e,r){var t=0===r,a=r===u.length-1;return(0,n.jsxs)(i.Box,(0,S.Z)((0,f.Z)({display:"inline-flex",alignItems:"center",backgroundColor:h?o.color.red[50]:o.color.deepPurple[50],height:"24px",borderRadius:t?"2px 0px 0px 2px":a?"0px 2px 2px 0px":"0",padding:"2px 4px"},function(){var e={borderTop:"1px solid ".concat(o.color.black[200]),borderBottom:"1px solid ".concat(o.color.black[200])};return t&&(e.borderLeft="1px solid ".concat(o.color.black[200])),a?e.borderRight="1px solid ".concat(o.color.black[200]):e.boxShadow="inset -1px 0px 0px ".concat(o.color.deepPurple[100]),e}()),{children:[t&&(0,n.jsx)(M.FormOutlined,{color:h?o.color.red[500]:o.color.deepPurple[500]}),(0,n.jsx)(i.Typography,{variant:"body3",color:h?o.color.red[500]:o.color.deepPurple[500],children:e.title},r)]}),r)})),t]})},W=t(147412),V=t(552088),U=t(220672),q=t(190772),J=function(e){var r=e.item,t=e.isActive,a=e.disabled,l=e.handleItemClick,c=(0,i.useTheme)(),d=(0,o.useRef)(null),u=(0,q.Z)(d);return(0,n.jsx)(i.Box,{ref:d,children:(0,n.jsx)(i.ListDeprecate.Item,{id:r.key,currentIndex:0,style:{backgroundColor:t?c.color.fc5:u?c.color.highBg:c.color.fc8,borderRadius:"4px"},className:t?"active":"",onClick:function(e){a||((0,i.stopPropagation)(e),l(r))},children:(0,n.jsxs)(i.Box,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",style:a?{opacity:.5,cursor:"not-allowed"}:{},children:[r.label,(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[r.canInsert&&(0,n.jsx)(i.Button,{size:"small",color:"primary",style:{padding:"3px 16px",height:"24px",display:"flex",alignItems:"center"},onClick:function(e){a||((0,i.stopPropagation)(e),l(r))},children:(0,s.t)(s.Strings.robot_variables_insert_button)}),r.hasChildren&&(0,n.jsx)(i.Box,{marginLeft:"16px",display:"flex",alignItems:"center",onClick:function(e){a||((0,i.stopPropagation)(e),l(r,!0))},children:(0,n.jsx)(M.ChevronRightOutlined,{})})]})]})},r.key)},r.key)},$=function(e){var r=e.list,t=e.activeIndex,o=e.handleItemClick,a=e.layout,l=r.reduce((function(e,r){return e[r.key]=r,e}),{}),c=(0,i.useTheme)(),d=r.some((function(e){return e.isPrototype}));if(!d&&(!a||!l))return(0,n.jsx)(n.Fragment,{children:r.map((function(e,r){var i=t===r,a=e.disabled;return(0,n.jsx)(J,{isActive:i,disabled:a,item:e,handleItemClick:o},e.key)}))});var u=a||[];if(d){var p=r.filter((function(e){return e.isPrototype})),h=r.filter((function(e){return!e.isPrototype}));u=[],h.length&&u.push({items:h.map((function(e){return e.key})),title:(0,s.t)(s.Strings.robot_variables_join_array_item_property)}),p.length&&u.push({items:p.map((function(e){return e.key})),title:(0,s.t)(s.Strings.robot_variables_more_operations)})}return(0,n.jsx)(n.Fragment,{children:u.map((function(e){var a=e.items,s=e.title;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Typography,{variant:"h9",color:c.color.fc3,style:{marginTop:8,marginBottom:4,marginLeft:8},children:s}),a.map((function(e){var i,a=l[e];if(!a)return null;var s=(null===(i=r[t])||void 0===i?void 0:i.key)===e,c=a.disabled;return(0,n.jsx)(J,{isActive:s,disabled:c,item:a,handleItemClick:o},a.key)}))]})}))})},H=(0,o.forwardRef)((function(e,r){var t=e.nodeOutputSchemaList,a=e.insertMagicVariable,l=e.setOpen,c=e.isJSONField,d=(0,o.useState)([]),u=d[0],p=d[1],h=(0,i.useTheme)(),f=(0,o.useRef)(),m=(0,o.useRef)(),g=(0,o.useState)(""),x=g[0],y=g[1],v=N({schemaExpressionList:u,nodeOutputSchemaList:t,isJSONField:c});v=v.filter((function(e){var r;return null===(r=e.label)||void 0===r?void 0:r.includes(x)})),(0,o.useEffect)((function(){setTimeout((function(){var e;null===(e=f.current)||void 0===e||e.focus()}),100)}),[]),(0,o.useEffect)((function(){x&&y("")}),[u]);var b=(0,o.useCallback)((function(e){u.length&&p(null!=e?(0,w.Z)(u.slice(0,e)):(0,w.Z)(u.slice(0,u.length-1)))}),[u]),_=(0,o.useCallback)((function(e){var r;if(!e.disabled){var t={schema:e.schema,uiSchema:e.uiSchema,expression:e.expression},n="string"===(null===(r=e.schema)||void 0===r?void 0:r.type);if(c&&n)t={schema:void 0,uiSchema:void 0,expression:{operator:s.OperatorEnums.JSONStringify,operands:[{type:s.OperandTypeEnums.Expression,value:e.expression}]}};var i=(0,w.Z)(u).concat([t]);p(i)}}),[c,u]),j=function(e,r){e.disabled||(r&&e.hasChildren?_(e):e.canInsert?a(e.expression):e.hasChildren&&_(e))},S=u.length>0?u[u.length-1].uiSchema:void 0,C=null===S||void 0===S?void 0:S.layout;v=function(e){var r=e.schemaExpressionList,t=e.variableList,n=t.reduce((function(e,r){return e[r.key]=r,e}),{}),i=r.length>0?r[r.length-1].uiSchema:void 0;return i?(null===i||void 0===i?void 0:i.layout).map((function(e){return e.items})).flat().reduce((function(e,r){var t=n[r];return t&&e.push(t),e}),[]):t}({schemaExpressionList:u,variableList:v});var T=(0,i.useSelectIndex)({inputRef:f,containerRef:r,listContainerRef:m,activeItemClass:".active",listLength:v.length,onEnter:function(e){var r=v[e];r&&j(r)},onArrowRightPress:function(e){var r=v[e];r&&r.hasChildren&&_(r)},onArrowLeftPress:function(){b()},onEscapePress:function(){l(!1)}}).index;return(0,n.jsxs)(i.Box,{backgroundColor:h.color.fc8,borderRadius:"8px",border:"1px solid ".concat(h.color.fc5),ref:r,padding:"8px 16px",children:[(0,n.jsx)(i.TextInput,{type:"text",ref:f,block:!0,lineStyle:!0,onChange:function(e){return y(e.target.value)},value:x,placeholder:(0,s.t)(s.Strings.search),prefix:(0,n.jsx)(M.SearchOutlined,{})}),(0,n.jsx)(i.Box,{margin:"8px 0px",children:(0,n.jsxs)(i.Typography,{variant:"body4",style:{marginLeft:8},children:[(0,s.t)(s.Strings.robot_variables_select_step),u.map((function(e,r){var t=e.schema;return(0,n.jsxs)("span",{children:["/",null===t||void 0===t?void 0:t.title]},r)}))]})}),(0,n.jsx)(i.Box,{ref:m,maxHeight:"300px",overflow:"scroll",children:(0,n.jsx)($,{list:v,layout:C,activeIndex:T,handleItemClick:j})})]})})),z=t(563919),G=t.n(z),K=t(612861),Y=function(e){return(0,n.jsx)("p",(0,S.Z)((0,f.Z)({},e.attributes),{children:e.children}))},X={url:(0,s.t)(s.Strings.robot_enter_request_address_placeholder),key:(0,s.t)(s.Strings.robot_enter_key_placeholder),value:(0,s.t)(s.Strings.robot_enter_value_placeholder),data:(0,s.t)(s.Strings.robot_enter_body_text_placeholder),webhookUrl:(0,s.t)(s.Strings.robot_enter_webhook_placeholder),content:(0,s.t)(s.Strings.robot_enter_message_content_placeholder)},Q=function(e){var r=e.onChange,t=e.schema,i="json"===(null===t||void 0===t?void 0:t.format),a=(0,o.useState)(!1),c=a[0],d=a[1],u=(0,o.useRef)(null),p=(0,o.useRef)(),h=(0,o.useRef)(null),m=(0,o.useRef)(null),g=(0,o.useMemo)((function(){return(0,U.VC)(function(e){var r=e.isInline,t=e.isVoid,n=e.onChange;return e.isInline=function(e){return"magicVariable"===e.type||r(e)},e.isVoid=function(e){return"magicVariable"===e.type||t(e)},e.onChange=function(){for(var r=arguments.length,t=new Array(r),i=0;i<r;i++)t[i]=arguments[i];e.selection&&(e.lastSelection=e.selection),n.apply(void 0,(0,w.Z)(t))},e}((0,I.BU)((0,O.Jh)())))}),[]),x=D(e.value),y=(0,o.useState)(x),b=y[0],_=y[1];(0,W.Z)((function(){d(!1)}),m),(0,o.useEffect)((function(){if(!c){var e=g.lastSelection;e&&(O.YR.select(g,e),I.F3.focus(g))}}),[c,g]);var j=(0,o.useCallback)((function(e){var t=R(e).value;r&&r(t)}),[r]),C=(0,o.useCallback)((function(e){return p.current&&clearTimeout(p.current),"/"===e.key&&(O.YR.insertText(g,"/"),e.preventDefault(),p.current=setTimeout((function(){d(!0)}),300),!0)}),[d,g]),T=(0,l.useSelector)(s.Selectors.getActiveDatasheetId),k=(0,l.useSelector)((function(e){return s.Selectors.getFieldPermissionMap(e,T)})),A=(0,v.jf)(),Z=e.nodeOutputSchemaList.map((function(e,r){return 0===r?P(e,A,k):e})),F=e.id.split("_"),E=F[F.length-1];return(0,n.jsx)(I.mH,{editor:g,value:b,onChange:function(e){_(e)},children:(0,n.jsx)("div",{className:G().magicVariableBox,ref:u,onKeyDown:function(e){"Enter"===e.key&&c&&e.preventDefault()},children:(0,n.jsx)(V.default,{ref:h,getPopupContainer:function(){return u.current},popupAlign:{points:["tl","bl"],offset:[-4,8],overflow:{adjustX:!0,adjustY:!0}},popupStyle:{width:"100%"},popup:(0,n.jsx)(H,{ref:m,isJSONField:i,insertMagicVariable:function(e){!function(e,r){setTimeout((function(){var t={type:"magicVariable",data:e,children:[{text:""}]},n=r.lastSelection;n&&(I.F3.focus(r),O.YR.select(r,n),O.YR.delete(r,{distance:1,unit:"character",reverse:!0}),O.YR.insertNodes(r,[t]),O.YR.move(r,{distance:1,unit:"offset"}))}),0)}(e,g),d(!1)},nodeOutputSchemaList:Z,setOpen:d}),popupVisible:c,autoDestroy:!0,destroyPopupOnHide:!0,children:(0,n.jsx)(I.CX,{className:G().editor,onBlur:function(){c||j(b)},renderElement:function(e){return"magicVariable"===e.element.type?(0,n.jsx)(L,(0,S.Z)((0,f.Z)({},e),{nodeOutputSchemaList:Z})):(0,n.jsx)(Y,(0,f.Z)({},e))},onKeyDown:C,placeholder:X[E],onCompositionEnd:function(e){return(0,K.b)(e,g)}})})})})},ee=t(726297),re=t(996577),te=t.n(re),ne=t(413888),ie=t.n(ne),oe=t(347842),ae=t(458013),se=t(542838),le=t(23945),ce=t(901899),de=t(733372),ue=t.n(de),pe=t(500404),he=t(72579),fe=t.n(he),me=t(545455),ge=t.n(me),xe=t(926139),ye=t.n(xe),ve=t(659864);function be(e){var r=e.type,t=void 0===r?"default":r,i=e.icon,o=e.className,a=(0,ee.Z)(e,["type","icon","className"]);return(0,n.jsx)("button",(0,S.Z)((0,f.Z)({type:"button",className:"btn btn-".concat(t," ").concat(o)},a),{children:(0,n.jsx)("i",{className:"glyphicon glyphicon-".concat(i)})}))}function _e(e){var r=e.className,t=e.onClick,i=e.disabled;return(0,n.jsx)("div",{className:"row",children:(0,n.jsx)("p",{className:"col-xs-3 col-xs-offset-9 text-right ".concat(r),children:(0,n.jsx)(be,{type:"info",icon:"plus",className:"btn-add col-xs-12","aria-label":"Add",tabIndex:"0",onClick:t,disabled:i})})})}function je(e){var r=e.TitleField,t=e.idSchema,i=e.title,o=e.required;if(!i)return null;var a="".concat(t.$id,"__title");return(0,n.jsx)(r,{id:a,title:i,required:o})}function Se(e){var r={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold"};return(0,n.jsxs)("div",{className:e.className,children:[(0,n.jsx)("div",{className:e.hasToolbar?"col-xs-9":"col-xs-12",children:e.children}),e.hasToolbar&&(0,n.jsx)("div",{className:"col-xs-3 array-item-toolbox",children:(0,n.jsxs)("div",{className:"btn-group",style:{display:"flex",justifyContent:"space-around"},children:[(e.hasMoveUp||e.hasMoveDown)&&(0,n.jsx)(be,{icon:"arrow-up","aria-label":"Move up",className:"array-item-move-up",tabIndex:"-1",style:r,disabled:e.disabled||e.readonly||!e.hasMoveUp,onClick:e.onReorderClick(e.index,e.index-1)}),(e.hasMoveUp||e.hasMoveDown)&&(0,n.jsx)(be,{icon:"arrow-down",className:"array-item-move-down","aria-label":"Move down",tabIndex:"-1",style:r,disabled:e.disabled||e.readonly||!e.hasMoveDown,onClick:e.onReorderClick(e.index,e.index+1)}),e.hasRemove&&(0,n.jsx)(be,{type:"danger",icon:"remove","aria-label":"Remove",className:"array-item-remove",tabIndex:"-1",style:r,disabled:e.disabled||e.readonly,onClick:e.onDropIndexClick(e.index)})]})})]},e.key)}function Ce(e){return(0,n.jsxs)("fieldset",{className:e.className,id:e.idSchema.$id,children:[(0,n.jsx)(je,{TitleField:e.TitleField,idSchema:e.idSchema,title:e.uiSchema["ui:title"]||e.title,required:e.required},"array-field-title-".concat(e.idSchema.$id)),(e.uiSchema["ui:description"]||e.schema.description)&&(0,n.jsx)("div",{className:"field-description",children:e.uiSchema["ui:description"]||e.schema.description},"field-description-".concat(e.idSchema.$id)),(0,n.jsx)("div",{className:"row array-item-list",children:e.items&&e.items.map(Se)},"array-item-list-".concat(e.idSchema.$id)),e.canAdd&&(0,n.jsx)(_e,{className:"array-item-add",onClick:e.onAddClick,disabled:e.disabled||e.readonly})]})}function we(e){var r=e.DescriptionField,t=e.idSchema,i=e.description;if(!i)return null;var o="".concat(t.$id,"__description");return(0,n.jsx)(r,{id:o,description:i})}function Te(e){return(0,n.jsxs)("fieldset",{className:e.className,id:e.idSchema.$id,children:[(0,n.jsx)(je,{TitleField:e.TitleField,idSchema:e.idSchema,title:e.uiSchema["ui:title"]||e.title,required:e.required},"array-field-title-".concat(e.idSchema.$id)),(e.uiSchema["ui:description"]||e.schema.description)&&(0,n.jsx)(we,{DescriptionField:e.DescriptionField,idSchema:e.idSchema,description:e.uiSchema["ui:description"]||e.schema.description},"array-field-description-".concat(e.idSchema.$id)),(0,n.jsx)("div",{className:"row array-item-list",children:e.items&&e.items.map((function(e){return Se(e)}))},"array-item-list-".concat(e.idSchema.$id)),e.canAdd&&(0,n.jsx)(_e,{className:"array-item-add",onClick:e.onAddClick,disabled:e.disabled||e.readonly})]})}var Oe=t(979162);function Ie(){return(0,Oe.x0)()}function ke(e){var r=e.value.operands.map((function(e){return(0,S.Z)((0,f.Z)({},e),{key:e.key||Ie()})}));return(0,S.Z)((0,f.Z)({},e),{value:(0,S.Z)((0,f.Z)({},e.value),{operands:r})})}function Ae(e){var r=e.value.operands.map((function(e){e.key;var r=(0,ee.Z)(e,["key"]);return(0,f.Z)({},r)}));return(0,S.Z)((0,f.Z)({},e),{value:(0,S.Z)((0,f.Z)({},e.value),{operands:r})})}var Ze={type:"Expression",value:{operator:"newArray",operands:[]}},Fe=function(e){var r=(0,o.useState)({keyedFormData:ke((0,s.isOperandNullValue)(e.formData,e.schema)?JSON.parse(JSON.stringify(Ze)):e.formData),updatedKeyedFormData:!1}),t=r[0],i=r[1],a=function(e){return Array.isArray(e.type)?!e.type.includes("null"):"null"!==e.type},l=function(r){var t=e.schema,n=Jr(e.uiSchema).addable;return!1!==n&&(n=void 0===t.maxItems||r.length<t.maxItems),n},c=function(){var r=e.schema,t=e.registry,n=(void 0===t?Mr():t).rootSchema,i=r.items;return Yr(r)&&Xr(r)&&(i=r.additionalItems),qr(i,void 0,n)},d=function(r){r&&r.preventDefault();var n=e.onChange,o={type:"Expression",value:{operator:"newArray",operands:(0,w.Z)(t.keyedFormData.value.operands).concat([{key:Ie()}])}};i({keyedFormData:o,updatedKeyedFormData:!0}),n(Ae(o))},u=function(r){return function(n){n&&n.preventDefault();var o=e.onChange,a={key:Ie(),item:c()},s=(0,w.Z)(t.keyedFormData);s.splice(r,0,a),i({keyedFormData:s,updatedKeyedFormData:!0}),o(Ae(s))}},p=function(r){return function(n){n&&n.preventDefault();var o,a=e.onChange,l=t.keyedFormData;if(e.errorSchema){o={};var c=e.errorSchema;for(var d in c){var u=parseInt(d);u<r?o[u]=c[u]:u>r&&(o[u-1]=c[u])}}var p=(0,s.removeArrayOperandItemByIndex)(l,r);i({keyedFormData:p,updatedKeyedFormData:!0}),a(Ae(p),o)}},h=function(r,n){return function(o){o&&(o.preventDefault(),o.target.blur());var a,s=e.onChange;if(e.errorSchema){a={};var l=e.errorSchema;for(var c in l)c==r?a[n]=l[r]:c==n?a[r]=l[n]:a[c]=l[c]}var d=t.keyedFormData,u=function(){var e=d.slice();return e.splice(r,1),e.splice(n,0,d[r]),e}();i({keyedFormData:u,updatedKeyedFormData:t.updatedKeyedFormData}),s(Ae(u),a)}},m=function(r){return function(t,n){var o=e.formData,a=e.onChange,l=(0,s.isOperand)(o)?o:{type:"Expression",value:{operator:"newArray",operands:[]}},c="undefined"===typeof t?null:t;l.value.operands[r]=c,i((function(e){var t=e.keyedFormData.value.operands[r];return e.keyedFormData.value.operands[r]=(0,f.Z)({},t,c),e})),a(l,n&&e.errorSchema&&(0,S.Z)((0,f.Z)({},e.errorSchema),(0,oe.Z)({},r,n)))}},g=function(r){e.onChange(r)},x=function(r){var t=r.key,i=r.index,o=r.canRemove,s=void 0===o||o,l=r.canMoveUp,c=void 0===l||l,d=r.canMoveDown,g=void 0===d||d,x=r.itemSchema,y=r.itemData,v=r.itemUiSchema,b=r.itemIdSchema,_=r.itemErrorSchema,j=r.autofocus,S=r.onBlur,C=r.onFocus,w=r.rawErrors,T=e.disabled,O=e.readonly,I=e.uiSchema,k=e.registry,A=(void 0===k?Mr():k).fields.SchemaField,Z=(0,f.Z)({orderable:!0,removable:!0},I["ui:options"]),F=Z.orderable,E={moveUp:F&&c,moveDown:F&&g,remove:Z.removable&&s};return E.toolbar=Object.keys(E).some((function(e){return E[e]})),{children:(0,n.jsx)(A,{index:i,schema:x,uiSchema:v,formData:y,errorSchema:_,idSchema:b,required:a(x),onChange:m(i),onBlur:S,onFocus:C,registry:e.registry,disabled:e.disabled,readonly:e.readonly,autofocus:j,rawErrors:w}),className:"array-item",disabled:T,hasToolbar:E.toolbar,hasMoveUp:E.moveUp,hasMoveDown:E.moveDown,hasRemove:E.remove,index:i,key:t,onAddIndexClick:u,onDropIndexClick:p,onReorderClick:h,readonly:O}},y=e.schema,v=e.uiSchema,b=e.idSchema,_=e.registry,j=void 0===_?Mr():_,C=j.rootSchema;if(!y.hasOwnProperty("items")){var T=j.fields.UnsupportedField;return(0,n.jsx)(T,{schema:y,idSchema:b,reason:"Missing items definition"})}return Yr(y)?function(){var r=e.schema,i=e.uiSchema,o=e.formData,a=e.errorSchema,s=e.idPrefix,c=e.idSchema,u=e.name,p=e.required,h=e.disabled,m=e.readonly,g=e.autofocus,y=e.registry,v=void 0===y?Mr():y,b=e.onBlur,_=e.onFocus,j=e.rawErrors,S=r.title||u,C=e.formData,w=v.ArrayFieldTemplate,T=v.rootSchema,O=v.fields,I=v.formContext,k=O.TitleField,A=r.items.map((function(e,r){return ot(e,T,o[r])})),Z=Xr(r)?ot(r.additionalItems,T,o):null;(!C||C.length<A.length)&&(C=(C=C||[]).concat(new Array(A.length-C.length)));var F={canAdd:l(C)&&Z,className:"field field-array field-array-fixed-items",disabled:h,idSchema:c,formData:o,items:t.keyedFormData.map((function(e,t){var n=e.key,o=e.item,l=t>=A.length,d=l?ot(r.additionalItems,T,o):A[t],u=c.$id+"_"+t,p=pt(d,u,T,o,s),h=l?i.additionalItems||{}:Array.isArray(i.items)?i.items[t]:i.items||{},f=a?a[t]:void 0;return x({rawErrors:j,key:n,index:t,canRemove:l,canMoveUp:t>=A.length+1,canMoveDown:l&&t<C.length-1,itemSchema:d,itemData:o,itemUiSchema:h,itemIdSchema:p,itemErrorSchema:f,autofocus:g&&0===t,onBlur:b,onFocus:_})})),onAddClick:d,readonly:m,required:p,schema:r,uiSchema:i,title:S,TitleField:k,formContext:I,rawErrors:j},E=i["ui:ArrayFieldTemplate"]||w||Ce;return(0,n.jsx)(E,(0,f.Z)({},F))}():Kr(y,v,C)?function(){var r=e.schema,t=e.uiSchema,i=e.idSchema,o=e.name,a=e.disabled,s=e.readonly,l=e.autofocus,c=e.onBlur,d=e.onFocus,u=e.registry,p=void 0===u?Mr():u,h=e.rawErrors,f=r.title||o,m=e.formData,x=p.widgets,y=p.formContext,v=Jr(t),b=v.widget,_=void 0===b?"files":b,j=(0,ee.Z)(v,["widget"]),S=Vr(r,_,x);return(0,n.jsx)(S,{options:j,id:i&&i.$id,multiple:!0,onChange:g,onBlur:c,onFocus:d,schema:r,title:f,value:m,disabled:a,readonly:s,formContext:y,autofocus:l,rawErrors:h})}():Gr(y,C)?function(){var r=e.schema,t=e.idSchema,i=e.uiSchema,o=e.formData,a=e.disabled,s=e.readonly,l=e.required,c=e.placeholder,d=e.autofocus,u=e.onBlur,p=e.onFocus,h=e.registry,m=void 0===h?Mr():h,x=e.rawErrors,y=e.name,v=e.formData,b=m.widgets,_=m.rootSchema,j=m.formContext,C=ot(r.items,_,o),w=r.title||y,T=Qr(C),O=(0,S.Z)((0,f.Z)({},Jr(i)),{enumOptions:T}),I=O.widget,k=void 0===I?"select":I,A=(0,ee.Z)(O,["widget"]),Z=Vr(r,k,b);return(0,n.jsx)(Z,{uiSchema:i,id:t&&t.$id,multiple:!0,onChange:g,onBlur:u,onFocus:p,options:A,schema:r,registry:m,value:v,disabled:a,readonly:s,required:l,label:w,placeholder:c||"",formContext:j,autofocus:d,rawErrors:x})}():function(){var r=e.schema,i=e.uiSchema,o=e.errorSchema,a=e.idSchema,s=e.name,l=e.required,c=e.disabled,u=e.readonly,p=e.autofocus,h=e.registry,m=void 0===h?Mr():h,g=e.onBlur,y=e.onFocus,v=e.idPrefix,b=e.rawErrors,_=void 0===r.title?s:r.title,j=m.ArrayFieldTemplate,S=m.rootSchema,C=m.fields,w=m.formContext,T=C.TitleField,O=C.DescriptionField,I=ot(r.items,S),k=t.keyedFormData,A={canAdd:!0,items:t.keyedFormData.value.operands.map((function(e,n){var s=ot(r.items,S,e),l=e,c=o?o[n]:void 0,d=a.$id+"_"+n,u=pt(s,d,S,l,v);return x({rawErrors:b,key:l.key,index:n,canMoveUp:n>0,canMoveDown:n<t.keyedFormData.value.operands.length-1,itemSchema:s,itemIdSchema:u,itemErrorSchema:c,itemData:l,itemUiSchema:i.items,autofocus:p&&0===n,onBlur:g,onFocus:y})})),className:"field field-array field-array-of-".concat(I.type),DescriptionField:O,disabled:c,idSchema:a,uiSchema:i,onAddClick:d,readonly:u,required:l,schema:r,title:_,TitleField:T,formContext:w,formData:k,rawErrors:b,registry:m},Z=i["ui:ArrayFieldTemplate"]||j||Te;return(0,n.jsx)(Z,(0,f.Z)({},A))}()};var Ee=function(e){var r,t=e.schema,i=e.name,o=e.uiSchema,a=void 0===o?{}:o,s=e.idSchema,l=e.formData,c=e.registry,d=void 0===c?Mr():c,u=e.required,p=e.disabled,h=void 0!==p&&p,m=e.readonly,g=void 0!==m&&m,x=e.autofocus,y=void 0!==x&&x,v=e.onChange,b=e.onFocus,_=e.onBlur,j=e.rawErrors,C=t.title,w=d.widgets,T=d.formContext,O=d.fields,I=Jr(a),k=I.widget,A=void 0===k?"checkbox":k,Z=(0,ee.Z)(I,["widget"]),F=Vr(t,A,w);return r=Array.isArray(t.oneOf)?Qr({oneOf:t.oneOf.map((function(e){return(0,S.Z)((0,f.Z)({},e),{title:e.title||(!0===e.const?"Yes":"No")})}))}):Qr({enum:t.enum||[!0,!1],enumNames:t.enumNames||(t.enum&&!1===t.enum[0]?["No","Yes"]:["Yes","No"])}),(0,n.jsx)(F,{options:(0,S.Z)((0,f.Z)({},Z),{enumOptions:r}),schema:t,id:s&&s.$id,onChange:v,onFocus:b,onBlur:_,label:void 0===C?i:C,value:l,required:u,disabled:h,readonly:g,registry:d,formContext:T,autofocus:y,rawErrors:j,DescriptionField:O.DescriptionField})},Ne=t(313054),Be=t.n(Ne),De=t(95255),Re=t.n(De),Pe=new(Be()),Me=Pe.renderer.rules.link_open||function(e,r,t,n,i){return i.renderToken(e,r,t)};Pe.renderer.rules.link_open=function(e,r,t,n,i){var o=e[r].attrIndex("target");return o<0?e[r].attrPush(["target","_blank"]):e[r].attrs[o][1]="_blank",Me(e,r,t,n,i)};var Le=function(e){var r=(0,i.useTheme)(),t=e.id,o=e.description,a=void 0===o?"":o;if(!a)return null;var s=Pe.render(a);return"string"===typeof a?(0,n.jsx)(i.Typography,{variant:"body4",color:r.color.fc3,children:(0,n.jsx)("div",{className:Re().description,dangerouslySetInnerHTML:{__html:s}})}):(0,n.jsx)("div",{id:t,className:"field-description",children:a})},We=function(e){var r,t=e.formData,i=e.options,a=(0,o.useState)({selectedOption:function(r,t){var n=ft(r,t,e.registry.rootSchema);return 0!==n?n:0}(t,i)}),s=a[0],l=a[1],c=e.baseType,d=e.disabled,u=e.errorSchema,p=e.idPrefix,h=e.idSchema,m=e.onBlur,g=e.onChange,x=e.onFocus,y=e.registry,v=e.uiSchema,b=e.schema,_=y.fields.SchemaField,j=y.widgets,S=s.selectedOption,C=Jr(v),w=C.widget,T=void 0===w?"select":w,O=(0,ee.Z)(C,["widget"]),I=Vr({type:"number"},T,j),k=i[S]||null;k&&(r=k.type?k:Object.assign({},k,{type:c}));var A=i.map((function(e,r){return{label:e.title||"Option ".concat(r+1),value:r}}));return(0,n.jsxs)("div",{className:"panel panel-default panel-body",children:[(0,n.jsx)("div",{className:"form-group",children:(0,n.jsx)(I,(0,f.Z)({id:"".concat(h.$id).concat(b.oneOf?"__oneof_select":"__anyof_select"),schema:{type:"number",default:0},onChange:function(r){var t=parseInt(r,10),n=e.formData,i=e.onChange,o=e.options,a=e.registry.rootSchema,s=ot(o[t],a,n),c=void 0;if("object"===rt(n)&&("object"===s.type||s.properties)){c=Object.assign({},n);var d=o.slice();d.splice(t,1);var u=!0,p=!1,h=void 0;try{for(var f,m=d[Symbol.iterator]();!(u=(f=m.next()).done);u=!0){var g=f.value;if(g.properties)for(var x in g.properties)c.hasOwnProperty(x)&&delete c[x]}}catch(y){p=!0,h=y}finally{try{u||null==m.return||m.return()}finally{if(p)throw h}}}i(qr(o[t],c,a)),l({selectedOption:parseInt(r,10)})},onBlur:m,onFocus:x,value:S,options:{enumOptions:A}},O))}),null!==k&&(0,n.jsx)(_,{schema:r,uiSchema:v,errorSchema:u,idSchema:h,idPrefix:p,formData:t,onChange:g,onBlur:m,onFocus:x,registry:y,disabled:d})]})},Ve=/\.\d*?0*$/,Ue=/[0.]0*$/,qe=function(e){var r=(0,o.useState)({lastValue:e.value}),t=r[0],i=r[1],a=e.registry.fields.StringField,s=e.formData,l=(0,ee.Z)(e,["formData"]),c=t.lastValue,d=s;if("string"===typeof c&&"number"===typeof d){var u=new RegExp("".concat(d).replace(".","\\.")+"\\.?0*$");c.match(u)&&(d=c)}return(0,n.jsx)(a,(0,S.Z)((0,f.Z)({},l),{formData:d,onChange:function(r){i({lastValue:r}),"."==="".concat(r).charAt(0)&&(r="0".concat(r));var t="string"===typeof r&&r.match(Ve)?$r(r.replace(Ue,"")):$r(r);e.onChange(t)}}))},Je={array:"ArrayField",boolean:"BooleanField",integer:"NumberField",number:"NumberField",object:"ObjectField",string:"StringField",null:"NullField"},$e="__additional_property",He={boolean:{checkbox:"CheckboxWidget",radio:"RadioWidget",select:"SelectWidget",hidden:"HiddenWidget",switch:"SwitchWidget"},string:{text:"TextWidget",select:"SelectWidget",textarea:"TextareaWidget",hidden:"HiddenWidget"},number:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},integer:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},array:{select:"SelectWidget",checkboxes:"CheckboxesWidget",hidden:"HiddenWidget"}};function ze(e){var r=e.TitleField,t=e.DescriptionField;return(0,n.jsxs)("fieldset",{id:e.idSchema.$id,children:[(e.uiSchema["ui:title"]||e.title)&&(0,n.jsx)(r,{id:"".concat(e.idSchema.$id,"__title"),title:e.title||e.uiSchema["ui:title"],required:e.required,formContext:e.formContext}),e.description&&(0,n.jsx)(t,{id:"".concat(e.idSchema.$id,"__description"),description:e.description,formContext:e.formContext}),e.properties.map((function(e){return e.content})),Pr(e.schema,e.uiSchema,e.formData)&&(0,n.jsx)(_e,{className:"object-property-expand",onClick:e.onAddClick(e.schema),disabled:e.disabled||e.readonly})]})}var Ge=function(e){var r,t=(0,o.useState)({wasPropertyKeyModified:!1,additionalProperties:{}}),i=t[0],a=t[1],l=function(r){var t=e.schema;return Array.isArray(t.required)&&-1!==t.required.indexOf(r)},c=function(r){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,i){void 0===n&&t&&(n="");var o=(0,s.isOperand)(e.formData)?e.formData:{type:"Expression",value:{operator:"newObject",operands:[]}},a={type:"Expression",value:{operator:"newObject",operands:(0,s.objectCombOperand)((0,w.Z)(o.value.operands).concat([r,n]))}};e.onChange(a,i&&e.errorSchema&&(0,S.Z)((0,f.Z)({},e.errorSchema),(0,oe.Z)({},r,i)))}},d=function(r){return function(t){t.preventDefault();var n=e.onChange,i=e.formData,o=(0,f.Z)({},i);delete o[r],n(o)}},u=function(e,r){for(var t=0,n=e;r.hasOwnProperty(n);)n="".concat(e,"-").concat(++t);return n},p=e.uiSchema,h=e.formData,m=e.errorSchema,g=e.idSchema,x=e.name,y=e.required,v=e.disabled,b=e.readonly,_=e.idPrefix,j=e.onBlur,C=e.onFocus,T=e.registry,O=void 0===T?Mr():T,I=O.rootSchema,k=O.fields,A=O.formContext,Z=k.TitleField,F=k.DescriptionField,E=k.SchemaField,N=ot(e.schema,I,h),B=void 0===N.title?x:N.title,D=p["ui:description"]||N.description;try{r=function(e,r){var t;if(!Array.isArray(r))return e;var n=function(e){return e.reduce((function(e,r){return e[r]=!0,e}),{})},i=function(e){return e.length>1?"properties '".concat(e.join("', '"),"'"):"property '".concat(e[0],"'")},o=n(e),a=r.filter((function(e){return"*"===e||o[e]})),s=n(a),l=e.filter((function(e){return!s[e]})),c=a.indexOf("*");if(-1===c){if(l.length)throw new Error("uiSchema order list does not contain ".concat(i(l)));return a}if(c!==a.lastIndexOf("*"))throw new Error("uiSchema order list contains more than one wildcard item");var d=(0,w.Z)(a);return(t=d).splice.apply(t,[c,1].concat((0,w.Z)(l))),d}(Object.keys(N.properties||{}),p["ui:order"])}catch(M){return(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"config-error",style:{color:"red"},children:["Invalid ",x||"root"," object field configuration:",(0,n.jsx)("em",{children:M.message}),"."]}),(0,n.jsx)("pre",{children:JSON.stringify(N)})]})}var R=p["ui:ObjectFieldTemplate"]||O.ObjectFieldTemplate||ze,P={title:p["ui:title"]||B,description:D,TitleField:Z,DescriptionField:F,properties:r.map((function(r){var t,o=N.properties[r],x=o.hasOwnProperty($e),T=x?p.additionalProperties:p[r],I=T&&"hidden"===T["ui:widget"],k=(0,s.getObjectOperandProperty)(h||{},r,o);return{content:(0,n.jsx)(E,{name:r,required:l(r),schema:N.properties[r],uiSchema:T,errorSchema:m[r],idSchema:g[r],idPrefix:_,formData:k,wasPropertyKeyModified:i.wasPropertyKeyModified,onKeyChange:(t=r,function(r,n){var o;if(t!==r){r=u(r,e.formData);var s=(0,f.Z)({},e.formData),l=(0,oe.Z)({},t,r),c=Object.keys(s).map((function(e){var r=l[e]||e;return(0,oe.Z)({},r,s[e])})),d=(o=Object).assign.apply(o,[{}].concat((0,w.Z)(c)));a({wasPropertyKeyModified:!0,additionalProperties:i.additionalProperties}),e.onChange(d,n&&e.errorSchema&&(0,S.Z)((0,f.Z)({},e.errorSchema),(0,oe.Z)({},r,n)))}}),onChange:c(r,x),onBlur:j,onFocus:C,registry:O,disabled:v,readonly:b,onDropPropertyClick:d},r),name:r,readonly:b,disabled:v,required:y,hidden:I}})),readonly:b,disabled:v,required:y,idSchema:g,uiSchema:p,schema:N,formData:h,formContext:A,registry:O};return(0,n.jsx)(R,(0,S.Z)((0,f.Z)({},P),{onAddClick:function(r){return function(){var t=r.additionalProperties.type,n=(0,f.Z)({},e.formData);if(r.additionalProperties.hasOwnProperty("$ref")){var i=e.registry,o=void 0===i?Mr():i;t=ot({$ref:r.additionalProperties.$ref},o.rootSchema,e.formData).type}n[u("newKey",n)]=function(e){switch(e){case"string":default:return"New Value";case"array":return[];case"boolean":return!1;case"null":return null;case"number":return 0;case"object":return{}}}(t),e.onChange(n)}}}))};function Ke(e){return("undefined"===typeof File||!(0,se.Z)(e,File))&&("object"===typeof e&&null!==e&&!Array.isArray(e))}function Ye(e,r){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Object.assign({},e);return Object.keys(r).reduce((function(n,i){var o=e?e[i]:{},a=r[i];return e&&e.hasOwnProperty(i)&&Ke(a)?n[i]=Ye(o,a,t):t&&Array.isArray(o)&&Array.isArray(a)?n[i]=o.concat(a):n[i]=a,n}),n)}function Xe(e){var r=e.label,t=e.required,i=e.id;return r?(0,n.jsxs)("label",{className:"control-label",htmlFor:i,children:[t&&(0,n.jsx)("span",{className:"required",children:"*"}),r]}):null}function Qe(e){var r=e.id,t=e.label,i=e.onChange;return(0,n.jsx)("input",{className:"form-control",type:"text",id:r,onBlur:function(e){return i(e.target.value)},defaultValue:t})}function er(e){var r=e.id,t=e.classNames,i=e.disabled,o=e.label,a=e.onKeyChange,s=e.onDropPropertyClick,l=e.readonly,c=e.required,d=e.schema,u="".concat(o," Key");return d.hasOwnProperty($e)?(0,n.jsx)("div",{className:t,children:(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)("div",{className:"col-xs-5 form-additional",children:(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)(Xe,{label:u,required:c,id:"".concat(r,"-key")}),(0,n.jsx)(Qe,{label:o,required:c,id:"".concat(r,"-key"),onChange:a})]})}),(0,n.jsx)("div",{className:"form-additional form-group col-xs-5",children:e.children}),(0,n.jsx)("div",{className:"col-xs-2",children:(0,n.jsx)(be,{type:"danger",icon:"remove",className:"array-item-remove btn-block",tabIndex:"-1",style:{border:"0"},disabled:i||l,onClick:s(o)})})]})}):(0,n.jsx)("div",{className:t,children:e.children})}function rr(e){var r=e.id,t=e.label,i=e.children,o=e.errors,a=e.help,s=e.description,l=e.hidden,c=e.required,d=e.displayLabel;return l?(0,n.jsx)("div",{className:"hidden",children:i}):(0,n.jsxs)(er,(0,S.Z)((0,f.Z)({},e),{children:[d&&(0,n.jsx)(Xe,{label:t,required:c,id:r}),d&&s?s:null,i,o,a]}))}function tr(e){var r=e.errors,t=void 0===r?[]:r,o=(0,i.useTheme)();if(0===t.length)return null;var a=1===t.length;return(0,n.jsx)("div",{style:{marginTop:4},children:a?(0,n.jsx)(i.Typography,{variant:"body4",color:o.color.fc10,children:t[0]}):(0,n.jsx)("ul",{style:{color:o.color.fc10},children:t.filter((function(e){return!!e})).map((function(e,r){return(0,n.jsx)("li",{children:(0,n.jsx)(i.Typography,{variant:"body4",children:e})},r)}))})})}function nr(e){var r=e.id,t=e.help;return t?"string"===typeof t?(0,n.jsx)("p",{id:r,className:"help-block",children:t}):(0,n.jsx)("div",{id:r,className:"help-block",children:t}):null}var ir=function(e){var r=e.uiSchema,t=void 0===r?{}:r,i=e.formData,a=e.errorSchema,s=void 0===a?{}:a,l=e.idPrefix,c=e.name,d=e.onChange,u=e.onKeyChange,p=e.onDropPropertyClick,h=e.required,m=e.registry,g=void 0===m?Mr():m,x=e.wasPropertyKeyModified,y=void 0!==x&&x,v=g.rootSchema,b=g.fields,_=g.formContext,j=t["ui:FieldTemplate"]||g.FieldTemplate||rr,C=e.idSchema||{},w=ot(e.schema,v,i),T=function(e,r,t,i){var o=r["ui:field"];if("function"===typeof o)return o;if("string"===typeof o&&o in i)return i[o];var a=Wr(e),s=Je[a];return s||!e.anyOf&&!e.oneOf?s in i?i[s]:function(){var r=i.UnsupportedField;return(0,n.jsx)(r,{schema:e,idSchema:t,reason:"Unknown field type ".concat(e.type)})}:function(){return null}}(w,t,C=Ye(pt(w,null,v,i,l),C),b),O=b.DescriptionField,I=Boolean(e.disabled||t["ui:disabled"]),k=Boolean(e.readonly||t["ui:readonly"]||w.readOnly),A=Boolean(e.autofocus||t["ui:autofocus"]);if(0===Object.keys(w).length)return null;var Z,F=function(e,r,t){var n=Jr(r).label,i=void 0===n||n,o=Wr(e);"array"===o&&(i=Gr(e,t)||Kr(e,r,t));"object"===o&&(i=!1);"boolean"!==o||r["ui:widget"]||(i=!1);r["ui:field"]&&(i=!1);return i}(w,t,v),E=s.__errors,N=(0,ee.Z)(s,["__errors"]),B=(0,n.jsx)(T,(0,S.Z)((0,f.Z)({},e),{idSchema:C,schema:w,uiSchema:(0,S.Z)((0,f.Z)({},t),{classNames:void 0}),disabled:I,readonly:k,autofocus:A,errorSchema:N,formContext:_,rawErrors:E})),D=C.$id;Z=y?c:t["ui:title"]||e.schema.title||w.title||c;var R=t["ui:description"]||e.schema.description||w.description,P=E,M=t["ui:help"],L="hidden"===t["ui:widget"],W=["form-group","field","field-".concat(w.type),P&&P.length>0?"field-error has-error has-danger":"",t.classNames].join(" ").trim(),V={description:(0,n.jsx)(O,{id:D+"__description",description:R,formContext:_}),rawDescription:R,help:(0,n.jsx)(nr,{id:D+"__help",help:M}),rawHelp:"string"===typeof M?M:void 0,errors:(0,n.jsx)(tr,{errors:P}),rawErrors:P,id:D,label:Z,hidden:L,onChange:d,onKeyChange:u,onDropPropertyClick:p,required:h,disabled:I,readonly:k,displayLabel:F,classNames:W,formContext:_,formData:i,fields:b,schema:w,uiSchema:t,registry:g},U=g.fields.AnyOfField,q=g.fields.OneOfField;return(0,n.jsx)(j,(0,S.Z)((0,f.Z)({},V),{children:(0,n.jsxs)(o.Fragment,{children:[B,w.anyOf&&!zr(w)&&(0,n.jsx)(U,{disabled:I,errorSchema:s,formData:i,idPrefix:l,idSchema:C,onBlur:e.onBlur,onChange:e.onChange,onFocus:e.onFocus,options:w.anyOf.map((function(e){return ot(e,v,i)})),baseType:w.type,registry:g,schema:w,uiSchema:t}),w.oneOf&&!zr(w)&&(0,n.jsx)(q,{disabled:I,errorSchema:s,formData:i,idPrefix:l,idSchema:C,onBlur:e.onBlur,onChange:e.onChange,onFocus:e.onFocus,options:w.oneOf.map((function(e){return ot(e,v,i)})),baseType:w.type,registry:g,schema:w,uiSchema:t})]})}))};var or=function(e){var r=e.schema,t=e.name,i=e.uiSchema,o=e.idSchema,a=e.formData,s=e.required,l=e.disabled,c=e.readonly,d=e.autofocus,u=e.onChange,p=e.onBlur,h=e.onFocus,m=e.registry,g=void 0===m?Mr():m,x=e.rawErrors,y=r.title,v=r.format,b=g.widgets,_=g.formContext,j=zr(r)&&Qr(r),C=j?"select":"text";v&&function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return Vr(e,r,t),!0}catch(n){if(!(0,se.Z)(n,Error))throw n;if(n.message&&(n.message.startsWith("No widget")||n.message.startsWith("Unsupported widget")))return!1;throw n}}(r,v,b)&&(C=v);var w=Jr(i),T=w.widget,O=void 0===T?C:T,I=w.placeholder,k=void 0===I?"":I,A=(0,ee.Z)(w,["widget","placeholder"]),Z=Vr(r,O,b);return(0,n.jsx)(Z,{options:(0,S.Z)((0,f.Z)({},A),{enumOptions:j}),schema:r,uiSchema:i,id:o&&o.$id,label:void 0===y?t:y,value:a,onChange:u,onBlur:p,onFocus:h,required:s,disabled:l,readonly:c,formContext:_,autofocus:d,registry:g,placeholder:k,rawErrors:x})},ar=t(387394),sr=t(874664),lr=t.n(sr),cr=function(e){var r=e.help;return r?(0,n.jsx)(i.Tooltip,{content:r.text,children:(0,n.jsx)("a",{href:r.url,rel:"noopener noreferrer",style:{marginLeft:4},target:"_blank",children:(0,n.jsx)(M.QuestionCircleOutlined,{className:lr().helpIcon,color:"#8c8c8c"})})}):null},dr=t(72779),ur=t.n(dr);var pr={AnyOfField:We,ArrayField:Fe,BooleanField:Ee,DescriptionField:Le,NumberField:qe,ObjectField:Ge,OneOfField:We,SchemaField:ir,StringField:or,TitleField:function(e){var r,t=e.title,i=e.id,a=e.help,s=e.hasCollapse,l=e.style,c=e.defaultCollapse,d=void 0!==c&&c,u=e.onChange,p=(0,ar.Z)((i||"").split("-"),2)[1],h=Math.min(parseInt(p,10)||0,2),f=ur()(lr().h,(r={},(0,oe.Z)(r,lr().h1,0===h),(0,oe.Z)(r,lr().h2,2===h),(0,oe.Z)(r,lr().h3,3===h),(0,oe.Z)(r,lr().hasCollapse,s),r)),m=(0,o.useState)(d),g=m[0],x=m[1];return(0,n.jsxs)("div",{className:f,style:l,id:i,onClick:function(){if(s){var e=!g;x(e),u&&u(e)}},children:[t,a&&(0,n.jsx)(cr,{help:a}),s&&(0,n.jsxs)("span",{className:ur()(lr().suffixIcon,(0,oe.Z)({},lr().isIconRotate,!g)),children:[" ",(0,n.jsx)(M.ChevronDownOutlined,{color:"#8C8C8C"})]})]})},NullField:function(e){var r=e.formData,t=e.onChange;return(0,o.useEffect)((function(){null==r&&(null===t||void 0===t||t(null))}),[r,t]),null},UnsupportedField:function(e){var r=e.schema,t=e.idSchema,i=e.reason;return(0,n.jsxs)("div",{className:"unsupported-field",children:[(0,n.jsxs)("p",{children:["Unsupported field schema",t&&t.$id&&(0,n.jsxs)("span",{children:[" for"," field ",(0,n.jsx)("code",{children:t.$id})]}),i&&(0,n.jsxs)("em",{children:[": ",i]}),"."]}),r&&(0,n.jsx)("pre",{children:JSON.stringify(r,null,2)})]})}};var hr=function(e){if(!e.id)throw new Error("no id for props ".concat(JSON.stringify(e)));var r=e.value,t=e.readonly,i=e.disabled,o=e.autofocus,a=e.onBlur,s=e.onFocus,l=e.options,c=e.schema,d=(e.uiSchema,e.formContext,e.registry,e.rawErrors,(0,ee.Z)(e,["value","readonly","disabled","autofocus","onBlur","onFocus","options","schema","uiSchema","formContext","registry","rawErrors"]));return l.inputType?d.type=l.inputType:d.type||("number"===c.type?(d.type="number",d.step="any"):"integer"===c.type?(d.type="number",d.step="1"):d.type="text"),l.autocomplete&&(d.autoComplete=l.autocomplete),c.multipleOf&&(d.step=c.multipleOf),"undefined"!==typeof c.minimum&&(d.min=c.minimum),"undefined"!==typeof c.maximum&&(d.max=c.maximum),[(0,n.jsx)("input",(0,S.Z)((0,f.Z)({className:"form-control",readOnly:t,disabled:i,autoFocus:o,value:null==r?"":r},d),{list:c.examples?"examples_".concat(d.id):null,onChange:function(r){var t=r.target.value;return e.onChange(""===t?l.emptyValue:t)},onBlur:a&&function(e){return a(d.id,e.target.value)},onFocus:s&&function(e){return s(d.id,e.target.value)}}),d.id),c.examples?(0,n.jsx)("datalist",{id:"examples_".concat(d.id),children:(0,w.Z)(new Set(c.examples.concat(c.default?[c.default]:[]))).map((function(e){return(0,n.jsx)("option",{value:e},e)}))},"datalist_".concat(d.id)):null]};var fr=function(e){var r=e.id,t=e.value;return(0,n.jsx)("input",{type:"hidden",id:r,value:"undefined"===typeof t?"":t})},mr=new Set(["number","integer"]);function gr(e,r){var t=e.type,n=e.items;if(""!==r){if("array"===t&&n&&n.type&&mr.has(n.type))return r.map($r);if("boolean"===t)return"true"===r;if("number"===t)return $r(r);if(e.enum){if(e.enum.every((function(e){return"number"===rt(e)})))return $r(r);if(e.enum.every((function(e){return"boolean"===rt(e)})))return"true"===r}return r}}function xr(e,r){return r?[].slice.call(e.target.options).filter((function(e){return e.selected})).map((function(e){return e.value})):e.target.value}var yr=function(e){var r=e.schema,t=e.id,i=e.options,o=e.value,a=e.required,s=e.disabled,l=e.readonly,c=e.multiple,d=e.autofocus,u=e.onChange,p=e.onBlur,h=e.onFocus,f=e.placeholder,m=i.enumOptions,g=i.enumDisabled,x=c?[]:"";return(0,n.jsxs)("select",{id:t,multiple:c,className:"form-control",value:"undefined"===typeof o?x:o,required:a,disabled:s||l,autoFocus:d,onBlur:p&&function(e){var n=xr(e,c);p(t,gr(r,n))},onFocus:h&&function(e){var n=xr(e,c);h(t,gr(r,n))},onChange:function(e){var t=xr(e,c);u(gr(r,t))},children:[!c&&void 0===r.default&&(0,n.jsx)("option",{value:"",children:f}),m.map((function(e,r){var t=e.value,i=e.label,o=g&&-1!=g.indexOf(t);return(0,n.jsx)("option",{value:t,disabled:o,children:i},r)}))]})};var vr=function(e){var r=e.id,t=e.options,i=e.placeholder,o=e.value,a=e.required,s=e.disabled,l=e.readonly,c=e.autofocus,d=e.onChange,u=e.onBlur,p=e.onFocus;return(0,n.jsx)("textarea",{id:r,className:"form-control",value:o||"",placeholder:i,required:a,disabled:s,readOnly:l,autoFocus:c,rows:t.rows,onBlur:u&&function(e){return u(r,e.target.value)},onFocus:p&&function(e){return p(r,e.target.value)},onChange:function(e){var r=e.target.value;return d(""===r?t.emptyValue:r)}})};var br=function(e){var r=e.registry.widgets.BaseInput;return(0,n.jsx)(r,(0,f.Z)({},e))},_r=t(287931),jr=function(e){return{type:"Literal",value:e}},Sr={BaseInput:hr,SelectWidget:yr,TextWidget:br,TextareaWidget:vr,HiddenWidget:fr,CheckboxWidget:function(e){var r=e.schema,t=e.id,o=e.value,a=e.disabled,s=e.readonly,l=e.label,c=e.onChange,d=e.DescriptionField;return(0,n.jsxs)("div",{className:"checkbox ".concat(a||s?"disabled":""),id:t,children:[r.description&&(0,n.jsx)(d,{description:r.description}),(0,n.jsx)("label",{children:(0,n.jsx)(i.Checkbox,{checked:"undefined"!==typeof o&&o,disabled:a||s,onChange:function(e){return c(e)},children:l})})]})},SwitchWidget:function(e){var r=e.schema,t=e.id,o=e.value,a=e.disabled,s=e.readonly,l=e.label,c=e.onBlur,d=e.onFocus,u=e.onChange,p=a||s;return(0,n.jsxs)(i.Box,{display:"flex",style:{cursor:"pointer",userSelect:"none"},width:"100%",padding:"4px",borderRadius:"4px",onBlur:c&&function(){return c(t,o)},onFocus:d&&function(){return d(t,o)},onClick:function(){return u(!o)},children:[(0,n.jsx)(i.Switch,{checked:o,disabled:p})," ",(0,n.jsx)("span",{style:{paddingLeft:8},children:l||r.description})]})},CheckboxesWidget:function(e){var r=e.id,t=e.options,o=e.value,a=e.onChange,s=t.enumOptions,l=t.enumDisabled,c=function(e,r){var t=s.map((function(e){return e.value}));a(r?function(e,r,t){var n=t.indexOf(e);return r.slice(0,n).concat(e,r.slice(n)).sort((function(e,r){return t.indexOf(e)>t.indexOf(r)}))}(e.value,o,t):function(e,r){return r.filter((function(r){return r!==e}))}(e.value,o))};return(0,n.jsx)(n.Fragment,{children:s.map((function(e,t){var a=-1!==o.indexOf(e.value),s=Boolean(l&&-1!==l.indexOf(e.value));return(0,n.jsx)("div",{style:{display:"flex"},children:(0,n.jsx)(i.Checkbox,{checked:a,disabled:s,onChange:function(r){return c(e,r)},children:e.label})},"".concat(r,"_").concat(t))}))})},RadioGroupWidget:function(e){var r=e.options,t=e.value,i=e.onChange,o=r.enumOptions,a=(0,s.getLiteralOperandValue)(t);return(0,n.jsx)(_r.ZP.Group,{onChange:function(e){var r=jr(e.target.value);i(r)},value:a,children:null===o||void 0===o?void 0:o.map((function(e){return(0,n.jsx)(_r.ZP,{value:e.value,children:e.label},e.value)}))})}},Cr=t(565096),wr=t.n(Cr),Tr=t(25497),Or=t.n(Tr),Ir=function(){var e=new(wr())({errorDataPath:"property",allErrors:!0,multipleOfPrecision:8,schemaId:"auto",unknownFormats:"ignore"});return e.addFormat("data-url",/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/),e.addFormat("color",/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/),e}(),kr="__rjsf_rootSchema";function Ar(e){return e.length?e.reduce((function(e,r){var t=r.property,n=r.message,i=Or()(t),o=e;i.length>0&&""===i[0]&&i.splice(0,1);var a=!0,s=!1,l=void 0;try{for(var c,d=i.slice(0)[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var u=c.value;u in o||(o[u]={}),o=o[u]}}catch(p){s=!0,l=p}finally{try{a||null==d.return||d.return()}finally{if(s)throw l}}return Array.isArray(o.__errors)?o.__errors=o.__errors.concat(n):n&&(o.__errors=[n]),e}),{}):{}}function Zr(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root",t=[];return"__errors"in e&&(t=t.concat(e.__errors.map((function(e){return{stack:"".concat(r,": ").concat(e)}})))),Object.keys(e).reduce((function(r,t){return"__errors"!==t&&(r=r.concat(Zr(e[t],t))),r}),t)}function Fr(e){var r={__errors:[],addError:function(e){this.__errors.push(e)}};return Ke(e)?Object.keys(e).reduce((function(r,t){return(0,S.Z)((0,f.Z)({},r),(0,oe.Z)({},t,Fr(e[t])))}),r):Array.isArray(e)?e.reduce((function(e,r,t){return(0,S.Z)((0,f.Z)({},e),(0,oe.Z)({},t,Fr(r)))}),r):r}function Er(e){return Object.keys(e).reduce((function(r,t){return"addError"===t?r:"__errors"===t?(0,S.Z)((0,f.Z)({},r),(0,oe.Z)({},t,e[t])):(0,S.Z)((0,f.Z)({},r),(0,oe.Z)({},t,Er(e[t])))}),{})}function Nr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return null===e?[]:e.map((function(e){var r=e.dataPath,t=e.keyword,n=e.message,i=e.params,o=e.schemaPath,a="".concat(r);return{name:t,property:a,message:n,params:i,stack:"".concat(a," ").concat(n).trim(),schemaPath:o}}))}function Br(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=r,i=null,o=(0,s.validateMagicForm)(n,e),a=o.errors,l=o.validationError;l&&(i=l);var c=Nr(a),d=i&&i.message&&"string"===typeof i.message&&i.message.includes("no schema with key or ref ");d&&(c=(0,w.Z)(c).concat([{stack:i.message}]));var u=Ar(c);if(d&&(u=(0,f.Z)({},u,{$schema:{__errors:[i.message]}})),"function"!==typeof t)return{errors:c,errorSchema:u};var p=t(e,Fr(e)),h=Er(p),m=Ye(u,h,!0),g=Zr(m);return{errors:g,errorSchema:m}}function Dr(e){var r=e;if(e.constructor===Object)for(var t in r=(0,f.Z)({},e)){var n=r[t];"$ref"===t&&"string"===typeof n&&n.startsWith("#")?r[t]=kr+n:r[t]=Dr(n)}else if(Array.isArray(e)){r=(0,w.Z)(e);for(var i=0;i<r.length;i++)r[i]=Dr(r[i])}return r}function Rr(e,r,t){try{return Ir.addSchema(t,kr).validate(Dr(e),r)}catch(n){return!1}finally{Ir.removeSchema(kr)}}function Pr(e,r,t){if(!e.additionalProperties)return!1;var n=(Jr(r)||{}).expandable;return!1===n?n:void 0===e.maxProperties||Object.keys(t).length<e.maxProperties}function Mr(){return{fields:pr,widgets:Sr,definitions:{},rootSchema:{},formContext:{}}}var Lr=function(e){var r=Mr(),t=r.fields,n=r.widgets;return{fields:(0,f.Z)({},t,e.fields),widgets:(0,f.Z)({},n,e.widgets),ArrayFieldTemplate:e.ArrayFieldTemplate,ObjectFieldTemplate:e.ObjectFieldTemplate,FieldTemplate:e.FieldTemplate,definitions:e.schema.definitions||{},rootSchema:e.schema,formContext:e.formContext||{}}};function Wr(e){var r=e.type;return!r&&e.const?rt(e.const):!r&&e.enum?"string":r||!e.properties&&!e.additionalProperties?Array.isArray(r)&&2===r.length&&r.includes("null")?r.find((function(e){return"null"!==e})):r:"object"}function Vr(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Wr(e),a=function(e){if(!e.MergedWidget){var r,t=e.defaultProps&&e.defaultProps.options||{};r=function(r){var i=r.options,o=void 0===i?{}:i,a=(0,ee.Z)(r,["options"]);return(0,n.jsx)(e,(0,f.Z)({options:(0,f.Z)({},t,o)},a))},e.MergedWidget=r}return e.MergedWidget};if("function"===typeof r||ve.isForwardRef((0,o.createElement)(r))||ve.isMemo(r))return a(r);if("string"!==typeof r)throw new Error("Unsupported widget definition: ".concat("undefined"===typeof r?"undefined":(0,ce.Z)(r)));if(t.hasOwnProperty(r)){var s=t[r];return Vr(e,s,t)}if(!He.hasOwnProperty(i))throw new Error('No widget for type "'.concat(i,'"'));if(He[i].hasOwnProperty(r)){var l=t[He[i][r]];return Vr(e,l,t)}throw new Error('No widget "'.concat(r,'" for type "').concat(i,'"'))}function Ur(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=Ke(e)?e:{},a=n,l=r;if(Ke(l)&&Ke(null===o||void 0===o?void 0:o.default))l=Ye(l,o.default);else if("default"in o)l=o.default;else{if("$ref"in o){var c=et(o.$ref,t);return Ur(c,l,t,a,i)}if("dependencies"in o){var d=at(o,t,a);return Ur(d,l,t,a,i)}Yr(o)?l=o.items.map((function(e,n){return Ur(e,Array.isArray(r)?r[n]:void 0,t,a,i)})):"oneOf"in o?o=o.oneOf[ft(void 0,o.oneOf,t)]:"anyOf"in o&&(o=o.anyOf[ft(void 0,o.anyOf,t)])}switch("undefined"===typeof l&&(l=o.default),Wr(o)){case"object":return Object.keys(o.properties||{}).reduce((function(e,r){var n=Ur(o.properties[r],(l||{})[r],t,(0,s.getObjectOperandProperty)(a,r,o.properties[r]),i);return(i||void 0!==n)&&(e[r]=n),e}),{});case"array":if(Array.isArray(l)&&(l=l.map((function(e,r){return Ur(o.items[r]||o.additionalItems||{},e,t)}))),Array.isArray(n)&&(l=n.map((function(e,r){return Ur(o.items,(l||{})[r],t,e)}))),o.minItems){if(Gr(o,t))return l||[];var u=l?l.length:0;if(o.minItems>u){var p=l||[],h=Array.isArray(o.items)?o.additionalItems:o.items,f=new Array(o.minItems-u).fill(Ur(h,h.defaults,t));return p.concat(f)}}}return l}function qr(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Ke(e))throw new Error("Invalid schema: "+e);var i=ot(e,t,r),o=Ur(i,e.default,t,r,n),a=(0,s.data2Operand)(o);return null==r?a:(0,s.isArrayOperand)(r)||(0,s.isObjectOperand)(r)?(0,s.mergeOperand)(a,r):0===r||!1===r||""===r?r:r||a}function Jr(e){return Object.keys(e).filter((function(e){return 0===e.indexOf("ui:")})).reduce((function(r,t){var n=e[t];return"ui:widget"===t&&Ke(n)?(console.warn("Setting options via ui:widget object is deprecated, use ui:options instead"),(0,S.Z)((0,f.Z)({},r,n.options||{}),{widget:n.component})):"ui:options"===t&&Ke(n)?(0,f.Z)({},r,n):(0,S.Z)((0,f.Z)({},r),(0,oe.Z)({},t.substring(3),n))}),{})}function $r(e){if(""!==e){if(null===e)return null;if(/\.$/.test(e))return e;if(/\.0$/.test(e))return e;var r=Number(e),t="number"===typeof r&&!Number.isNaN(r);return/\.\d*0$/.test(e)?e:t?r:e}}function Hr(e){return Array.isArray(e.enum)&&1===e.enum.length||e.hasOwnProperty("const")}function zr(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=ot(e,r),n=t.oneOf||t.anyOf;return!!Array.isArray(t.enum)||!!Array.isArray(n)&&n.every((function(e){return Hr(e)}))}function Gr(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!(!e.uniqueItems||!e.items)&&zr(e.items,r)}function Kr(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("files"===r["ui:widget"])return!0;if(e.items){var n=ot(e.items,t);return"string"===n.type&&"data-url"===n.format}return!1}function Yr(e){return Array.isArray(e.items)&&e.items.length>0&&e.items.every((function(e){return Ke(e)}))}function Xr(e){return!0===e.additionalItems&&console.warn("additionalItems=true is currently not supported"),Ke(e.additionalItems)}function Qr(e){return e.enum?e.enum.map((function(r,t){return{label:e.enumNames&&e.enumNames[t]||String(r),value:r}})):(e.oneOf||e.anyOf).map((function(e){var r=function(e){if(Array.isArray(e.enum)&&1===e.enum.length)return e.enum[0];if(e.hasOwnProperty("const"))return e.const;throw new Error("schema cannot be inferred as a constant")}(e);return{schema:e,label:e.title||String(r),value:r}}))}function et(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e;if(!e.startsWith("#"))throw new Error("Could not find a definition for ".concat(t,"."));e=decodeURIComponent(e.substring(1));var n=pe.get(r,e);if(void 0===n)throw new Error("Could not find a definition for ".concat(t,"."));return n.hasOwnProperty("$ref")?et(n.$ref,r):n}var rt=function(e){return Array.isArray(e)?"array":"string"===typeof e?"string":null==e?"null":"boolean"===typeof e?"boolean":isNaN(e)?"object"===typeof e?"object":"string":"number"};function tt(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=(0,S.Z)((0,f.Z)({},e),{properties:(0,f.Z)({},e.properties)}),Object.keys(t).forEach((function(n){var i;e.properties.hasOwnProperty(n)||(i=e.additionalProperties.hasOwnProperty("$ref")?ot({$ref:e.additionalProperties.$ref},r,t):e.additionalProperties.hasOwnProperty("type")?(0,f.Z)({},e.additionalProperties):{type:rt(t[n])},e.properties[n]=i,e.properties[n].__additional_property=!0)})),e}function nt(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.hasOwnProperty("$ref"))return it(e,r,t);if(e.hasOwnProperty("dependencies")){var n=at(e,r,t);return ot(n,r,t)}return e.hasOwnProperty("allOf")?(0,S.Z)((0,f.Z)({},e),{allOf:e.allOf.map((function(e){return ot(e,r,t)}))}):e}function it(e,r,t){var n=et(e.$ref,r),i=(e.$ref,(0,ee.Z)(e,["$ref"]));return ot((0,f.Z)({},n,i),r,t)}function ot(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Ke(e))return{};var n=nt(e,r,t);if("allOf"in e)try{n=ue()((0,S.Z)((0,f.Z)({},n),{allOf:n.allOf}))}catch(a){console.warn("could not merge subschemas in allOf:\n"+a);n.allOf;var i=(0,ee.Z)(n,["allOf"]);return i}var o=n.hasOwnProperty("additionalProperties")&&!1!==n.additionalProperties;return o?tt(n,r,t):n}function at(e,r,t){var n=e.dependencies,i=void 0===n?{}:n,o=(0,ee.Z)(e,["dependencies"]);return"oneOf"in o?o=o.oneOf[ft(t,o.oneOf,r)]:"anyOf"in o&&(o=o.anyOf[ft(t,o.anyOf,r)]),st(i,o,r,t)}function st(e,r,t,n){for(var i in e){var o=i;if((0,s.getObjectOperandProperty)(n,o,r)!==s.EmptyNullOperand&&(!r.properties||o in r.properties)){var a=e[o],l=(0,ee.Z)(e,[o].map(le.Z));return Array.isArray(a)?r=lt(r,a):Ke(a)&&(r=ct(r,t,n,o,a)),st(l,r,t,n)}}return r}function lt(e,r){if(!r)return e;var t=Array.isArray(e.required)?Array.from(new Set((0,w.Z)(e.required).concat((0,w.Z)(r)))):r;return(0,S.Z)((0,f.Z)({},e),{required:t})}function ct(e,r,t,n,i){var o=ot(i,r,t),a=o.oneOf;if(e=dt(e,(0,ee.Z)(o,["oneOf"])),void 0===a)return e;if(!Array.isArray(a))throw new Error("invalid: it is some ".concat("undefined"===typeof a?"undefined":(0,ce.Z)(a)," instead of an array"));var s=a.map((function(e){return e.hasOwnProperty("$ref")?it(e,r,t):e}));return function(e,r,t,n,i){var o=i.filter((function(e){if(!e.properties)return!1;var r=e.properties[n];if(r){var i={type:"object",properties:(0,oe.Z)({},n,r)};return 0===Br(t,i).errors.length}return!1}));if(1!==o.length)return console.warn("ignoring oneOf in dependencies because there isn't exactly one subschema that is valid"),e;var a=o[0],s=a.properties,l=(s[n],(0,ee.Z)(s,[n].map(le.Z))),c=(0,S.Z)((0,f.Z)({},a),{properties:l});return dt(e,ot(c,r,t))}(e,r,t,n,s)}function dt(e,r){var t=Object.assign({},e);return Object.keys(r).reduce((function(t,n){var i=e?e[n]:{},o=r[n];return e&&e.hasOwnProperty(n)&&Ke(o)?t[n]=dt(i,o):e&&r&&("object"===Wr(e)||"object"===Wr(r))&&"required"===n&&Array.isArray(i)&&Array.isArray(o)?t[n]=ye()(i,o):t[n]=o,t}),t)}var ut=function(e,r){var t=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""];return Object.keys(e).forEach((function(o){if("object"===typeof e[o]){var a=i.map((function(e){return"".concat(e,".").concat(o)}));e[o].__rjsf_additionalProperties&&""!==e[o].$name?n.push(e[o].$name):t(e[o],n,a)}else"$name"===o&&""!==e[o]&&i.forEach((function(e){e=e.replace(/^\./,"");var t=fe()(r,e);("object"!==typeof t||ge()(t))&&n.push(e)}))})),n};return t(e)},pt=function(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"root",o={$id:r||i};if("$ref"in e||"dependencies"in e||"allOf"in e){var a=ot(e,t,n);return pt(a,r,t,n,i)}if("items"in e&&!e.items.$ref)return pt(e.items,r,t,n,i);if("object"!==e.type)return o;for(var s in e.properties||{}){var l=e.properties[s],c=o.$id+"_"+s;o[s]=pt(Ke(l)?l:{},c,t,(n||{})[s],i)}return o};function ht(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i={$name:r.replace(/^\./,"")};if("$ref"in e||"dependencies"in e||"allOf"in e){var o=ot(e,t,n);return ht(o,r,t,n)}if(e.hasOwnProperty("additionalProperties")&&(i.__rjsf_additionalProperties=!0),e.hasOwnProperty("items")&&Array.isArray(n))n.forEach((function(n,o){i[o]=ht(e.items,"".concat(r,".").concat(o),t,n)}));else if(e.hasOwnProperty("properties"))for(var a in e.properties)i[a]=ht(e.properties[a],"".concat(r,".").concat(a),t,(n||{})[a]);return i}function ft(e,r,t){for(var n=0;n<r.length;n++){var i=r[n];if(i.properties){var o={anyOf:Object.keys(i.properties).map((function(e){return{required:[e]}}))},a=void 0;if(i.anyOf){var s=(0,ae.Z)({},i);s.allOf?s.allOf=s.allOf.slice():s.allOf=[],s.allOf.push(o),a=s}else a=(0,f.Z)({},i,o);if(delete a.required,Rr(a,e,t))return n}else if(Rr(i,e,t))return n}return 0}var mt=function(e,r){var t,n,i,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=e.extraErrors,l=e.idPrefix,c=e.liveValidate,d=e.schema,u=e.uiSchema,p=e.customFormats,h=e.additionalMetaSchemas,f=e.noValidate,m="undefined"!==typeof r,g=m&&!f&&c,x=d,y=qr(d,r,x),v=ot(d,x,y),b=function(){return f?{errors:[],errorSchema:{}}:c?{errors:a.errors||[],errorSchema:a.errorSchema||{}}:{errors:a.schemaValidationErrors||[],errorSchema:a.schemaValidationErrorSchema||{}}};if(g){var _=Br(y,d,h,p);i=t=_.errors,o=n=_.errorSchema}else{var j=b();t=j.errors,n=j.errorSchema,i=a.schemaValidationErrors,o=a.schemaValidationErrorSchema}s&&(t=Zr(n=Ye(n,s,!0)));var S=pt(v,null===u||void 0===u?void 0:u["ui:rootFieldId"],x,y,l),C={schema:d,uiSchema:u,idSchema:S,formData:y,edit:m,errors:t,errorSchema:n,additionalMetaSchemas:h};return i&&(C.schemaValidationErrors=i,C.schemaValidationErrorSchema=o),C};var gt={uiSchema:{},noValidate:!1,liveValidate:!1,disabled:!1,readonly:!1,noHtml5Validate:!1,ErrorList:function(e){var r=e.errors;return(0,n.jsxs)("div",{className:"panel panel-danger errors",children:[(0,n.jsx)("div",{className:"panel-heading",children:(0,n.jsx)("h3",{className:"panel-title",children:"Errors"})}),(0,n.jsx)("ul",{className:"list-group",children:r.map((function(e,r){return(0,n.jsx)("li",{className:"list-group-item text-danger",children:e.stack},r)}))})]})},omitExtraData:!1},xt=o.forwardRef((function(e,r){var t=(0,f.Z)({},gt,e),i=(0,o.useRef)(null),a=(0,o.useState)(),s=a[0],l=a[1],c=(0,o.useState)(mt(t,t.formData)),d=c[0],u=c[1];(0,o.useEffect)((function(){var r=(0,f.Z)({},gt,e);u(mt(r,r.formData))}),[e]);var p=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.schema,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.additionalMetaSchemas,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.customFormats,o=t.validate,a=t.transformErrors,s=Lr(t).rootSchema,l=ot(r,s,e);return Br(e,l,o,a,n,i)},h=function(e,r){if(0===r.length&&"object"!==typeof e)return e;var t=ie()(e,r);return Array.isArray(e)?Object.keys(t).map((function(e){return t[e]})):t},m=function(e){if(e.preventDefault(),e.target===e.currentTarget){var r,n,i=d.formData;if(console.log("submit",i),!0===t.omitExtraData){var o=ht(ot(d.schema,d.schema,i),"",d.schema,i),a=ut(o,i);i=h(i,a)}if(!t.noValidate){var s=p(i),c=s.errors,m=s.errorSchema,g=c,x=m;if(Object.keys(c).length>0)return t.extraErrors&&(c=Zr(m=Ye(m,t.extraErrors,!0))),u((0,S.Z)((0,f.Z)({},d),{errors:c,errorSchema:m,schemaValidationErrors:g,schemaValidationErrorSchema:x})),l(m||null),void(t.onError?t.onError(c):console.warn("! Form validation failed",c))}t.extraErrors?n=Zr(r=t.extraErrors):(r={},n=[]),u((0,S.Z)((0,f.Z)({},d),{formData:i,errors:n,errorSchema:r,schemaValidationErrors:[],schemaValidationErrorSchema:{}})),l(r),t.onSubmit&&(console.warn(i),t.onSubmit((0,S.Z)((0,f.Z)({},d),{formData:i,status:"submitted"}),e))}};(0,o.useEffect)((function(){var e=i.current;return null===e||void 0===e||e.addEventListener("submit",m),function(){null===e||void 0===e||e.removeEventListener("submit",m)}})),(0,o.useImperativeHandle)(r,(function(){return{submit:function(){var e;null===(e=i.current)||void 0===e||e.dispatchEvent(new CustomEvent("submit",{cancelable:!0}))}}}));var g=t.children,x=t.id,y=t.idPrefix,v=t.className,b=t.tagName,_=t.name,j=t.method,C=t.target,w=t.action,T=t.autocomplete,O=t.autoComplete,I=t.enctype,k=t.acceptcharset,A=t.noHtml5Validate,Z=t.disabled,F=t.readonly,E=t.formContext,N=d.schema,B=d.uiSchema,D=d.formData,R=d.idSchema,P=Lr(t),M=P.fields.SchemaField,L=b||"form";T&&console.warn("Using autocomplete property of Form is deprecated, use autoComplete instead.");var W=O||T;return(0,n.jsxs)(L,{className:v||"rjsf",id:x,name:_,method:j,target:C,action:w,autoComplete:W,encType:I,acceptCharset:k,noValidate:A,ref:i,children:[function(){var e=d.errors,r=d.errorSchema,i=d.schema,o=d.uiSchema,a=t.ErrorList,s=t.showErrorList,l=t.formContext;return s&&e.length?(0,n.jsx)(a,{errors:e,errorSchema:r,schema:i,uiSchema:o,formContext:l}):null}(),(0,n.jsx)(M,{schema:N,uiSchema:B,errorSchema:s,idSchema:R,idPrefix:y,formContext:E,formData:D,onChange:function(e,r){(Ke(e)||Array.isArray(e))&&(e=mt(t,e,d).formData);var n=!t.noValidate&&t.liveValidate,i={formData:e},o=e;if(!0===t.omitExtraData&&!0===t.liveOmit){var a=ht(ot(d.schema,d.schema,e),"",d.schema,e),s=ut(a,e);i={formData:o=h(e,s)}}if(n){var c=p(o),m=c.errors,g=c.errorSchema,x=m,y=g;t.extraErrors&&(m=Zr(g=Ye(g,t.extraErrors,!0))),i={formData:o,errors:m,errorSchema:g,schemaValidationErrors:x,schemaValidationErrorSchema:y}}else if(!t.noValidate&&r){var v=t.extraErrors?Ye(r,t.extraErrors,!0):r;i={formData:o,errorSchema:v,errors:Zr(v)}}u((0,f.Z)({},d,i)),l(i.errorSchema||null)},onBlur:function(e,r){var n;null===(n=t.onBlur)||void 0===n||n.call(t,e,r)},onFocus:function(e,r){var n;null===(n=t.onFocus)||void 0===n||n.call(t,e,r)},registry:P,disabled:Z,readonly:F,autofocus:!1,required:!1,name:t.name||""}),g||(0,n.jsx)("div",{children:(0,n.jsx)("button",{type:"submit",className:"btn btn-info",children:"Submit"})})]})}));var yt,vt,bt=function(e){return(0,o.forwardRef)((function(r,t){var n=r.fields,i=r.widgets,a=(0,ee.Z)(r,["fields","widgets"]);return n=(0,f.Z)({},e.fields,n),i=(0,f.Z)({},e.widgets,i),(0,o.createElement)(xt,(0,S.Z)((0,f.Z)({},e,a),{fields:n,widgets:i,ref:t}))}))},_t=t(447877),jt=t.n(_t),St=Pr,Ct=function(e){var r,t,i=e.properties,o=e.uiSchema,a=Boolean(null===(r=o["ui:options"])||void 0===r?void 0:r.inline),s=null===(t=o["ui:options"])||void 0===t?void 0:t.layout,l=a?8:4;if(s)return(0,n.jsx)(n.Fragment,{children:s.map((function(e,r){var t=i.filter((function(r){return e.includes(r.name)}));if(t.length){var o=a?"".concat(Math.round(100/t.length),"%"):"100%";return(0,n.jsx)("div",{className:ur()(jt().inlineObjectChildren,(0,oe.Z)({},jt().inline,a)),children:t.map((function(e,r){return(0,n.jsx)("div",{style:{marginRight:l,width:o},children:e.content},r)}))},r)}return null}))});var c=a?"".concat(Math.round(100/i.length),"%"):"100%";return(0,n.jsx)("div",{className:ur()(jt().inlineObjectChildren,(0,oe.Z)({},jt().inline,a)),children:i.map((function(e,r){return(0,n.jsx)("div",{style:{marginRight:l,width:c},children:e.content},r)}))})},wt=function(e){var r,t=e.title,i=e.required,a=e.disabled,s=e.readonly,l=e.uiSchema,c=e.idSchema,d=e.schema,u=e.formData,p=e.onAddClick,h=e.registry.fields.TitleField,m="ui:options"in l&&"collapse"in l["ui:options"],g=!("ui:options"in l)||!("showTitle"in l["ui:options"])||Boolean(l["ui:options"].showTitle),x=function(e,r){return"ui:options"in r&&e in r["ui:options"]?{has:!0,value:r["ui:options"][e]}:{has:!1}}("help",l).value,y=Boolean(null===(r=l["ui:options"])||void 0===r?void 0:r.collapse),v=(0,o.useState)(y),b=v[0],_=v[1];return(0,n.jsxs)("div",{className:jt().objectFieldTemplateWrapper,children:[(l["ui:title"]||t)&&g&&(0,n.jsx)(h,{id:c.$id,title:t,required:i,help:x,hasCollapse:m,onChange:_,defaultCollapse:y,style:{fontSize:14,fontWeight:"bold",color:"#636363",paddingTop:16}}),!b&&(0,n.jsxs)("div",{children:[(0,n.jsx)(Ct,(0,f.Z)({},e)),St(d,l,u)&&(0,n.jsx)("button",{onClick:p(d),disabled:a||s})]})]})},Tt=function(e){var r=e.disabled||e.readonly||!e.hasMoveUp,t=e.disabled||e.readonly||!e.hasMoveDown;return(0,n.jsxs)("div",{className:jt().inlineArrayItem,children:[e.children,e.hasToolbar&&(0,n.jsxs)(n.Fragment,{children:[(e.hasMoveUp||e.hasMoveDown)&&(0,n.jsx)(i.IconButton,{disabled:r,size:"small",onClick:e.onReorderClick(e.index,e.index-1),icon:M.ArrowUpOutlined}),(e.hasMoveUp||e.hasMoveDown)&&(0,n.jsx)(i.IconButton,{disabled:t,onClick:e.onReorderClick(e.index,e.index+1),icon:M.ArrowDownOutlined}),e.hasRemove&&(0,n.jsx)(i.IconButton,{disabled:e.disabled||e.readonly,onClick:e.onDropIndexClick(e.index),icon:M.DeleteOutlined})]})]})},Ot=t(47318).P6.f_,It=t(873999),kt=t.n(It),At=t(599162),Zt=Mr(),Ft=Zt.fields,Et=Zt.widgets,Nt={TextWidget:function(e){var r=(0,ar.Z)((0,At.Z)(e,{defaultValue:{type:"Literal",value:""}}),2),t=r[0],o=r[1],a=e.rawErrors,s=e.error,l=Boolean(null===a||void 0===a?void 0:a.length),c=null===a||void 0===a?void 0:a.join(",");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.TextInput,{value:(null===t||void 0===t?void 0:t.value)||"",onChange:function(e){return o({type:"Literal",value:e.target.value})},block:!0}),l&&(0,n.jsx)("div",{className:ur()(kt().helperText,(0,oe.Z)({},kt().error,s)),children:c})]})},SelectWidget:function(e){var r,t=e.options.enumOptions,o=e.value,a=e.onChange,l=e.rawErrors,c=Boolean(null===l||void 0===l?void 0:l.length)?{border:"1px solid red",width:"100%"}:{width:"100%"};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(i.Select,{options:t||[],value:(r=o,null==r?null:"Literal"===r.type?r.value:r),onSelected:function(e){a(jr(e.value))},dropdownMatchSelectWidth:!0,noDataTip:(0,s.t)(s.Strings.no_option),triggerStyle:c,placeholder:(0,s.t)(s.Strings.robot_select_option)})})}},Bt={ObjectFieldTemplate:wt,ArrayFieldTemplate:function(e){var r=e.items.length>0?8:0;return(0,n.jsxs)("div",{children:[e.items.map((function(e){return(0,o.createElement)(Tt,(0,S.Z)((0,f.Z)({},e),{key:e.key}))})),e.canAdd&&(0,n.jsx)("div",{style:{marginTop:r},children:(0,n.jsxs)(i.Button,{onClick:e.onAddClick,size:"small",children:["+ ",(0,s.t)(s.Strings.robot_action_send_web_request_add_header_button)]})})]})},FieldTemplate:function(e){var r=e.id,t=e.classNames,o=e.label,a=e.help,s=e.required,l=e.children,c=e.uiSchema,d=e.description,u=e.errors,p=Ot(e.schema),h=(0,i.useTheme)(),f=["key","value"].includes(e.label),m=function(){var e,r="object"!==p;"ui:options"in c&&"showTitle"in c["ui:options"]&&(r=Boolean(null===(e=c["ui:options"])||void 0===e?void 0:e.showTitle));return r},g=function(){if(m())return 16;var e=(0,ar.Z)((r||"").split("-"),2)[1];return f||1===parseInt(e,10)&&!m()?0:8}(),x=f?8:0;return(0,n.jsxs)("div",{className:t,style:{width:"100%",paddingTop:g,marginBottom:x},children:[m()&&(0,n.jsxs)(i.Typography,{variant:"h7",color:h.color.fc2,children:[s?(0,n.jsx)("span",{style:{color:"red"},children:"* "}):null,o]}),d,l,u,a]})},fields:Ft,widgets:(0,f.Z)({},Et,Nt),ErrorList:function(){return(0,n.jsx)("div",{})}},Dt=bt(Bt),Rt=function(e){var r=(0,o.useRef)(null),t=(0,o.useState)(!1),l=t[0],c=t[1],h=e.title,m=e.serviceLogo,g=e.children,x=e.description,y=e.type,b=void 0===y?"trigger":y,_=e.nodeId,j=e.index,w=void 0===j?0:j,T=(0,ee.Z)(e,["title","serviceLogo","children","description","type","nodeId","index"]),O=(0,i.useTheme)(),I="trigger"===b?(0,s.t)(s.Strings.robot_trigger_guide):(0,s.t)(s.Strings.robot_action_guide),k="trigger"===b?(0,s.t)(s.Strings.robot_trigger_type):(0,s.t)(s.Strings.robot_action_type),A="trigger"===b?(0,s.t)(s.Strings.robot_trigger_config):(0,s.t)(s.Strings.robot_action_config),Z=(0,s.validateMagicForm)(T.schema,T.formData).hasError,F=(0,v.Vq)(),E=(0,v.ym)().currentRobotId,N="robot_".concat(b,"_").concat(_),B=[[{text:(0,s.t)(s.Strings.robot_action_delete),icon:(0,n.jsx)(M.DeleteOutlined,{}),onClick:function(){C.u_.confirm({title:(0,s.t)(s.Strings.robot_action_delete),content:(0,s.t)(s.Strings.robot_action_delete_confirm_desc),cancelText:(0,s.t)(s.Strings.cancel),okText:(0,s.t)(s.Strings.confirm),onOk:(0,d.Z)((function(){return(0,u.__generator)(this,(function(e){switch(e.label){case 0:return[4,F(_)];case 1:return e.sent()&&(0,a.JG)("/robots/".concat(E,"/actions")),[2]}}))})),onCancel:function(){},type:"warning"})}}]],D=(0,i.useContextMenu)({id:N}).show;return(0,n.jsxs)(n.Fragment,{children:[0===w&&(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.Box,{height:"12px",width:"2px",backgroundColor:O.color.fc0,marginRight:"4px"}),(0,n.jsx)(i.Typography,{variant:"body2",children:I})]}),(0,n.jsxs)(i.Box,{border:"1px solid ".concat(O.color.lineColor),borderRadius:"8px",height:l?"max-content":"48px",width:"100%",margin:"8px 0px",padding:"12px 24px",backgroundColor:O.color.fc8,id:"robot_node_".concat(_),children:[(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",children:[(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",onClick:function(){return c(!l)},width:"100%",style:{cursor:"pointer"},children:[(0,n.jsx)("span",{style:{borderRadius:4,marginRight:"4px",display:"flex",alignItems:"center"},children:(0,n.jsx)(te(),{src:m||"?",width:24,height:24})}),(0,n.jsx)(i.Typography,{variant:"h7",ellipsis:!0,children:h}),Z&&(0,n.jsx)(i.Box,{marginLeft:"4px",display:"flex",alignItems:"center",children:(0,n.jsx)(i.Tooltip,{content:(0,s.t)(s.Strings.robot_config_incomplete_tooltip),children:(0,n.jsx)(i.Box,{as:"span",marginLeft:"4px",display:"flex",alignItems:"center",children:(0,n.jsx)(M.WarnCircleFilled,{color:O.color.textWarnDefault})})})})]}),"action"===b&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.IconButton,{shape:"square",icon:M.MoreStandOutlined,onClick:function(e){return D(e)}}),(0,n.jsx)(i.ContextMenu,{overlay:(0,p.Dg)(B,!0),menuId:N})]})]}),l&&(0,n.jsxs)(i.Box,{marginTop:"13px",paddingTop:"16px",borderTop:"1px solid ".concat(O.color.lineColor),children:[(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",style:{marginBottom:4},children:[(0,n.jsx)(i.Box,{height:"12px",width:"2px",backgroundColor:O.color.fc0,marginRight:"4px"}),(0,n.jsx)(i.Typography,{variant:"h7",color:O.color.fc1,children:k})]}),g,(0,n.jsx)(i.Typography,{variant:"body4",style:{marginTop:4},color:O.color.fc3,children:x}),(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",style:{marginTop:16,marginBottom:-16},children:[(0,n.jsx)(i.Box,{height:"12px",width:"2px",backgroundColor:O.color.fc0,marginRight:"4px"}),(0,n.jsx)(i.Typography,{variant:"h7",color:O.color.fc1,children:A})]}),(0,n.jsx)(Dt,(0,S.Z)((0,f.Z)({},T),{ref:r,liveValidate:!0,style:{marginTop:-24},children:(0,n.jsx)(i.Box,{marginTop:"16px",display:"flex",flexDirection:"row-reverse",children:(0,n.jsxs)(i.Box,{display:"flex",children:[(0,n.jsx)(i.Button,{onClick:function(){return c(!l)},variant:"fill",size:"small",style:{marginRight:16},children:(0,s.t)(s.Strings.robot_cancel_save_step_button)}),(0,n.jsx)(i.Button,{variant:"fill",size:"small",onClick:function(){var e;null===(e=r.current)||void 0===e||e.submit()},color:"primary",children:(0,s.t)(s.Strings.robot_save_step_button)})]})})}))]})]})]})},Pt=function(e){var r=(0,ar.Z)((0,At.Z)(e),1)[0],t=e.onChange,o=e.options,a=e.placeholder;return(0,n.jsx)(i.Select,{placeholder:a,options:o,value:r,onSelected:function(e){t&&t(e.value)}})},Mt=function(e){var r=e.actionTypes,t=e.action,i=e.robotId,c=e.nodeOutputSchemaList,d=e.index,u=void 0===d?0:d,p=(0,v.lo)(i),m=r.find((function(e){return e.actionTypeId===t.typeId})),x=t.input,b=(0,o.useCallback)((function(e){e!==(null===t||void 0===t?void 0:t.typeId)&&C.u_.confirm({title:(0,s.t)(s.Strings.robot_change_action_tip_title),content:(0,s.t)(s.Strings.robot_change_action_tip_content),cancelText:(0,s.t)(s.Strings.cancel),okText:(0,s.t)(s.Strings.confirm),onOk:function(){(0,h.Pu)(null===t||void 0===t?void 0:t.id,e).then((function(){(0,a.JG)("/robots/".concat(i,"/actions"))}))},onCancel:function(){},type:"warning"})}),[t,i]);if(!m)return null;var _=c.findIndex((function(e){return e.id===t.id})),j=c.slice(0,_),w=g(y(r,t.typeId)),T=m.inputJsonSchema,O=T.uiSchema,I=T.schema;return(0,n.jsx)(Rt,{nodeId:t.id,type:"action",index:u,title:m.name,validate:function(e,r){if(m&&"sendLarkMsg"===m.endpoint)try{var t=function(e){var r=new s.MagicVariableParser(s.ACTION_INPUT_PARSER_BASE_FUNCTIONS,s.ACTION_INPUT_PARSER_PASS_THROUGH_FUNCTIONS);return new s.InputParser(r).render(e,{})}(e),n=t||{},i=n.type,o=n.content;"markdown"===i&&/!\[[^\]]*\]\((.*?)\s*("(?:.*[^"])")?\s*\)/.test(o)&&r.addError((0,s.t)(s.Strings.robot_action_send_lark_message_markdown_error))}catch(a){console.error("robot form validate error",a)}return r},onSubmit:function(e){var r=e.formData;(0,l.shallowEqual)(r,x)||(0,h.Py)(t.id,r).then((function(){(0,a.JG)("/robots/".concat(i,"/actions")),C.v0.success({content:(0,s.t)(s.Strings.robot_save_step_success)})})).catch((function(){C.v0.error({content:"\u6b65\u9aa4\u4fdd\u5b58\u5931\u8d25"})}))},description:m.description,formData:x,serviceLogo:(0,s.integrateCdnHost)(m.service.logo),schema:I,uiSchema:O,nodeOutputSchemaList:j,widgets:{TextWidget:function(e){return(0,n.jsx)(Q,(0,S.Z)((0,f.Z)({},e),{nodeOutputSchemaList:j,triggerType:p}))}},children:(0,n.jsx)(Pt,{options:w,onChange:b,value:t.typeId})},t.id)},Lt=function(e){var r=e.robotId,t=e.actionTypes,o=e.prevActionId,l=function(){var e=(0,d.Z)((function(e){var t;return(0,u.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,h.PH)(e)];case 1:return t=n.sent(),(0,a.JG)("/robots/".concat(r,"/actions")),[2,t.data]}}))}));return function(r){return e.apply(this,arguments)}}(),c="CONTEXT_MENU_ID_1",f=(0,i.useContextMenu)({id:c}).show;return(0,n.jsxs)(i.Box,{marginTop:"16px",display:"flex",alignItems:"center",justifyContent:"center",children:[(0,n.jsx)(i.Tooltip,{content:(0,s.t)(s.Strings.robot_new_action_tooltip),children:(0,n.jsx)(i.Box,{children:(0,n.jsx)(i.TextButton,{onClick:f,prefixIcon:(0,n.jsx)(M.AddOutlined,{}),children:(0,n.jsx)("span",{children:(0,s.t)(s.Strings.robot_new_action)})})})}),(0,n.jsx)(i.ContextMenu,{menuId:c,overlay:(0,p.Dg)([t.map((function(e){return{text:e.name,icon:(0,n.jsx)("img",{src:(0,s.integrateCdnHost)(e.service.logo),width:20,alt:"",style:{marginRight:4}}),onClick:function(){l({robotId:r,actionTypeId:e.actionTypeId,prevActionId:o})}}}))],!0)})]})},Wt=j().create({baseURL:"/nest/v1/"}),Vt=function(e){var r,t=e.robotId,s=e.triggerTypes,l=e.actionTypes,c=e.trigger,d=e.onScrollBottom,u=(0,b.Z)(d,{wait:100}).run,p=(0,o.useMemo)((function(){return y(l)}),[l]),h=(0,a.ZP)("/robots/".concat(t,"/actions"),Wt),f=h.data,m=h.error;if(!f||m)return null;var g=f.data.data,x=null===(r=g.find((function(e){return null===e.prevActionId})))||void 0===r?void 0:r.id;if(!x)return(0,n.jsx)(Lt,{robotId:t,actionTypes:p});var v=g.reduce((function(e,r){return e[r.id]=r,e}),{});Object.keys(v).forEach((function(e){var r=v[e];r.prevActionId&&(v[r.prevActionId].nextActionId=r.id)}));var _=[v[x]];Object.keys(v).forEach((function(e){var r=v[e];r.nextActionId&&_.push(v[r.nextActionId])})),u();var j=function(e){var r=e.actionList,t=e.triggerTypes,n=e.actionTypes,i=e.trigger,o=i&&t.find((function(e){return e.triggerTypeId===(null===i||void 0===i?void 0:i.triggerTypeId)})),a=[];return o&&a.push({id:null===i||void 0===i?void 0:i.triggerId,title:o.name,schema:o.outputJsonSchema}),r.forEach((function(e){var r=n.find((function(r){return r.actionTypeId===e.typeId}));r&&a.push({id:e.id,title:r.name,schema:["sendWecomMsg","sendLarkMsg","sendDingtalkMsg"].includes(null===r||void 0===r?void 0:r.endpoint)?void 0:r.outputJsonSchema})})),a}({actionList:_,actionTypes:l,triggerTypes:s,trigger:c});return(0,n.jsxs)(i.Box,{width:"100%",marginTop:"24px",children:[_.map((function(e,r){return(0,n.jsx)(Mt,{index:r,action:e,actionTypes:l,nodeOutputSchemaList:j,robotId:t},r)})),(0,n.jsx)(Lt,{robotId:t,actionTypes:p,prevActionId:_[_.length-1].id})]})},Ut=t(585421),qt=function(){var e=(0,v.ym)(),r=e.currentRobotId,t=e.robot,o=e.updateRobot,a=e.setIsEditingRobotName,l=e.isEditingRobotName,c=e.setIsEditingRobotDesc,p=e.isEditingRobotDesc,m=(0,v.Wq)(r),g=(0,v.tm)(r),x=g.loading,y=g.toggleRobotActive,b=(0,i.useTheme)();if(!t)return null;var _=function(){var e=(0,d.Z)((function(e){return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return e===t.name?[3,2]:[4,(0,h.XM)(t.robotId,e)];case 1:r.sent()&&o((0,S.Z)((0,f.Z)({},t),{name:e})),r.label=2;case 2:return a(!1),[2]}}))}));return function(r){return e.apply(this,arguments)}}(),j=function(){var e=(0,d.Z)((function(e){return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return e===t.description?[3,2]:[4,(0,h.Oc)(t.robotId,e)];case 1:r.sent()&&o((0,S.Z)((0,f.Z)({},t),{description:e})),r.label=2;case 2:return c(!1),[2]}}))}));return function(r){return e.apply(this,arguments)}}(),C=t.description||m;return(0,n.jsxs)(i.Box,{marginBottom:"24px",children:[(0,n.jsxs)(i.Box,{display:"flex",justifyContent:"space-between",children:[(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.Avatar,{icon:(0,n.jsx)("img",{src:(0,s.integrateCdnHost)((0,Ut.Sy)().ROBOT_DEFAULT_AVATAR),width:24,height:24,alt:"robot"}),size:"xs",style:{minWidth:"24px"}}),(0,n.jsx)(i.Box,{marginLeft:"4px",children:l?(0,n.jsx)(i.TextInput,{size:"small",autoFocus:!0,block:!0,defaultValue:t.name,onBlur:function(e){return _(e.target.value)}}):(0,n.jsx)("div",{onDoubleClick:function(){return a(!0)},children:(0,n.jsx)(i.Typography,{variant:"h6",children:t.name||(0,s.t)(s.Strings.robot_unnamed)})})})]}),(0,n.jsx)(i.Switch,{checked:t.isActive,onClick:y,loading:x,disabled:x})]}),(0,n.jsx)(i.Box,{marginTop:"4px",display:"flex",alignItems:"center",children:p?(0,n.jsx)(i.TextInput,{size:"small",autoFocus:!0,defaultValue:C,block:!0,onBlur:function(e){return j(e.target.value)}}):(0,n.jsx)("div",{onDoubleClick:function(){return c(!0)},children:(0,n.jsx)(i.Typography,{variant:"body3",ellipsis:{rows:2,tooltip:C},color:b.color.fc3,children:C})})})]})},Jt=t(276635),$t=t(864453),Ht=t(278687),zt=function(e){var r=e.field,t=e.fop,i=e.onChange,a=e.value,l=(0,o.useMemo)((function(){return{conjunction:s.FilterConjunction.And,conditions:[{conditionId:"random",fieldId:r.id,operator:t,fieldType:r.type,value:a}]}}),[a,r,t]),c=l.conditions[0],d=(0,o.useCallback)((function(e){var r=e(l);i(r.conditions[0].value)}),[l,i]);return(0,n.jsx)(Ht.s,{style:{width:"100%"},field:r,conditionIndex:0,condition:c,changeFilter:d,hiddenClientOption:!0})},Gt=(yt={},(0,oe.Z)(yt,s.FieldType.DeniedField,M.LockFilled),(0,oe.Z)(yt,s.FieldType.Text,M.LongtextOutlined),(0,oe.Z)(yt,s.FieldType.Number,M.NumberOutlined),(0,oe.Z)(yt,s.FieldType.SingleSelect,M.SelectSingleOutlined),(0,oe.Z)(yt,s.FieldType.MultiSelect,M.SelectMultipleOutlined),(0,oe.Z)(yt,s.FieldType.DateTime,M.CalendarOutlined),(0,oe.Z)(yt,s.FieldType.Attachment,M.AttachmentOutlined),(0,oe.Z)(yt,s.FieldType.Link,M.LinktableOutlined),(0,oe.Z)(yt,s.FieldType.URL,M.LinkOutlined),(0,oe.Z)(yt,s.FieldType.Email,M.EmailOutlined),(0,oe.Z)(yt,s.FieldType.Phone,M.TelephoneOutlined),(0,oe.Z)(yt,s.FieldType.Checkbox,M.CheckboxOutlined),(0,oe.Z)(yt,s.FieldType.Rating,M.StarOutlined),(0,oe.Z)(yt,s.FieldType.Member,M.UserOutlined),(0,oe.Z)(yt,s.FieldType.LookUp,M.LookupOutlined),(0,oe.Z)(yt,s.FieldType.Formula,M.FormulaOutlined),(0,oe.Z)(yt,s.FieldType.Currency,M.CurrencyUsdOutlined),(0,oe.Z)(yt,s.FieldType.Percent,M.PercentOutlined),(0,oe.Z)(yt,s.FieldType.SingleText,M.TextOutlined),(0,oe.Z)(yt,s.FieldType.AutoNumber,M.AutonumberOutlined),(0,oe.Z)(yt,s.FieldType.CreatedTime,M.TimeOutlined),(0,oe.Z)(yt,s.FieldType.LastModifiedTime,M.HistoryFilled),(0,oe.Z)(yt,s.FieldType.CreatedBy,M.UserAddOutlined),(0,oe.Z)(yt,s.FieldType.LastModifiedBy,M.UserEditOutlined),yt),Kt=function(e){var r=e.fields,t=e.value,o=e.onChange,a=function(e,r){return e.map((function(e){var t={label:e.name,value:e.id},i=Gt[e.type];return(0,S.Z)((0,f.Z)({},t),{disabled:e.type===s.FieldType.DeniedField,prefixIcon:(0,n.jsx)(i,{color:r.palette.text.third})})}))}(r,(0,i.useTheme)());return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(i.Select,{options:a,value:t,onSelected:function(e){o&&o(e.value)},hideSelectedOption:!t,dropdownMatchSelectWidth:!0,openSearch:a.length>7})})},Yt=t(626535),Xt=t(14745),Qt=t.n(Xt),en=function(e){return null==e||(0,Jt.isEqual)(e,s.EmptyNullOperand)?{operator:s.OperatorEnums.And,operands:[]}:e},rn=function(e){var r=(0,i.useTheme)();return(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",gridColumn:"property-start / value-end",children:[(0,n.jsx)(M.WarnCircleFilled,{color:r.color.fc10}),(0,n.jsx)(i.Typography,{color:r.color.fc10,variant:"body3",style:{marginLeft:"4px"},children:e.children})]})},tn=function(e){var r,t=e.datasheetId,a=e.hasParent,c=void 0!==a&&a,d=e.onChange,u=e.depth,p=void 0===u?0:u,h=(0,o.useState)(en(e.filter)),m=h[0],g=h[1],x=!c,y=(0,o.useCallback)((function(e){var r;(g(e),d)&&d(x?{type:s.OperandTypeEnums.Literal,value:0===(null===(r=e.operands)||void 0===r?void 0:r.length)?null:e}:e)}),[d,x]);(0,o.useEffect)((function(){g(en(e.filter))}),[e.filter]);var v=!((0,Jt.isEqual)(m,s.EmptyNullOperand)||"and"===m.operator||"or"===m.operator),b=function(e,r){var t=JSON.parse(JSON.stringify(m));(0,Jt.set)(t,e,r),y(t)},_=(0,$t.E3)(t),j=(0,l.useSelector)((function(e){return s.Selectors.getSnapshot(e,t)})),C=(0,l.useSelector)((function(e){return s.Selectors.getFieldPermissionMap(e,t)})),w=j.meta.fieldMap,O=(0,Yt.VN)(_,w),I=O[0].id,k=(0,o.useCallback)((function(e){var r=(0,Yt.Xs)(m,e,I);y(r)}),[m,y,I]),A=[{value:"and",label:(0,Yt.gN)("and")},{value:"or",label:(0,Yt.gN)("or")}];if(v){var Z=m.operands[0].value,F=w[Z];if(null==F)return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(rn,{children:(0,s.t)(s.Strings.robot_trigger_record_matches_condition_invalid_field)})});if(s.Selectors.getFieldRoleByFieldId(C,Z)===s.ConfigConstant.Role.None)return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(rn,{children:(0,s.t)(s.Strings.robot_trigger_record_matches_condition_cannot_access_field)})});var E=(0,Yt.BU)(F),N=![s.OperatorEnums.IsNotNull,s.OperatorEnums.IsNull].includes(m.operator),B=(0,Yt.ep)(m.operator);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Kt,{fields:O,value:m.operands[0].value,onChange:function(e){return b("operands[0].value",e)}}),(0,n.jsx)(Pt,{options:E,value:m.operator,onChange:function(e){return b("operator",e)}}),(0,n.jsx)("div",{children:N&&(0,n.jsx)(zt,{field:F,fop:B,value:m.operands[1].value,onChange:function(e){return b("operands[1].value",e)}})})]})}var D=c?"div":o.Fragment,R=c?{className:Qt().subGroupWrapper}:{};return(0,n.jsx)(D,(0,S.Z)((0,f.Z)({},R),{children:(0,n.jsxs)("div",{className:Qt().groupWrapperWithAdd,children:[(0,n.jsx)("div",{className:Qt().groupWrapper,children:null===m||void 0===m||null===(r=m.operands)||void 0===r?void 0:r.map((function(e,r){var a="operands[".concat(r,"].value");return(0,n.jsxs)(o.Fragment,{children:[0==r?(0,n.jsx)(i.Typography,{variant:"body3",style:{paddingLeft:4},children:(0,s.t)(s.Strings.robot_trigger_match_condition_when)}):1===r?(0,n.jsx)(Pt,{options:A,value:m.operator,onChange:function(e){return b("operator",e)}}):(0,n.jsxs)(i.Typography,{variant:"body3",style:{paddingLeft:4},children:[" ",(0,Yt.gN)(m.operator)]}),(0,n.jsx)(tn,{path:a,filter:e.value,datasheetId:t,hasParent:!0,depth:p+1,onChange:function(e){b(a,e)}}),(0,n.jsx)(i.IconButton,{shape:"square",icon:M.DeleteOutlined,onClick:function(){!function(e){var r=(0,T.ZP)(m,(function(r){r.operands.splice(e,1)}));y(r)}(r)}})]},a)}))}),(0,n.jsx)("div",{className:Qt().addFilterWrapper,children:(0,n.jsx)(i.Button,{prefixIcon:(0,n.jsx)(M.AddOutlined,{}),variant:"fill",onClick:function(){k(Yt.U1.Filter)},children:(0,s.t)(s.Strings.robot_trigger_add_match_condition_button)})})]})}))},nn=function(e){var r=e.robotId,t=e.triggerTypes,l=(0,v.eN)(),c=(0,i.useTheme)(),p=(0,o.useMemo)((function(){return function(){var e=(0,d.Z)((function(e){var n,i,o;return(0,u.__generator)(this,(function(s){switch(s.label){case 0:return n=t.find((function(r){return r.triggerTypeId===e})),i="record_created"===(null===n||void 0===n?void 0:n.endpoint)?l:void 0,[4,(0,h.$y)(r,e,i)];case 1:return o=s.sent(),(0,a.JG)("/robots/".concat(r,"/trigger")),[2,o.data]}}))}));return function(r){return e.apply(this,arguments)}}()}),[r,l,t]);if(!t)return null;var f=t.map((function(e){return{label:e.name,value:e.triggerTypeId}}));return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{color:c.color.fc3,fontSize:12,paddingBottom:8},children:(0,s.t)(s.Strings.robot_no_step_config_1)}),(0,n.jsx)(Pt,{options:f,onChange:function(e){e&&p(e)},placeholder:(0,s.t)(s.Strings.robot_select_option)})]})},on=function(e){var r=e.trigger,t=e.mutate,i=e.triggerTypes,a=e.formList,c=e.datasheetId,d=e.datasheetName,u=r.input,p=r.triggerTypeId,m=i.find((function(e){return e.triggerTypeId===r.triggerTypeId})),x=(0,o.useCallback)((function(e){e!==(null===r||void 0===r?void 0:r.triggerTypeId)&&C.u_.confirm({title:(0,s.t)(s.Strings.robot_change_trigger_tip_title),content:(0,s.t)(s.Strings.robot_change_trigger_tip_content),cancelText:(0,s.t)(s.Strings.cancel),okText:(0,s.t)(s.Strings.confirm),onOk:function(){(0,h.gU)(null===r||void 0===r?void 0:r.triggerId,e).then((function(){t((0,S.Z)((0,f.Z)({},r),{input:null,triggerTypeId:e}))}))},onCancel:function(){},type:"warning"})}),[r,t]),y=(0,o.useMemo)((function(){return function(e){return(0,T.ZP)(e.inputJsonSchema,(function(r){var t=r.schema.properties;switch(e.endpoint){case"form_submitted":t.formId.enum=a.map((function(e){return e.nodeId})),t.formId.enumNames=a.map((function(e){return e.nodeName}));break;case"record_matches_conditions":case"record_created":t.datasheetId.default=c,t.datasheetId.enum=[c],t.datasheetId.enumNames=[d]}return r}))}(m)}),[c,d,a,m]),v=y.schema,b=y.uiSchema,_=void 0===b?{}:b,j=(0,o.useMemo)((function(){return g(i)}),[i]),w=(0,o.useMemo)((function(){return"record_matches_conditions"===(null===m||void 0===m?void 0:m.endpoint)?(0,S.Z)((0,f.Z)({},_),{filter:{"ui:widget":function(e){var r=e.value,t=e.onChange,i=null==r||(0,Jt.isEqual)(r,s.EmptyNullOperand)?{operator:s.OperatorEnums.And,operands:[]}:r.value;return(0,n.jsx)(tn,{datasheetId:c,filter:i,onChange:function(e){t(e)}})}},datasheetId:{"ui:disabled":!0}}):{}}),[c,null===m||void 0===m?void 0:m.endpoint,_]),O=(0,o.useCallback)((function(e){var n=e.formData;(0,l.shallowEqual)(n,r.input)||(0,h.C_)(r.triggerId,n).then((function(){t((0,S.Z)((0,f.Z)({},r),{input:n})),C.v0.success({content:(0,s.t)(s.Strings.robot_save_step_success)})})).catch((function(){C.v0.error({content:"\u6b65\u9aa4\u4fdd\u5b58\u5931\u8d25"})}))}),[t,r]);return(0,n.jsx)(Rt,{nodeId:r.triggerId,schema:v,formData:u,uiSchema:w,onSubmit:O,title:null===m||void 0===m?void 0:m.name,description:null===m||void 0===m?void 0:m.description,serviceLogo:(0,s.integrateCdnHost)(m.service.logo),children:(0,n.jsx)(Pt,{options:j,onChange:x,value:p})})},an=function(e){var r=e.robotId,t=e.triggerTypes,i=e.formList,c=e.setTrigger,d=(0,a.ZP)("/robots/".concat(r,"/trigger"),h.st),u=d.data,p=d.error,f=d.mutate;(0,o.useEffect)((function(){u&&c(u)}),[u,c]);var m=(0,l.useSelector)((function(e){var r=s.Selectors.getDatasheet(e);return{datasheetId:null===r||void 0===r?void 0:r.id,datasheetName:null===r||void 0===r?void 0:r.name}}),l.shallowEqual),g=m.datasheetId,x=m.datasheetName;return p||!t?null:u?(0,n.jsx)(on,{trigger:u,mutate:f,triggerTypes:t,formList:i,datasheetId:g,datasheetName:x}):(0,n.jsx)(nn,{robotId:r,triggerTypes:t})},sn=function(e){var r=e.formList,t=(0,o.useState)(),a=t[0],s=t[1],l=(0,o.useRef)(null),c=(0,v.ov)(),d=c.loading,u=c.data,p=(0,v.QB)(),h=p.loading,f=p.data,m=(0,v.ym)().robot;if(d||!u||h||!f||!m)return null;return(0,n.jsxs)(i.Box,{ref:l,children:[(0,n.jsx)(qt,{}),(0,n.jsx)(an,{robotId:m.robotId,triggerTypes:f,formList:r,setTrigger:s}),(0,n.jsx)(Vt,{robotId:m.robotId,trigger:a,triggerTypes:f,actionTypes:u,onScrollBottom:function(){var e=l.current;if(e){var r=e.scrollHeight,t=e.offsetHeight;r>t&&(e.scrollTop=r-t)}}})]})},ln=t(893923),cn=t(666635),dn=t(759209),un=t.n(dn),pn=function(e){var r=e.nodeType,t=e.index,a=e.children,l=e.nodeDetail,c=0===t,d=(0,i.useTheme)(),u=(0,o.useState)(!1),p=u[0],h=u[1],f=l.errorStacks&&l.errorStacks.length>0;return(0,n.jsxs)(i.Box,{children:[(0,n.jsxs)(i.Box,{height:"24px",display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:c?"0px":"24px",style:{cursor:"pointer"},onClick:function(){return h(!p)},children:[(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(te(),{src:(0,s.integrateCdnHost)(r.service.logo),alt:r.service.name,width:24,height:24}),(0,n.jsx)(i.Typography,{variant:"h7",color:d.color.fc1,style:{marginLeft:8},children:r.name}),f&&(0,n.jsx)(i.Box,{marginLeft:"4px",display:"flex",alignItems:"center",children:(0,n.jsx)(i.Tooltip,{content:(0,s.t)(s.Strings.robot_run_history_fail_tooltip),children:(0,n.jsx)(i.Box,{as:"span",marginLeft:"4px",display:"flex",alignItems:"center",children:(0,n.jsx)(M.WarnCircleFilled,{})})})})]}),(0,n.jsx)("span",{className:ur()(un().arrowIcon,(0,oe.Z)({},un().rotated,p)),children:(0,n.jsx)(i.IconButton,{icon:M.ChevronDownOutlined,className:un().dropIcon,onClick:function(){return h(!p)}})})]}),p&&(0,n.jsx)(i.Box,{marginTop:"16px",children:a})]})},hn=function(e){var r=e.label,t=e.value,o=(0,i.useTheme)();return t?(0,n.jsxs)(i.Box,{children:[(0,n.jsx)(i.Typography,{variant:"body3",color:o.color.fc1,children:r}),(0,n.jsx)(i.Typography,{variant:"body4",color:o.color.fc2,children:"object"===typeof t?JSON.stringify(t,null,"\t"):t.toString()})]}):null},fn=function(e){var r=(0,i.useTheme)();return(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.Box,{height:"12px",width:"2px",backgroundColor:e.hasError?r.color.fc10:r.color.fc0,marginRight:"4px"}),(0,n.jsx)(i.Typography,{variant:"body2",color:e.hasError?r.color.fc10:r.color.fc1,children:e.children})]})},mn=t(471391),gn=t.n(mn),xn=function(e){var r=e.nodeSchema,t=e.formData,o=e.disableRetrieveSchema,a=(0,i.useTheme)();if(!r||!t)return(0,n.jsx)(i.Box,{marginTop:"8px",marginBottom:"16px",padding:"0 16px",boxShadow:"inset 1px 0px 0px ".concat(a.color.fc5),children:(0,n.jsx)(i.Typography,{variant:"body4",color:a.color.fc2,children:(0,s.t)(s.Strings.robot_run_history_no_output)})});var l=o?r.schema:ot(r.schema,r.schema,(0,s.data2Operand)(t));return(0,n.jsx)(i.Box,{marginTop:"8px",marginBottom:"16px",padding:"0 16px",boxShadow:"inset 1px 0px 0px ".concat(a.color.fc5),className:gn().historyDetailList,children:"object"===l.type&&Object.keys(l.properties).map((function(e){var r=t[e],i=l.properties[e].title||"";return(0,n.jsx)(hn,{label:i,value:r},e)}))})},yn=function(e){var r=e.nodeType,t=e.nodeDetail,o=(0,l.useSelector)(s.Selectors.getActiveDatasheetId),a=(0,l.useSelector)((function(e){return s.Selectors.getFieldPermissionMap(e,o)})),c=(0,v.jf)();if(!a||!c)return null;var d={schema:r.outputJsonSchema},u=P(d,c,a);return(0,n.jsxs)(i.Box,{children:[(0,n.jsx)(fn,{children:(0,s.t)(s.Strings.robot_run_history_input)}),(0,n.jsx)(xn,{nodeSchema:r.inputJsonSchema,formData:t.input}),(0,n.jsx)(fn,{children:(0,s.t)(s.Strings.robot_run_history_output)}),(0,n.jsx)(xn,{nodeSchema:u,formData:t.output,disableRetrieveSchema:!0})]})},vn=function(e){var r,t=(0,i.useTheme)();return(0,n.jsx)(i.Box,{marginTop:"8px",padding:"0 16px",boxShadow:"inset 1px 0px 0px ".concat(t.color.fc5),children:null===(r=e.errorStacks)||void 0===r?void 0:r.map((function(e,r){return(0,n.jsx)(i.Typography,{color:t.color.red[500],variant:"body4",children:e.message},r)}))})},bn={schema:{type:"object",required:["status"],properties:{status:{title:(0,s.t)(s.Strings.robot_run_history_status_code),type:"number"},json:{title:(0,s.t)(s.Strings.robot_run_history_returned_data),type:"object"}},additionalProperties:!1},uiSchema:{"ui:order":["status","json"]}},_n=function(e){var r=e.nodeDetail,t=(0,T.ZP)(e.nodeType,(function(e){return"sendRequest"===e.endpoint?e.outputJsonSchema=(0,f.Z)({},bn):e.outputJsonSchema=void 0,e})),o=r.errorStacks&&r.errorStacks.length>0;return(0,n.jsxs)(i.Box,{children:[(0,n.jsx)(fn,{children:(0,s.t)(s.Strings.robot_run_history_input)}),(0,n.jsx)(xn,{nodeSchema:t.inputJsonSchema,formData:r.input}),(0,n.jsx)(fn,{hasError:o,children:o?(0,s.t)(s.Strings.robot_run_history_error):(0,s.t)(s.Strings.robot_run_history_output)}),o?(0,n.jsx)(vn,{errorStacks:r.errorStacks}):(0,n.jsx)(xn,{nodeSchema:t.outputJsonSchema,formData:r.output.data})]})},jn=function(e){var r=e.taskId,t="/robots/run-history/".concat(r),o=(0,v.m8)(),l=(0,a.ZP)(t,h.Gf),c=l.data,d=l.error,u=(0,i.useTheme)();if(d||!c)return null;var p=null===c||void 0===c?void 0:c.data.data.data;if(!p)return(0,n.jsx)(i.Box,{padding:"16px",children:(0,n.jsxs)(i.Typography,{variant:"body3",children:[(0,s.t)(s.Strings.robot_run_history_fail_unknown_error)," (taskId: ",r,")"]})});if(!p.nodeByIds)return(0,n.jsx)(i.Box,{padding:"16px",children:(0,n.jsx)(i.Typography,{variant:"body3",children:(0,s.t)(s.Strings.robot_run_history_old_version_tip)})});var f=p.executedNodeIds.map((function(e){return o[p.nodeByIds[e].typeId]}));return(0,n.jsxs)(i.Box,{children:[(0,n.jsx)(i.Box,{height:"1px",background:u.color.fc5,margin:"0px 16px"}),(0,n.jsx)(i.Box,{padding:"16px",children:f.map((function(e,r){var t=p.nodeByIds[p.executedNodeIds[r]],i=0===r;return(0,n.jsx)(pn,{index:r,nodeType:e,nodeDetail:t,children:i?(0,n.jsx)(yn,{nodeType:e,nodeDetail:t}):(0,n.jsx)(_n,{nodeType:e,nodeDetail:t})},r)}))})]})};!function(e){e[e.RUNNING=0]="RUNNING",e[e.SUCCESS=1]="SUCCESS",e[e.ERROR=2]="ERROR"}(vt||(vt={}));var Sn=function(e){var r,t,a,l=e.item,c=(0,i.useTheme)(),d=(0,o.useState)(!1),u=d[0],h=d[1],f=(r={},(0,oe.Z)(r,vt.RUNNING,(0,s.t)(s.Strings.robot_run_history_running)),(0,oe.Z)(r,vt.SUCCESS,(0,s.t)(s.Strings.robot_run_history_success)),(0,oe.Z)(r,vt.ERROR,(0,s.t)(s.Strings.robot_run_history_fail)),r),m=(t={},(0,oe.Z)(t,vt.RUNNING,c.color.fc0),(0,oe.Z)(t,vt.SUCCESS,c.color.fc15),(0,oe.Z)(t,vt.ERROR,c.color.fc10),t),g=(a={},(0,oe.Z)(a,vt.RUNNING,M.PauseFilled),(0,oe.Z)(a,vt.SUCCESS,M.CheckCircleFilled),(0,oe.Z)(a,vt.ERROR,M.WarnCircleFilled),a),x=l.status===vt.RUNNING,y=function(){x||h(!u)},v=g[l.status];return(0,n.jsxs)(i.Box,{marginTop:"16px",borderRadius:"8px",border:"1px solid ".concat(c.color.fc5),children:[(0,n.jsxs)(i.Box,{background:c.color.fc8,borderRadius:"8px",padding:"16px",height:"52px",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",onClick:y,style:{cursor:"pointer"},children:[(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(v,{color:m[l.status]}),(0,n.jsx)(i.Typography,{variant:"body3",color:m[l.status],style:{marginLeft:"4px"},children:f[l.status]})]}),(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.Typography,{variant:"body3",children:(0,p.bj)(l.createdAt)}),(0,n.jsx)(i.Box,{width:"16px"}),!x&&(0,n.jsx)("span",{className:ur()(un().arrowIcon,(0,oe.Z)({},un().rotated,u)),children:(0,n.jsx)(i.IconButton,{icon:M.ChevronDownOutlined,className:un().dropIcon,onClick:y})})]})]},l.taskId),u&&(0,n.jsx)(jn,{taskId:l.taskId})]})},Cn=function(){var e,r,t=(0,v.ym)().currentRobotId,o=(0,cn.ZP)((function(e){return"/robots/run-history?size=".concat(20,"&page=").concat(e+1,"&robotId=").concat(t)}),h.pD),a=o.data,l=o.error,c=o.size,d=o.setSize,u=a?a.flat():[],p=!a&&!l,f=p||c>0&&a&&"undefined"===typeof a[c-1],m=0===(null===a||void 0===a||null===(e=a[0])||void 0===e?void 0:e.length),g=m||a&&(null===(r=a[a.length-1])||void 0===r?void 0:r.length)<20,x=!g&&!f,y=(0,ar.Z)((0,ln.Z)({loading:p,hasNextPage:!g,onLoadMore:function(){return x&&d(c+1)},disabled:!!l,rootMargin:"0px 0px 32px 0px"}),2),b=y[0],_=y[1].rootRef,j=(0,i.useTheme)();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(i.Box,{padding:"16px",children:[(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.Box,{height:"12px",width:"2px",backgroundColor:j.color.fc0,marginRight:"4px"}),(0,n.jsx)(i.Typography,{variant:"body3",color:j.color.fc3,children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,s.t)(s.Strings.robot_run_history_desc)}})})]}),(l||!a)&&(0,n.jsx)(i.Skeleton,{count:3,height:"52px",type:"text",circle:!1,style:{marginBottom:16}}),(0,n.jsxs)(i.Box,{height:"calc(100vh - 150px)",ref:_,children:[u.map((function(e){return(0,n.jsx)(Sn,{item:e},e.taskId)})),m?(0,n.jsx)(i.Box,{display:"flex",justifyContent:"center",marginTop:"210px",children:(0,n.jsx)(i.Typography,{variant:"body2",color:j.color.fc2,children:(0,s.t)(s.Strings.robot_run_history_no_data)})}):(0,n.jsxs)(i.Box,{ref:b,display:"flex",alignItems:"center",justifyContent:"center",marginTop:"16px",children:[f&&(0,n.jsxs)(i.Box,{display:"flex",children:[(0,n.jsx)(i.Loading,{}),(0,n.jsx)(i.Typography,{component:"span",variant:"body4",color:j.color.fc2,children:"\u6b63\u5728\u52a0\u8f7d\u66f4\u591a\u2026"})]}),g&&(0,n.jsx)(i.Typography,{component:"span",variant:"body4",color:j.color.fc2,children:(0,s.t)(s.Strings.robot_run_history_bottom_tip)})]})]})]})})},wn=function(){var e=(0,i.useTheme)();return(0,n.jsx)("svg",{width:"7",height:"8",viewBox:"0 0 7 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M0.758154 7.54292C0.424911 7.74383 0 7.50384 0 7.11472L0 0.885052C0 0.495981 0.424815 0.255987 0.758061 0.456794L5.92592 3.57085C6.24846 3.76521 6.24851 4.23288 5.92601 4.42731L0.758154 7.54292Z",fill:e.color.fc3})})},Tn=t(961873),On=t.n(Tn),In=function(e){var r=e.index,t=e.robotCardInfo,a=e.onClick,l=e.readonly,c=t.name,d=t.nodeTypeList,u=t.robotId,h=t.isActive,f=(0,i.useTheme)(),m=l?{cursor:"not-allowed",pointerEvents:"none",opacity:.5}:{cursor:"pointer"},g={0:f.color.deepPurple,1:f.color.indigo,2:f.color.blue,3:f.color.teal,4:f.color.green,5:f.color.yellow,6:f.color.orange,7:f.color.pink,8:f.color.brown,9:f.color.purple}[Math.min(r,9)][h?500:100],x=(0,v.ym)(u).robot,y=(0,v.tm)(u),b=y.loading,_=y.toggleRobotActive;return(0,n.jsx)(i.Box,{border:"1px solid ".concat(f.color.fc5),borderLeft:"4px solid ".concat(g),borderRadius:"4px",marginTop:"16px",background:f.color.fc8,height:"68px",style:m,children:(0,n.jsxs)(i.Box,{padding:"8px 0",margin:"0 8px",onClick:a,children:[(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.Box,{width:"100%",children:(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.Avatar,{icon:(0,n.jsx)(te(),{alt:"",src:(0,s.integrateCdnHost)((0,Ut.Sy)().ROBOT_DEFAULT_AVATAR),width:24,height:24}),style:{marginRight:4,minWidth:"24px"},size:"xs"}),(0,n.jsx)(i.Typography,{variant:"h8",ellipsis:!0,children:c||(0,s.t)(s.Strings.robot_unnamed)})]})}),(0,n.jsx)(M.ChevronRightOutlined,{})]}),(0,n.jsxs)(i.Box,{display:"flex",justifyContent:"space-between",marginTop:"8px",alignItems:"center",children:[(0,n.jsx)(i.Box,{width:"100%",display:"flex",alignItems:"center",children:d.map((function(e,r){var t=r===d.length-1;return(0,n.jsxs)(o.Fragment,{children:[(0,n.jsx)("span",{className:On().nodeLogo,children:(0,n.jsx)(te(),{src:(0,s.integrateCdnHost)(e.service.logo),alt:"",width:24,height:24},"".concat(e.nodeTypeId,"_").concat(r))}),!t&&(0,n.jsx)(i.Box,{display:"flex",margin:"0 8px",children:(0,n.jsx)(wn,{})})]},r)}))}),(0,n.jsx)(i.Switch,{checked:x.isActive,size:"small",disabled:l,loading:b,onClick:function(e,r){(0,p.UW)(r),_()}})]})]})})},kn=t(331244),An=t(937712),Zn={src:"/_next/static/media/automation_empty_light.5817add3.png",height:300,width:400,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAMAAADJ2y/JAAAATlBMVEVMaXH09fp7aOD////p5fv29P/18//u6/339f+nldX18/90YOSPgeWahM/IwPHZ0PDh3fri3P/w7f3f2/bAudf39/308/++tuvQzeve3e6WqK2kAAAAFnRSTlMAkP6W/U1k/h77t7y584XtMGnEcvviRLAf7wAAAAlwSFlzAAALEwAACxMBAJqcGAAAADlJREFUCJkVykkSgCAMAMEBA0lwBRX0/x+17HMDWGgZSNMuXQ5yV3d5T4quV3StJB1PHLf9dZk34wMrbgHIzeERIgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:6},Fn={src:"/_next/static/media/automation_empty_dark.a15699ba.png",height:300,width:400,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAMAAADJ2y/JAAAAOVBMVEXm1vxwULP2+fbUyPvx6Piagth9aeDj2vZMaXHv6/Ld3eSRhOaMfuejlt61rN91YeSJbr/Cu9jRzuvwoj5aAAAAEXRSTlMFnIA7Czn+LgAXpbya7dm+v3bM8CgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAySURBVAiZBcGJAcAgDAOxAxLs0L/7D4uEbaQwhsxSEBpv0ypqtG9eHdD9z7PA9ONJewMfvQFAnyJOsgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:6},En=function(){var e=(0,i.useTheme)(),r=(0,v.Tn)(),t=r.canAddNewRobot,o=r.toggleNewRobotModal,a=(0,v.z0)(),c=(0,An.U)(),d=(0,$t.QT)(s.Api.getLabsFeatureList).data,u=(0,l.useSelector)((function(e){return e.theme}))===i.ThemeName.Light?Zn:Fn;return(0,n.jsxs)(i.Box,{display:"flex",flexDirection:"column",margin:"0 auto",marginTop:"80px",alignItems:"center",children:[(0,n.jsx)(te(),{src:u,alt:"\u6ca1\u6709\u673a\u5668\u4eba\u54e6",width:200,height:150}),(0,n.jsx)(i.Typography,{variant:"body3",color:e.color.fc1,style:{marginTop:16,width:212},children:(0,s.t)(s.Strings.robot_panel_no_robot_tip)}),(0,n.jsxs)(i.Box,{marginTop:"24px",width:"212px",children:[(0,n.jsx)(i.Button,{disabled:!t,color:"primary",onClick:function(){return a?t&&o():function(){var e=d.data.data.features.space,r=(void 0===e?[]:e).find((function(e){return e.key===s.SystemConfig.test_function.robot.feature_key}))||{},t=r.url,n="robot"===r.key&&(null===m.isWecomFunc||void 0===m.isWecomFunc?void 0:(0,m.isWecomFunc)())?p.AM:t;n&&c(n)}()},block:!0,children:a?(0,s.t)(s.Strings.robot_panel_create_tab):(0,s.t)(s.Strings.test_function_btnmodal_btntext)}),!a&&(0,n.jsx)(i.Box,{marginTop:"8px",fontSize:"12px",lineHeight:"18px",color:e.color.fc3,children:(0,s.t)(s.Strings.test_function_form_submit_tip)})]})]})},Nn=function(){var e,r,t=(0,l.useSelector)(s.Selectors.getPermissions),c=(0,l.useSelector)(s.Selectors.getActiveDatasheetId),f=t.manageable,m=(0,v.ym)(),g=m.currentRobotId,x=m.isHistory,y=m.setCurrentRobotId,b=m.updateRobotList,_="/robots?resourceId=".concat(c),j=(0,a.ZP)(_,h.CC),S=j.data,C=j.error,w=(0,v.QB)(),T=w.data,O=w.loading,I=(0,v.ov)(),k=I.data,A=I.loading,Z=(0,o.useState)([]),F=Z[0],E=Z[1],N=(0,i.useTheme)(),B=(0,v.gm)().state,D=(0,v.Tn)(),R=D.toggleNewRobotModal,P=D.canAddNewRobot,M=(0,o.useMemo)((function(){return(0,d.Z)((function(){var e,r;return(0,u.__generator)(this,(function(t){switch(t.label){case 0:return[4,s.Api.getRelateNodeByDstId(c,void 0,s.ConfigConstant.NodeType.FORM)];case 1:return e=t.sent(),r=e.data.data,E(r||[]),[2]}}))}))}),[c]);return(0,o.useEffect)((function(){b(S)}),[S,b]),(0,o.useEffect)((function(){M()}),[M]),C?null:g?x?(0,n.jsx)(Cn,{}):(0,n.jsx)(sn,{index:((null===S||void 0===S?void 0:S.length)||0)+1,datasheetId:c,formList:F}):O||A||0===T.length||0===k.length?(0,n.jsx)(i.Skeleton,{count:3,height:"68px",type:"text",circle:!1,style:{marginBottom:16}}):0===(null===(e=B.robotList)||void 0===e?void 0:e.length)?(0,n.jsx)(En,{}):(0,n.jsxs)("div",{style:{width:"100%"},children:[null===(r=B.robotList)||void 0===r?void 0:r.map((function(e,r){var t=function(e,r,t){var n={robotId:e.robotId,name:e.name,description:e.description,isActive:e.isActive,nodeTypeList:[]};return e.nodes.forEach((function(e,i){if(0===i){var o=r.find((function(r){return r.triggerTypeId===e.triggerTypeId}));o&&n.nodeTypeList.push({nodeTypeId:e.triggerTypeId,service:o.service})}else{var a=t.find((function(r){return r.actionTypeId===e.actionTypeId}));a&&n.nodeTypeList.push({nodeTypeId:e.actionTypeId,service:a.service})}})),n}(e,T,k);return(0,n.jsx)(In,{index:r,robotCardInfo:t,onClick:function(){y(e.robotId)},readonly:!f},e.robotId)})),!g&&(0,n.jsx)(i.Box,{border:"1px solid ".concat(N.color.fc5),height:84,display:"flex",alignItems:"center",justifyContent:"center",marginTop:16,onClick:function(){P&&R()},backgroundColor:"".concat(N.color.fc8),style:{cursor:P?"pointer":"not-allowed"},children:(0,n.jsx)(i.Box,{display:"flex",alignItems:"center",justifyContent:"center",onClick:p.UW,children:(0,n.jsx)(kn.V0,{})})})]})},Bn=t(128680),Dn="RobotDetailMoreAction",Rn=function(){var e=(0,l.useSelector)(s.Selectors.getActiveDatasheetId),r=(0,v.ym)(),t=r.currentRobotId,o=r.setCurrentRobotId,a=r.setIsHistory,c=r.setIsEditingRobotName,f=r.setIsEditingRobotDesc,m=(0,i.useContextMenu)({id:Dn}).show,g=[[{text:(0,s.t)(s.Strings.robot_rename),icon:(0,n.jsx)(M.EditOutlined,{}),onClick:function(){c(!0)}},{text:(0,s.t)(s.Strings.robot_edit_desc),icon:(0,n.jsx)(M.InfoCircleOutlined,{}),onClick:function(){f(!0)}}],[{text:(0,s.t)(s.Strings.robot_delete),icon:(0,n.jsx)(M.DeleteOutlined,{}),onClick:function(){t&&Bn.Modal.confirm({title:(0,s.t)(s.Strings.robot_delete),content:(0,s.t)(s.Strings.robot_delete_confirm_desc),cancelText:(0,s.t)(s.Strings.cancel),okText:(0,s.t)(s.Strings.confirm),onOk:(0,d.Z)((function(){return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,h.gf)(t)];case 1:return r.sent()&&((0,h._z)(e),C.v0.success({content:(0,s.t)(s.Strings.delete_succeed)}),o()),[2]}}))})),onCancel:function(){},type:"danger"})}}]];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.TextButton,{size:"small",onClick:function(){o()},style:{position:"absolute",left:8,paddingLeft:8,paddingRight:8},prefixIcon:(0,n.jsx)(M.ChevronLeftOutlined,{}),children:(0,n.jsx)("span",{style:{lineHeight:1},children:(0,s.t)(s.Strings.robot_return)})}),(0,n.jsxs)(i.Box,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.Typography,{variant:"h6",children:(0,s.t)(s.Strings.robot_config_panel_title)}),(0,n.jsx)(i.Tooltip,{content:(0,s.t)(s.Strings.robot_config_panel_help_tooltip),placement:"top-center",children:(0,n.jsx)(i.Box,{display:"flex",alignItems:"center",children:(0,n.jsx)(i.IconButton,{shape:"square",icon:M.QuestionCircleOutlined,onClick:function(){window.open((0,s.t)(s.Strings.robot_config_help_url))}})})})]}),(0,n.jsxs)(i.Box,{display:"flex",width:"48px",justifyContent:"space-between",marginRight:"16px",position:"absolute",right:"16px",children:[(0,n.jsx)(i.Tooltip,{content:(0,s.t)(s.Strings.robot_run_history_tooltip),placement:"top-center",children:(0,n.jsx)(i.Box,{display:"flex",alignItems:"center",children:(0,n.jsx)(i.IconButton,{shape:"square",icon:M.HistoryOutlined,onClick:function(){return a(!0)}})})}),(0,n.jsx)("div",{style:{padding:8}}),(0,n.jsx)(i.Tooltip,{content:(0,s.t)(s.Strings.robot_more_operations_tooltip),placement:"top-center",children:(0,n.jsx)(i.Box,{display:"flex",alignItems:"center",children:(0,n.jsx)(i.IconButton,{shape:"square",onClick:function(e){return m(e)},icon:M.MoreStandOutlined})})})]}),(0,n.jsx)(i.ContextMenu,{menuId:Dn,overlay:(0,p.Dg)(g,!0)})]})},Pn=function(){var e=(0,v.ym)().setIsHistory;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.TextButton,{size:"small",prefixIcon:(0,n.jsx)(M.ChevronLeftOutlined,{}),style:{position:"absolute",left:8,paddingLeft:8,paddingRight:8},onClick:function(){e(!1)},children:(0,n.jsx)("span",{style:{lineHeight:1},children:(0,s.t)(s.Strings.robot_return)})}),(0,n.jsx)(i.Typography,{variant:"h6",children:(0,s.t)(s.Strings.robot_run_history_title)}),(0,n.jsx)(i.Box,{display:"flex",width:"48px",justifyContent:"space-between",position:"absolute",right:"16px"})]})},Mn=function(){var e=(0,v.gm)().state;return e.currentRobotId?e.isHistory?(0,n.jsx)(Pn,{}):(0,n.jsx)(Rn,{}):(0,n.jsx)(kn.x4,{})},Ln=function(e){var r=(0,o.useState)(""),t=r[0],a=r[1],c=(0,o.useState)(!1),p=c[0],h=c[1],f=e.robotId,m=e.setRobotId,g=(0,l.useSelector)(s.Selectors.getActiveDatasheetId),x=(0,v.ym)().createRobot,y=function(){var r=(0,d.Z)((function(){var r;return(0,u.__generator)(this,(function(n){switch(n.label){case 0:return h(!0),f?[3,2]:[4,x({resourceId:g,name:t})];case 1:return r=n.sent(),m(r),[3,2];case 2:return h(!1),e.goNextStep(),[2]}}))}));return function(){return r.apply(this,arguments)}}();return(0,n.jsxs)(i.Box,{width:"336px",margin:"24px 0px 118px 0px",children:[(0,n.jsxs)(i.Box,{display:"flex",flexDirection:"column",alignItems:"center",height:"110px",justifyContent:"space-between",margin:"0px 0px 24px 0px",children:[(0,n.jsx)(i.Avatar,{icon:(0,n.jsx)("img",{src:(0,s.integrateCdnHost)((0,Ut.Sy)().CREATE_ROBOT_AVATAR),width:64,height:64,alt:"robot"}),size:"l",style:{background:"none"}}),(0,n.jsx)(i.Typography,{children:(0,s.t)(s.Strings.robot_create_wizard_step_1_desc)})]}),(0,n.jsxs)(i.Box,{height:"120px",width:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",children:[(0,n.jsx)(i.TextInput,{placeholder:(0,s.t)(s.Strings.robot_create_name_placeholder),value:t,onChange:function(e){return a(e.target.value)},autoFocus:!0,block:!0}),(0,n.jsx)(i.Button,{block:!0,disabled:p||0===t.trim().length,loading:p,color:"primary",onClick:y,children:(0,s.t)(s.Strings.robot_create_wizard_next)})]})]})},Wn=function(e){var r=(0,i.useTheme)(),t=e.robotId,l=e.isActive,c=(0,v.QB)(),p=c.data,f=c.loading,m=(0,o.useState)(!1),x=m[0],y=m[1],b=(0,o.useState)(""),_=b[0],j=b[1],S=(0,v.eN)(),C=(0,v.ym)(t).updateRobot,w=(0,o.useCallback)(function(){var e=(0,d.Z)((function(e){var r,n,i;return(0,u.__generator)(this,(function(o){switch(o.label){case 0:return r=p.find((function(r){return r.triggerTypeId===e})),n="record_created"===(null===r||void 0===r?void 0:r.endpoint)?S:void 0,[4,(0,h.$y)(t,e,n)];case 1:return o.sent(),(0,a.JG)("/robots/".concat(t,"/trigger")),[4,(0,h.GN)(t)];case 2:return i=o.sent(),C(i),[2]}}))}));return function(r){return e.apply(this,arguments)}}(),[t,S,p,C]),T=function(){var r=(0,d.Z)((function(){return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return _?(y(!0),[4,w(_)]):[3,2];case 1:r.sent(),y(!1),r.label=2;case 2:return e.goNextStep(),[2]}}))}));return function(){return r.apply(this,arguments)}}();if(!p)return null;var O=g(p);return(0,n.jsxs)(i.Box,{width:"336px",margin:"24px 0px 118px 0px",children:[(0,n.jsx)(i.Box,{display:"flex",height:"40px",margin:"0px 0px 40px 0px",children:(0,n.jsx)(i.Tooltip,{content:(0,s.t)(s.Strings.robot_create_wizard_step_2_desc),color:r.color.textStaticPrimary,visible:e.isActive,style:{backgroundColor:r.color.primaryColor,zIndex:1e3},placement:"right-center",children:(0,n.jsx)("span",{children:(0,n.jsx)(i.Avatar,{icon:(0,n.jsx)("img",{src:(0,s.integrateCdnHost)((0,Ut.Sy)().CREATE_ROBOT_AVATAR),width:64,height:64,alt:"robot"}),size:"l",style:{background:"none"}})})})}),(0,n.jsxs)(i.Box,{height:"120px",width:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",children:[!f&&l&&(0,n.jsx)(i.Select,{placeholder:(0,s.t)(s.Strings.robot_select_option),options:O,value:_,onSelected:function(e){var r=e.value;r&&j(r)},defaultVisible:!0}),(0,n.jsx)(i.Button,{block:!0,loading:x,disabled:x||!_,color:"primary",onClick:T,style:{marginTop:40},children:(0,s.t)(s.Strings.robot_create_wizard_next)})]})]})},Vn=function(e){var r=e.robotId,t=e.isActive,c=(0,v.ov)(),p=c.data,f=c.loading,m=(0,v.ym)(r).updateRobot,x=(0,o.useState)(!1),b=x[0],_=x[1],j=(0,o.useState)(""),S=j[0],C=j[1],w=(0,i.useTheme)(),T=(0,l.useSelector)(s.Selectors.getActiveDatasheetId),O=(0,o.useCallback)(function(){var e=(0,d.Z)((function(e){var t,n;return(0,u.__generator)(this,(function(i){switch(i.label){case 0:return[4,(0,h.PH)({robotId:r,actionTypeId:e})];case 1:return t=i.sent(),[4,(0,a.JG)("/robots/".concat(r,"/action"))];case 2:return i.sent(),[4,(0,h.GN)(r)];case 3:return n=i.sent(),m(n),(0,h._z)(T),[2,t.data]}}))}));return function(r){return e.apply(this,arguments)}}(),[r,m,T]);if(!p)return null;var I=function(){var r=(0,d.Z)((function(){return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return _(!0),[4,O(S)];case 1:return r.sent(),_(!1),e.goNextStep(),[2]}}))}));return function(){return r.apply(this,arguments)}}(),k=g(y(p));return(0,n.jsxs)(i.Box,{width:"336px",margin:"24px 0px 118px 0px",children:[(0,n.jsx)(i.Box,{display:"flex",height:"40px",margin:"0px 0px 40px 0px",children:(0,n.jsx)(i.Tooltip,{content:(0,s.t)(s.Strings.robot_create_wizard_step_3_desc),color:w.color.textStaticPrimary,visible:t,style:{backgroundColor:w.color.primaryColor,zIndex:1e3},placement:"right-center",children:(0,n.jsx)("span",{children:(0,n.jsx)(i.Avatar,{icon:(0,n.jsx)("img",{src:(0,s.integrateCdnHost)((0,Ut.Sy)().CREATE_ROBOT_AVATAR),width:64,height:64,alt:"robot"}),size:"l"})})})}),(0,n.jsxs)(i.Box,{height:"120px",width:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",children:[!f&&t&&(0,n.jsx)(i.Select,{options:k,value:S,onSelected:function(e){var r=e.value;r&&C(r)},placeholder:(0,s.t)(s.Strings.robot_select_option),defaultVisible:!0}),(0,n.jsx)(i.Button,{block:!0,loading:b,disabled:b||!S,color:"primary",onClick:I,style:{marginTop:40},children:(0,s.t)(s.Strings.robot_create_wizard_next)})]})]})},Un=function(e){var r=(0,v.ym)().setCurrentRobotId,t=(0,v.gm)().dispatch;return(0,n.jsxs)(i.Box,{width:"336px",margin:"24px 0px 118px 0px",children:[(0,n.jsxs)(i.Box,{display:"flex",flexDirection:"column",alignItems:"center",height:"110px",justifyContent:"space-between",margin:"0px 0px 24px 0px",children:[(0,n.jsx)(i.Avatar,{icon:(0,n.jsx)("img",{src:(0,s.integrateCdnHost)((0,Ut.Sy)().CREATE_ROBOT_AVATAR),width:64,height:64,alt:"robot"}),size:"l"}),(0,n.jsx)(i.Typography,{children:(0,s.t)(s.Strings.robot_create_wizard_step_4_desc)})]}),(0,n.jsx)(i.Box,{height:"120px",width:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",children:(0,n.jsx)(i.Button,{block:!0,color:"primary",onClick:function(){r(e.robotId),t({type:"toggleNewRobotModal"})},children:(0,s.t)(s.Strings.robot_create_wizard_step_4_button)})})]})},qn=function(){var e=(0,o.useState)(0),r=e[0],t=e[1],a=(0,o.useState)(),l=a[0],c=a[1],d=[{title:(0,s.t)(s.Strings.robot_create_wizard_step_1)},{title:(0,s.t)(s.Strings.robot_create_wizard_step_2)},{title:(0,s.t)(s.Strings.robot_create_wizard_step_3)},{title:(0,s.t)(s.Strings.robot_create_wizard_step_4)}],u=function(){r<d.length-1&&t(r+1)},p=[Ln,Wn,Vn,Un];return(0,n.jsxs)(i.Box,{width:"100%",padding:"24px",display:"flex",alignItems:"center",flexDirection:"column",height:"520px",children:[(0,n.jsx)(i.Box,{marginTop:"60px",children:(0,n.jsx)(C.Rg,{current:r,steps:d,onChange:t})}),p.map((function(e,t){var o=t===r;return(0,n.jsx)(i.Box,{display:o?"block":"none",children:(0,n.jsx)(e,{goNextStep:u,isActive:o,robotId:l,setRobotId:c})},t)}))]})},Jn=function(){var e=(0,v.gm)(),r=e.state,t=e.dispatch;return(0,n.jsx)("div",{children:(0,n.jsx)(i.ModalPro,{width:800,visible:r.isNewRobotModalOpen,onCancel:function(){r.isNewRobotModalOpen&&t({type:"toggleNewRobotModal"})},destroyOnClose:!0,children:(0,n.jsx)(qn,{})})})},$n=function(){var e=(0,l.useSelector)(s.Selectors.getTheme),r=(0,i.useTheme)();return(0,n.jsx)(c.x,{children:(0,n.jsx)(i.ThemeProvider,{theme:e,children:(0,n.jsxs)(a.J$,{value:{revalidateOnFocus:!1},children:[(0,n.jsx)(Jn,{}),(0,n.jsx)(i.Box,{height:"50px",display:"flex",justifyContent:"center",alignItems:"center",padding:"16px",borderBottom:"1px solid ".concat(r.color.lineColor),position:"relative",backgroundColor:r.color.bgCommonDefault,children:(0,n.jsx)(Mn,{})}),(0,n.jsx)(i.Box,{overflow:"auto",padding:"16px",backgroundColor:r.color.fc8,height:"calc(100vh - 49px)",children:(0,n.jsx)(Nn,{})})]})})})},Hn=(0,o.memo)($n)},563919:function(e){e.exports={magicVariableBox:"styles_magicVariableBox__Sl8VO",add:"styles_add__oREyB",magicVariable:"styles_magicVariable__gDrPz",editor:"styles_editor__Or7bc"}},95255:function(e){e.exports={antiEllipsis:"style_antiEllipsis__6OocJ",noSelect:"style_noSelect__aBqxv",antSelectOptionCommon:"style_ant-select-option-common__9Aspv",flexCenter:"style_flexCenter__YDNJH",inputErrorMsg:"style_inputErrorMsg__qQ5zC",tree:"style_tree__OsJUU",lightTree:"style_lightTree__MtdJ1",darkTree:"style_darkTree__5FM_w",description:"style_description__QRotA"}},874664:function(e){e.exports={h:"style_h__VqRgk",hasCollapse:"style_hasCollapse__8k1_e",h1:"style_h1__3g0bN",h2:"style_h2__q596B",h3:"style_h3__gPpIe",suffixIcon:"style_suffixIcon__OJPDx",isIconRotate:"style_isIconRotate__4bsB1",dropIcon:"style_dropIcon__fMMAA",helpIcon:"style_helpIcon___JYNx"}},447877:function(e){e.exports={objectFieldTemplateWrapper:"style_objectFieldTemplateWrapper__xZQIY",inlineObjectChildren:"style_inlineObjectChildren__Khw2W",inline:"style_inline__NMbiY",inlineArrayItem:"style_inlineArrayItem__LIOum"}},873999:function(e){e.exports={helperText:"style_helperText__OKwbP",error:"style_error__bnqFY"}},471391:function(e){e.exports={antiEllipsis:"style_antiEllipsis__yAX5y",noSelect:"style_noSelect__kH6gS",antSelectOptionCommon:"style_ant-select-option-common__h4VFd",flexCenter:"style_flexCenter__GthmJ",inputErrorMsg:"style_inputErrorMsg__o_zgG",tree:"style_tree__zwZTH",lightTree:"style_lightTree__BoFX_",darkTree:"style_darkTree__iuCYo",historyDetailList:"style_historyDetailList__b_a4i",arrowIcon:"style_arrowIcon__PKYYQ",rotated:"style_rotated__dX7JE",dropIcon:"style_dropIcon__ZGRXQ"}},14745:function(e){e.exports={groupWrapper:"styles_groupWrapper__ICv79",groupWrapperWithAdd:"styles_groupWrapperWithAdd__DO_qU",addFilterWrapper:"styles_addFilterWrapper__AV5IK",addFilterSelectTrigger:"styles_addFilterSelectTrigger__Qp2zE"}},961873:function(e){e.exports={nodeLogo:"styles_nodeLogo__KYuOO"}},759209:function(e){e.exports={antiEllipsis:"style_antiEllipsis__qKWPK",noSelect:"style_noSelect__EoybF",antSelectOptionCommon:"style_ant-select-option-common__TcTNe",flexCenter:"style_flexCenter__OYzff",inputErrorMsg:"style_inputErrorMsg__sOZ_T",tree:"style_tree___29Cr",lightTree:"style_lightTree__aFS4r",darkTree:"style_darkTree__x0dkf",dataspace:"style_dataspace__ixpXP",pane2:"style_Pane2___lHhj",splitRight:"style_splitRight__OhOPL",splitLeft:"style_splitLeft__yvO6L",menuWrap:"style_menuWrap__BVy3v",animationOpen:"style_animationOpen__2AxDr",animationClose:"style_animationClose___hQPD",wrapper:"style_wrapper__ZkBz2",closeBtn:"style_closeBtn__Z6C3F",isPanelClose:"style_isPanelClose__m9Zsd",nickNameWrapper:"style_nickNameWrapper___u8Xf",nickNameImg:"style_nickNameImg__brq_N",err:"style_err__UiT_A",tip:"style_tip__Y5lrT",nickName:"style_nickName__MtH4c",submit:"style_submit__p0vB9"}}}]);