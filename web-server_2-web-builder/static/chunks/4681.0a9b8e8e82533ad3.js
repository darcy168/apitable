(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4681],{304262:function(e,t,n){"use strict";n.d(t,{i:function(){return m}});var i=n(347842),a=n(552322),s=(n(202784),n(323440)),r=n(72779),l=n.n(r),o=n(34577),c=n.n(o),m=function(e){var t,n=e.type,r=e.className,o=e.style,m=l()(c().memberTag,(t={},(0,i.Z)(t,c().primaryTag,"mainAdmin"===n),(0,i.Z)(t,c().subTag,"subAdmin"===n),(0,i.Z)(t,c().inactiveTag,"inactive"===n),t),r);return(0,a.jsx)("span",{className:m,style:o,children:function(){switch(n){case"mainAdmin":return(0,s.t)(s.Strings.primary_admin);case"subAdmin":return(0,s.t)(s.Strings.admin);case"inactive":return(0,s.t)(s.Strings.added_not_yet);default:return""}}()})}},834681:function(e,t,n){"use strict";n.r(t),n.d(t,{SpaceMemberManage:function(){return Se},default:function(){return ge}});var i=n(552322),a=n(202784),s=n(323440),r=n(347842),l=n(470865),o=n(351253),c=n(165846),m=n(5693),d=n(35126),u=n(223258),_=n(651971),p=n(864453),f=n(736367),S=n(178234),g=n(477361),I=n(829051),b=n(798788),h=n(745680),v=n(914463),T=function(){var e=(0,b.Z)((function(e,t,n){var i,a,r,l,o;return(0,h.__generator)(this,(function(e){switch(e.label){case 0:return i=!1,[4,s.Api.getSubTeams(t)];case 1:return a=e.sent(),r=a.data,l=r.success,o=r.data,l&&o.length&&o.find((function(e){return e.teamName===n}))&&(i=!0),[2,i]}}))}));return function(t,n,i){return e.apply(this,arguments)}}(),x=function(e,t){return e.isPrimary||e.memberId===t},C=function(e,t){v.socialPlatPreOperate?(0,v.socialPlatPreOperate)(t,e):e()},y=function(e){var t=(0,a.useState)(""),n=t[0],r=t[1],l=(0,a.useState)(""),o=l[0],c=l[1],m=(0,I.useSelector)((function(e){return{spaceId:e.space.activeId||"",user:e.user.info,rightClickTeamInfoInSpace:e.spaceMemberManage.rightClickTeamInfoInSpace}}),I.shallowEqual),d=m.spaceId,_=m.user,f=m.rightClickTeamInfoInSpace,S=f.teamId?f.teamId:s.ConfigConstant.ROOT_TEAM_ID,g=(0,p.VT)(n,d,S,_).createTeam;return(0,i.jsx)(u.oM,{title:(0,s.t)(s.Strings.add_team),subTitle:"".concat((0,s.t)(s.Strings.superior_team),"\uff1a").concat(f.teamTitle),onCancel:function(){e.setModalVisible(!1)},onOk:function(){n.length>s.MAX_NAME_STRING_LENGTH?c((0,s.t)(s.Strings.team_length_err)):T(d,S,n).then((function(t){t&&c((0,s.t)(s.Strings.team_is_exist_err)),!t&&g().then((function(){e.setModalVisible(!1)}))}))},okButtonProps:{disabled:!n},maskClosable:!0,children:(0,i.jsx)(u.ge,{placeholder:(0,s.t)(s.Strings.placeholder_input_team_name),onChange:function(e){return r(e.target.value)},value:n,error:Boolean(o),helperText:o,block:!0})})},M=function(e){var t=(0,f.T)(),n=(0,a.useState)(""),r=n[0],l=n[1],o=(0,I.useSelector)((function(e){return{spaceId:e.space.activeId||"",rightClickTeamInfoInSpace:e.spaceMemberManage.rightClickTeamInfoInSpace,user:e.user.info}}),I.shallowEqual),c=o.spaceId,m=o.rightClickTeamInfoInSpace,d=o.user,_=(0,a.useState)(m.teamTitle),p=_[0],S=_[1];return(0,i.jsx)(u.oM,{title:(0,s.t)(s.Strings.rename_team),onCancel:function(){e.setModalVisible(!1)},onOk:function(){if(p.length>s.MAX_NAME_STRING_LENGTH)l((0,s.t)(s.Strings.team_length_err));else{var n=m.teamId,i=m.parentId,a=i||s.ConfigConstant.ROOT_TEAM_ID;T(c,a,p).then((function(i){i?l((0,s.t)(s.Strings.team_is_exist_err)):s.Api.updateTeamInfo(n,a,p).then((function(n){n.data.success?(d&&t(s.StoreActions.getTeamListDataInSpace(c,d)),e.setModalVisible(!1),u.v0.success({content:(0,s.t)(s.Strings.rename_team_success)})):u.v0.error({content:(0,s.t)(s.Strings.rename_team_fail)})}))}))}},okButtonProps:{disabled:!p||p===m.teamTitle},maskClosable:!0,children:(0,i.jsx)(u.ge,{value:p,onChange:function(e){return S(e.target.value)},error:Boolean(r),helperText:r,block:!0})})},j=n(996670),k=n(387394),N=n(647917),E=n(528055),O=n(128680),A=n(585421),R=n(850930),L=n(712765),D=function(e){var t=e.onCancel,n=e.inEditMember,a=e.setTeamList,s=e.teamList,r=(0,I.useSelector)((function(e){return{selectedTeamInfoInSpace:e.spaceMemberManage.selectedTeamInfoInSpace,selectMemberListInSpace:e.spaceMemberManage.selectMemberListInSpace}}),I.shallowEqual),l=r.selectedTeamInfoInSpace,o=r.selectMemberListInSpace,c=(0,p.ee)().changeMemberTeam,m=n?null===s||void 0===s?void 0:s.map((function(e){return e.teamId})):[];return(0,i.jsx)(L.Gh,{source:L.AU.ChangeMemberTeam,onCancel:t,onSubmit:function(e){if(n&&a&&s){var t=(0,R.Z)(s),i=s.map((function(e){return e.teamId}));e.forEach((function(e){i.includes(e.teamId)||t.push({teamId:e.teamId,teamName:e.originName||e.teamName})})),a(t)}if(!n&&l&&e.length>0){var r=e.map((function(e){return e.teamId}));c(l?l.teamId:"",o,r)}},disableIdList:m})},W=n(554037),w=n.n(W),B=function(e){var t=e.cancelModalVisible,n=e.pageNo,m=e.removeCallback,d=(0,I.useSelector)((function(e){return{spaceId:e.space.activeId||"",teamId:e.spaceMemberManage.selectedTeamInfoInSpace?e.spaceMemberManage.selectedTeamInfoInSpace.teamId:s.ConfigConstant.ROOT_TEAM_ID,memberInfoInSpace:e.spaceMemberManage.memberInfoInSpace,selectMemberListInSpace:e.spaceMemberManage.selectMemberListInSpace,selectedTeamInfoInSpace:e.spaceMemberManage.selectedTeamInfoInSpace,userInfo:e.user.info,spaceInfo:e.space.curSpaceInfo}}),I.shallowEqual),_=d.spaceId,f=d.teamId,S=d.memberInfoInSpace,g=d.selectedTeamInfoInSpace,b=d.userInfo,h=d.selectMemberListInSpace,T=d.spaceInfo,C=(0,p.ee)().removeMember,y=(0,I.useDispatch)(),M=(0,A.Sy)(),R=(0,a.useState)({memberName:"",nickName:"",mobile:"",email:""}),L=R[0],W=R[1],B=(0,a.useState)({memberName:"",nickName:"",mobile:"",email:""}),P=B[0],F=B[1],Z=S.memberName,z=S.email,G=S.memberId,V=S.avatar,q=S.teamData,H=S.nickName,K=S.mobile,J=S.isMemberNameModified,U=S.isNickNameModified,Q=S.avatarColor,X=(0,a.useState)(),Y=X[0],$=X[1],ee=(0,a.useState)([]),te=ee[0],ne=ee[1],ie=(0,a.useState)(!1),ae=ie[0],se=ie[1],re=(0,k.Z)((0,p.OF)(Y,_,f,n,t),1)[0];(0,a.useEffect)((function(){W({memberName:Z||"",nickName:H||"",mobile:K||"",email:z||""})}),[Z,H,K,z]),(0,a.useEffect)((function(){if(q&&q.length){var e=q.map((function(e){return{teamId:e.teamId,teamName:e.fullHierarchyTeamName||""}}));ne(e)}else ne([])}),[q]);var le=(0,a.useState)(!1),oe=le[0],ce=le[1],me=null===v.isSocialWecom||void 0===v.isSocialWecom?void 0:(0,v.isSocialWecom)(T),de=me&&!oe&&!J&&L.memberName===Z,ue=me&&!U;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(O.Modal,{title:(0,i.jsx)("div",{children:(0,s.t)(s.Strings.edit_member)}),visible:!0,className:w().adjustMemberModal,onOk:function(){if(!(P.memberName||P.nickName||P.email)){var e={spaceId:_,memberId:G,teamIds:te.map((function(e){return e.teamId})),memberName:L.memberName};$(e),re(!0)}},onCancel:function(){t()},cancelText:(0,s.t)(s.Strings.cancel),okText:(0,s.t)(s.Strings.save),maskClosable:!0,cancelButtonProps:{size:"small",className:"subText"},okButtonProps:{size:"small"},centered:!0,width:400,children:[(0,i.jsx)("div",{className:w().portrait,children:(0,i.jsx)(N.qE,{src:V,title:H||Z||"",avatarColor:Q,size:80,id:G})}),(0,i.jsxs)("div",{className:w().item,children:[(0,i.jsx)("label",{className:w().label,children:(0,s.t)(s.Strings.nickname_in_space)}),(0,i.jsxs)("div",{className:w().content,children:[de&&(0,i.jsx)("div",{className:w().wecomLayer,children:(0,i.jsx)(v.WecomOpenData,{openId:L.memberName})}),(0,i.jsx)(o.TextInput,{style:{color:de?"transparent":o.colorVars.fc1},value:L.memberName,onChange:function(e){!function(e,t){P[t]&&F((0,j.Z)((0,l.Z)({},P),(0,r.Z)({},t,""))),W((0,j.Z)((0,l.Z)({},L),(0,r.Z)({},t,e.target.value.trim())))}(e,"memberName")},onBlur:function(){ce(!1),L.memberName.length>s.ConfigConstant.MEMBER_NAME_LENGTH&&F((0,j.Z)((0,l.Z)({},P),{memberName:(0,s.t)(s.Strings.member_err)}))},onClick:function(){return ce(!0)},disabled:(0,s.isIdassPrivateDeployment)(),block:!0})]}),(0,i.jsx)("div",{className:w().err,children:P.memberName})]}),(0,i.jsxs)("div",{className:w().item,children:[(0,i.jsx)("label",{className:w().label,children:(0,s.t)(s.Strings.personal_nickname)}),(0,i.jsxs)("div",{className:w().content,children:[ue&&(0,i.jsx)("div",{className:w().wecomLayer,style:{color:o.colorVars.black[500]},children:(0,i.jsx)(v.WecomOpenData,{openId:L.nickName})}),(0,i.jsx)(o.TextInput,{style:{color:ue?"transparent":o.colorVars.black[500],WebkitTextFillColor:ue?"transparent":o.colorVars.black[500]},type:"text",value:L.nickName,disabled:!0,block:!0})]}),(0,i.jsx)("div",{className:w().err,children:P.nickName})]}),(0,i.jsxs)("div",{className:w().item,children:[(0,i.jsx)("label",{className:w().label,children:(0,s.t)(s.Strings.team)}),(0,i.jsxs)("div",{className:w().deptItem,children:[function(){if(g)return(0===te.length?[{teamId:s.ConfigConstant.ROOT_TEAM_ID,teamName:b.spaceName}]:te).map((function(e){return(0,i.jsxs)("span",{className:w().teamWrapper,children:[(0,i.jsx)(u.u,{title:e.teamName,textEllipsis:!0,showTipAnyway:!0,children:(0,i.jsx)("span",{className:w().teamText,children:e.teamName})}),te.length>0&&!(null===v.isSocialFeiShu||void 0===v.isSocialFeiShu?void 0:(0,v.isSocialFeiShu)(T))&&(0,i.jsx)("span",{className:w().teamRemoveIcon,onClick:function(){return function(e){var t=te.filter((function(t){return t.teamId!==e}));ne(t)}(e.teamId)},children:(0,i.jsx)(c.CloseCircleOutlined,{})})]},e.teamId)}))}(),!(null===v.isSocialFeiShu||void 0===v.isSocialFeiShu?void 0:(0,v.isSocialFeiShu)(T))&&(0,i.jsx)(o.Button,{onClick:function(){se(!0)},size:"small",className:w().addBtn,prefixIcon:(0,i.jsx)(c.AddOutlined,{color:"currentColor"}),children:(0,s.t)(s.Strings.add)})]})]}),M.USER_BIND_PHONE_VISIBLE&&(0,i.jsxs)("div",{className:w().item,children:[(0,i.jsx)("label",{className:w().label,children:(0,s.t)(s.Strings.phone_number)}),(0,i.jsx)(o.TextInput,{value:L.mobile,disabled:!0,block:!0}),(0,i.jsx)("div",{className:w().err,children:P.mobile})]}),(0,i.jsxs)("div",{className:w().item,children:[(0,i.jsx)("label",{className:w().label,children:(0,s.t)(s.Strings.mail)}),(0,i.jsx)(o.TextInput,{value:L.email,disabled:!0,block:!0}),(0,i.jsx)("div",{className:w().err,children:P.email})]}),!(null===v.isSocialDingTalk||void 0===v.isSocialDingTalk?void 0:(0,v.isSocialDingTalk)(T))&&!(null===v.isSocialWecom||void 0===v.isSocialWecom?void 0:(0,v.isSocialWecom)(T))&&!(null===v.isSocialFeiShu||void 0===v.isSocialFeiShu?void 0:(0,v.isSocialFeiShu)(T))&&(0,i.jsx)(o.TextButton,{color:"danger",onClick:function(){b&&x(S,b.memberId)?E.v.error({content:(0,s.t)(s.Strings.warning_can_not_remove_yourself_or_primary_admin)}):O.Modal.confirm({title:(0,s.t)(s.Strings.kindly_reminder),content:(0,s.t)(s.Strings.remove_from_space_confirm_tip),onOk:function(){C({teamId:g.teamId,memberIdArr:[G],isDeepDel:!0,resFunc:function(){var e=h.filter((function(e){return e!==G}));m&&m(),y(s.StoreActions.updateSelectMemberListInSpace(e)),t()}})},type:"danger"})},size:"small",style:{position:"absolute",bottom:"24px",left:"24px"},children:(0,s.t)(s.Strings.remove_from_space)})]}),ae&&(0,i.jsx)(D,{onCancel:function(){return se(!1)},inEditMember:!0,setTeamList:ne,teamList:te})]})},P=function(e){var t=e.onCancel,n=(0,I.useSelector)((function(e){return{selectedTeamInfoInSpace:e.spaceMemberManage.selectedTeamInfoInSpace,spaceId:e.space.activeId||""}}),I.shallowEqual),r=n.selectedTeamInfoInSpace,l=n.spaceId,o=(0,p.ee)().teamAddMember,c=(0,a.useState)([]),m=c[0],d=c[1];(0,a.useEffect)((function(){r&&s.Api.getTeamAndMemberWithoutSub(r.teamId).then((function(e){var t=e.data,n=t.success,i=t.data,a=[r.teamId];n&&i.length&&i.forEach((function(e){a.push(e.memberId)})),d(a)}))}),[r,l]);return(0,i.jsx)(L.Gh,{source:L.AU.TeamAddMember,disableIdList:m,onCancel:t,onSubmit:function(e){var t=[];e.forEach((function(e){var n="teamId"in e;(n||"memberId"in e)&&t.push({id:n?e.teamId:e.memberId,type:n?1:2})}));var n=null===r||void 0===r?void 0:r.teamId;o(n||"",t)},maskClosable:!0})},F=n(495823),Z=n.n(F),z=g.xV,G=g.sN,V=g.W4,q=d.Z.TreeNode,H=d.Z.DirectoryTree,K="TEAM_OPERATE",J="TEAM_ROOT_OPERATE",U=function(e){var t=(0,f.T)(),n=(0,I.useSelector)((function(e){return{teamListInSpace:e.addressList.teamList,spaceId:e.space.activeId||"",spaceResource:e.spacePermissionManage.spaceResource,user:e.user.info,spaceInfo:e.space.curSpaceInfo}}),I.shallowEqual),d=n.teamListInSpace,g=n.spaceId,b=n.spaceResource,h=n.user,T=n.spaceInfo,x=(0,a.useState)(!1),j=x[0],k=x[1],N=(0,a.useState)(!1),E=N[0],O=N[1],A=T&&(null===v.isSocialPlatformEnabled||void 0===v.isSocialPlatformEnabled?void 0:(0,v.isSocialPlatformEnabled)(T,s.ConfigConstant.SocialType.DINGTALK))&&!(null===v.isSocialDingTalk||void 0===v.isSocialDingTalk?void 0:(0,v.isSocialDingTalk)(T)),R=T&&(null===v.isSocialPlatformEnabled||void 0===v.isSocialPlatformEnabled?void 0:(0,v.isSocialPlatformEnabled)(T,s.ConfigConstant.SocialType.WECOM))&&!(null===v.isSocialWecom||void 0===v.isSocialWecom?void 0:(0,v.isSocialWecom)(T)),L=(0,a.useState)(!1),D=L[0],W=L[1],w=(0,a.useState)(!1),B=w[0],P=w[1],F=(0,a.useState)(!1),U=F[0],Q=F[1],X=(0,a.useState)(s.ConfigConstant.ROOT_TEAM_ID),Y=X[0],$=X[1],ee=(0,p.C2)(),te=ee.loading,ne=ee.changeSelectTeam;(0,m.Z)((function(){t(s.StoreActions.getTeamListData(h)),t(s.StoreActions.getTeamInfo(g,s.ConfigConstant.ROOT_TEAM_ID)),t(s.StoreActions.getMemberListDataInSpace(1,s.ConfigConstant.ROOT_TEAM_ID))}));var ie=(0,a.useCallback)((function(e){$(e),ne(e)}),[ne]);(0,a.useEffect)((function(){b&&!(0,s.isIdassPrivateDeployment)()&&(b.mainAdmin||b.permissions.includes(s.ConfigConstant.PermissionCode.TEAM))&&Q(!0)}),[b]),(0,a.useEffect)((function(){e.setRightLoading(te)}),[te,e]);var ae=function(e){return e&&0!==e.length?e.map((function(e){var t=a.createRef();return(0,i.jsx)(q,{title:(0,i.jsxs)(V,{id:e.teamId===s.ConfigConstant.ROOT_TEAM_ID?J:K,holdToDisplay:-1,ref:t,collect:me,teamId:e.teamId,teamTitle:e.teamName,memberCount:e.memberCount,parentId:e.parentId,children:[(0,i.jsx)(u.u,{title:e.teamName,placement:"bottomLeft",textEllipsis:!0,children:(0,i.jsx)("div",{children:e.teamName})}),U&&e.teamId===s.ConfigConstant.ROOT_TEAM_ID&&(0,i.jsx)("span",{onClick:function(e){return ce(e,t)},style:{visibility:"visible"},children:(0,i.jsx)(c.AddOutlined,{})}),U&&e.teamId!==s.ConfigConstant.ROOT_TEAM_ID&&(0,i.jsx)("span",{onClick:function(e){return ce(e,t)},children:(0,i.jsx)(c.MoreOutlined,{})})]}),isLeaf:!e.hasChildren,children:e.children&&e.children.length>0&&ae(e.children)},e.teamId)})):(0,i.jsx)(i.Fragment,{})},se=function(e){if(U&&e){var n={teamId:e.teamId,parentId:e.parentId,teamTitle:e.teamTitle,memberCount:e.memberCount};t(s.StoreActions.updateRightClickTeamInfoInSpace(n))}},re=function(e,t){C((function(){se(t),O(!0)}),T)},le=function(){u.u_.warning({title:(0,s.t)(s.Strings.watch_out),content:(0,s.t)(s.Strings.warning_exists_sub_team_or_member)})},oe=function(e){u.u_.confirm({title:(0,s.t)(s.Strings.hint),content:(0,s.t)(s.Strings.confirm_del_current_team),onOk:function(){h&&s.Api.deleteTeam(e).then((function(e){e.data.success?(t(s.StoreActions.getTeamListDataInSpace(g,h)),u.v0.success({content:(0,s.t)(s.Strings.del_team_success)})):u.v0.error({content:(0,s.t)(s.Strings.delete_team_fail)})}))},type:"warning",maskClosable:!0})},ce=function(e,t){t.current&&t.current.handleContextClick(e)},me=function(e){return{teamId:e.teamId,teamTitle:e.teamTitle,parentId:e.parentId,memberCount:e.memberCount}},de=a.useMemo((function(){var e=function(e){var t=e.onClick;return(0,i.jsx)(o.Button,{color:"primary",prefixIcon:D?(0,i.jsx)(o.Loading,{}):(0,i.jsx)(c.UserGroupOutlined,{size:16}),onClick:t,className:Z().inviteOutsiderBtn,disabled:D,children:(0,s.t)(s.Strings.fresh_dingtalk_org)})};if((0,s.isIdassPrivateDeployment)())return e({onClick:function(){W(!0),T&&(null===v.freshIdaasOrg||void 0===v.freshIdaasOrg||(0,v.freshIdaasOrg)().then((function(){W(!1)})))}});if(A||R){var t,n=(t={},(0,r.Z)(t,s.ConfigConstant.SocialType.DINGTALK,v.freshDingtalkOrg),(0,r.Z)(t,s.ConfigConstant.SocialType.WECOM,v.freshWecomOrg),t);return e({onClick:function(){var e;W(!0),T&&(null===(e=n[T.social.platform])||void 0===e||e.call(n).then((function(){W(!1)})))}})}return b&&b.permissions.includes(s.ConfigConstant.PermissionCode.MEMBER)?(0,i.jsx)(o.Button,{color:"primary",prefixIcon:(0,i.jsx)(c.UserGroupOutlined,{size:16}),className:Z().inviteOutsiderBtn,onClick:function(){return(0,_.Wu)({resUpdate:function(){ie(s.ConfigConstant.ROOT_TEAM_ID)}})},children:(0,s.t)(s.Strings.invite_member)}):null}),[A,D,ie,b,R,T]);return(0,i.jsxs)("div",{className:Z().addressTreeMenuWrapper,children:[(0,i.jsxs)("div",{className:Z().searchTitle,children:[(0,s.t)(s.Strings.members_setting),(0,i.jsx)("div",{onClick:function(e){(0,S.UW)(e),P(!0)},children:(0,i.jsx)(c.SearchOutlined,{})})]}),(0,i.jsxs)("div",{className:Z().originContent,style:{filter:B?s.ConfigConstant.GLASS_FILTER:"none"},children:[de,(0,i.jsx)("div",{className:Z().treeWrapper,children:d.length>0&&(0,i.jsx)(H,{onSelect:function(t,n){var i=n.node;if(e.setSearchMemberRes([]),i.props.title){var a=i.props.title.props.teamId;ie(a)}},switcherIcon:(0,i.jsx)("div",{children:(0,i.jsx)(c.TriangleRightFilled,{size:12})}),selectedKeys:[Y],showIcon:!1,expandAction:!1,defaultExpandedKeys:[s.ConfigConstant.ROOT_TEAM_ID],onExpand:function(e,n){if(n.expanded&&!n.node.children){var i=e[e.length-1];t(s.StoreActions.getSubTeam(i))}},children:ae(d)})})]}),B&&(0,i.jsx)(u.mr,{setInSearch:function(e){return P(e)},teamClick:function(e){ie(e)},memberClick:function(t){ie(s.ConfigConstant.ROOT_TEAM_ID),s.Api.getMemberInfo({memberId:t}).then((function(t){var n=t.data,i=n.success,a=n.data;if(i){var s=(0,l.Z)({},a);delete s.tags,s.teams=a.teams.map((function(e){return e.teamName})).join(","),e.setSearchMemberRes([s])}}))},top:"24px"}),j&&(0,i.jsx)(M,{setModalVisible:function(e){return k(e)}}),E&&(0,i.jsx)(y,{setModalVisible:function(e){return O(e)}}),U&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(z,{id:K,children:[(0,i.jsxs)(G,{onClick:re,children:[(0,i.jsx)(c.AddOutlined,{}),(0,s.t)(s.Strings.add_team)]}),(0,i.jsxs)(G,{onClick:function(e,t){C((function(){se(t),k(!0)}),T)},children:[(0,i.jsx)(c.EditOutlined,{}),(0,s.t)(s.Strings.rename_team)]}),(0,i.jsxs)(G,{onClick:function(e,t){C((function(){se(t),t&&s.Api.readTeam(t.teamId).then((function(e){var t=e.data,n=t.success,i=t.data;n&&(i.hasChildren||i.memberCount>0?le():oe(i.teamId))}))}),T)},children:[(0,i.jsx)(c.DeleteOutlined,{}),(0,s.t)(s.Strings.delete_team)]})]}),(0,i.jsx)(z,{id:J,children:(0,i.jsxs)(G,{onClick:re,children:[(0,i.jsx)(c.AddOutlined,{}),(0,s.t)(s.Strings.add_team)]})})]})]})},Q=n(231396),X=n(629931),Y=n.n(X),$=n(498125),ee=n(661788),te=n.n(ee),ne=function(e){var t=e.style;return(0,i.jsx)("div",{className:te().loadingWrapper,style:t,children:(0,i.jsx)($.Z,{tip:(0,s.t)(s.Strings.loading),indicator:(0,i.jsx)(c.LoadingOutlined,{size:24,className:"circle-loading"})})})},ie=n(310263),ae=n.n(ie),se=n(860644),re=n(71510),le=n.n(re),oe=n(304262),ce=function(e){var t=e.record;return t.isActive?null:(0,i.jsx)(u.gn,{type:"warning",content:(0,s.t)(s.Strings.send_again_toast),onOk:function(){return function(e){s.Api.reSendInvite(e.email).then((function(e){var t=e.data,n=t.success,i=t.message;n?u.v0.success({content:(0,s.t)(s.Strings.operate_success)}):u.v0.error({content:i})}))}(t)},trigger:"click",children:(0,i.jsx)(c.InfoCircleOutlined,{})})},me=function(e){var t=e.prevBtnClick,n=e.prevBtnText,a=void 0===n?(0,s.t)(s.Strings.edit):n,r=e.nextBtnClick,l=e.nextBtnText,c=void 0===l?(0,s.t)(s.Strings.remove_from_the_team):l,m=e.disabledNextBtn,d=e.hideNextBtn;return(0,i.jsxs)("div",{className:le().operateCol,children:[(0,i.jsx)(o.TextButton,{size:"x-small",color:"primary",onClick:t,children:a}),!d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:le().line,children:"|"}),(0,i.jsx)(o.TextButton,{size:"x-small",color:"danger",onClick:r,disabled:m,children:c})]})]})},de=n(664044),ue=n.n(de),_e=function(e){var t=(0,a.useRef)(null),n=(0,f.T)(),r=(0,a.useState)(1),m=r[0],d=r[1],_=(0,a.useState)(0),S=_[0],g=_[1],b=(0,I.useSelector)((function(e){return{spaceId:e.space.activeId||"",selectedTeamInfoInSpace:e.spaceMemberManage.selectedTeamInfoInSpace,selectMemberListInSpace:e.spaceMemberManage.selectMemberListInSpace,selectedRows:e.spaceMemberManage.selectedRows,memberListInSpace:e.spaceMemberManage.memberListInSpace,user:e.user.info,spaceResource:e.spacePermissionManage.spaceResource,spaceInfo:e.space.curSpaceInfo}}),I.shallowEqual),h=b.selectedTeamInfoInSpace,T=b.selectMemberListInSpace,C=b.memberListInSpace,y=b.selectedRows,M=b.user,k=b.spaceResource,N=b.spaceInfo,E=(0,p.EP)().updateMemberListInSpace,O=(0,p.ee)().removeMember,R=(0,a.useState)(!1),L=R[0],D=R[1],W=N&&(null===v.isSocialPlatformEnabled||void 0===v.isSocialPlatformEnabled?void 0:(0,v.isSocialPlatformEnabled)(N))&&(null===v.isSocialDingTalk||void 0===v.isSocialDingTalk?void 0:(0,v.isSocialDingTalk)(N))&&(null===v.isSocialWecom||void 0===v.isSocialWecom?void 0:(0,v.isSocialWecom)(N)),w=h&&h.teamId===s.ConfigConstant.ROOT_TEAM_ID,P=a.useCallback((function(e){return M&&x(e,M.memberId)}),[M]);(0,a.useEffect)((function(){d(1),U(!1),G(!0),H(!0)}),[null===h||void 0===h?void 0:h.teamId]);var F=a.useCallback((function(){if(t.current){var e=t.current.clientHeight-45;g(e)}}),[]),Z=(0,a.useState)(!0),z=Z[0],G=Z[1],V=(0,a.useState)(!0),q=V[0],H=V[1],K=(0,a.useState)(!1),J=K[0],U=K[1];(0,a.useLayoutEffect)((function(){F()})),a.useEffect((function(){return window.addEventListener("resize",F),function(){window.removeEventListener("resize",F)}}),[F]);var Q=a.useCallback((function(e){return(null===v.isSocialFeiShu||void 0===v.isSocialFeiShu?void 0:(0,v.isSocialFeiShu)(N))||w&&P(e)||h&&h.teamId===s.ConfigConstant.ROOT_TEAM_ID}),[P,w,h,N]),X=function(e){var t=e.map((function(e){return e.memberId}));u.u_.confirm({title:(0,s.t)(s.Strings.kindly_reminder),content:(0,s.t)(s.Strings.remove_from_team_confirm_tip),onOk:function(){return Y(t)},type:"danger"})},Y=function(e){O({teamId:h.teamId,memberIdArr:e,isDeepDel:!1,resFunc:function(){return $(e)}})},$=function(e){if(d(1),1!==e.length)n(s.StoreActions.updateSelectMemberListInSpace([]));else{var t=T.filter((function(t){return t!==e[0]}));n(s.StoreActions.updateSelectMemberListInSpace(t))}},ee=(0,A.Sy)(),te=[{title:(0,s.t)(s.Strings.edit_member_name),dataIndex:"memberName",key:"memberName",align:"center",render:function(e,t){return function(e,t,n){var a=t.isPrimary,r=t.isSubAdmin,l=t.isActive,o=t.isMemberNameModified,c=(null===v.getSocialWecomUnitName||void 0===v.getSocialWecomUnitName?void 0:(0,v.getSocialWecomUnitName)({name:e,isModified:o,spaceInfo:n}))||e;if(!l)return(0,i.jsxs)("span",{children:[c||(0,s.t)(s.Strings.record_unnamed),(0,i.jsx)(ce,{record:t})]});var m=a||r;return(0,i.jsxs)("span",{className:le().nameColRender,children:[(0,i.jsx)(u.u,{title:c,textEllipsis:!0,children:(0,i.jsx)("div",{className:le().tipText,children:c})}),m&&(0,i.jsx)(oe.i,{type:a?"mainAdmin":"subAdmin",className:le().identity})]})}(e,t,N)},filterDropdown:function(){return(0,i.jsx)(o.List,{data:[{title:(0,s.t)(s.Strings.joined_members),onClick:function(){G(!z);var e=q?z?"0":void 0:z?"-1":"1";"-1"===e?U(!0):(U(!1),E(h.teamId,1,e,h),d(1))},isSelected:z},{title:(0,s.t)(s.Strings.not_joined_members),onClick:function(){H(!q);var e=z?q?"1":void 0:q?"-1":"0";"-1"===e?U(!0):(U(!1),E(h.teamId,1,e,h),d(1))},isSelected:q}],renderItem:function(e,t){return(0,i.jsxs)("div",{onClick:e.onClick,className:ue().listItem,children:[e.title,e.isSelected&&(0,i.jsx)(c.CheckOutlined,{size:16,color:o.lightColors.primaryColor})]},t)}})},filterIcon:(0,i.jsx)(c.FilterOutlined,{})},{title:(0,s.t)(s.Strings.team),dataIndex:"teamData",key:"teamData",align:"center",render:function(e){var t=e?e.map((function(e){return e.fullHierarchyTeamName})).join(" & "):[],n=e?e.map((function(e,t){return(0,i.jsxs)("div",{className:ue().teamItem,children:[(0,i.jsx)("p",{children:"-"}),(0,i.jsx)("p",{children:e.fullHierarchyTeamName})]},t)})):"";return(0,i.jsx)(u.u,{title:n,rowsNumber:2,textEllipsis:!0,overflowWidth:200,showTipAnyway:!0,children:(0,i.jsx)("span",{className:ue().tipText,children:t||h.teamTitle})})}},{title:(0,s.t)(s.Strings.email),dataIndex:"email",key:"email",align:"center",ellipsis:!0},{title:(0,s.t)(s.Strings.operate),dataIndex:"operate",key:"operate",align:"center",render:function(e,t){return(0,i.jsx)(me,{prevBtnClick:function(){return function(e){D(!0),n(s.StoreActions.getEditMemberInfo(e.memberId))}(t)},hideNextBtn:Boolean(Q(t)),nextBtnClick:function(){return function(e){X([e])}(t)},disabledNextBtn:Boolean(w)})}}];ee.USER_BIND_PHONE_VISIBLE&&te.splice(2,0,{title:(0,s.t)(s.Strings.phone_number),dataIndex:"mobile",key:"mobile",align:"center",ellipsis:!0}),(0,s.isIdassPrivateDeployment)()&&(te.length=te.length-1);var ne={columns:k&&k.permissions.includes(s.ConfigConstant.PermissionCode.MEMBER)&&!W?te:te.filter((function(e,t){return t!==te.length-1})),dataSource:J?[]:e.searchMemberRes.length>0?e.searchMemberRes:C,rowSelection:W?void 0:{selectedRowKeys:T,selectedRows:y,onChange:function(e,t){n(s.StoreActions.updateSelectMemberListInSpace(e)),n(s.StoreActions.updateSelectedRowsInSpace(t))},columnWidth:40},rowKey:function(e){return String(e.orderNo)}},ie=Boolean(h&&h.memberCount&&h.memberCount>s.ConfigConstant.MEMBER_LIST_PAGE_SIZE);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:ue().memberTable,ref:t,children:(0,i.jsx)(se.Z,(0,j.Z)((0,l.Z)({},ne),{pagination:!1,rowKey:function(e){return String(e.memberId)},scroll:{y:S}}))}),ie&&(0,i.jsx)(o.Pagination,{current:m,total:(null===h||void 0===h?void 0:h.memberCount)||0,pageSize:s.ConfigConstant.MEMBER_LIST_PAGE_SIZE,onChange:function(e){var t=q?z?void 0:"0":"1";E(h.teamId,e,t,h),d(e)},className:ue().pagination}),L&&(0,i.jsx)(B,{cancelModalVisible:function(){D(!1)},removeCallback:function(){d(1),e.setSearchMemberRes([])},pageNo:m})]})},pe=function(e){var t,n=(0,a.useState)(1),r=n[0],l=n[1],c=(0,a.useState)(!1),m=c[0],d=c[1],_=(0,a.useState)(!1),f=_[0],S=_[1],g=(0,a.useState)(!1),b=g[0],h=g[1],T=(0,I.useDispatch)(),y=(0,I.useSelector)((function(e){return{selectedTeamInfoInSpace:e.spaceMemberManage.selectedTeamInfoInSpace,selectMemberListInSpace:e.spaceMemberManage.selectMemberListInSpace,selectedRows:e.spaceMemberManage.selectedRows,memberListInSpace:e.spaceMemberManage.memberListInSpace,user:e.user.info,spaceResource:e.spacePermissionManage.spaceResource,spaceInfo:e.space.curSpaceInfo,teamListInSpace:e.spaceMemberManage.teamListInSpace}}),I.shallowEqual),M=y.teamListInSpace,j=y.selectedTeamInfoInSpace,k=y.selectMemberListInSpace,N=y.selectedRows,E=y.spaceResource,O=y.user,A=y.spaceInfo,R=A&&(null===v.isSocialPlatformEnabled||void 0===v.isSocialPlatformEnabled?void 0:(0,v.isSocialPlatformEnabled)(A))&&!(null===v.isSocialDingTalk||void 0===v.isSocialDingTalk?void 0:(0,v.isSocialDingTalk)(A))&&!(null===v.isSocialWecom||void 0===v.isSocialWecom?void 0:(0,v.isSocialWecom)(A)),L=(0,p.ee)().removeMember,W=(null===M||void 0===M||null===(t=M[0])||void 0===t?void 0:t.teamId)||s.ConfigConstant.ROOT_TEAM_ID,w=j&&j.teamId===W,F=a.useCallback((function(e){return O&&x(e,O.memberId)}),[O]),Z=((null===v.isSocialDingTalk||void 0===v.isSocialDingTalk?void 0:(0,v.isSocialDingTalk)(A))||(null===v.isSocialWecom||void 0===v.isSocialWecom?void 0:(0,v.isSocialWecom)(A)))&&(null===v.isContactSyncing||void 0===v.isContactSyncing?void 0:(0,v.isContactSyncing)(A));(0,a.useEffect)((function(){l(1)}),[j]);var z=function(e){L({teamId:j.teamId,memberIdArr:e,isDeepDel:!1,resFunc:function(){return G(e)}})},G=function(e){if(l(1),1!==e.length)T(s.StoreActions.updateSelectMemberListInSpace([]));else{var t=k.filter((function(t){return t!==e[0]}));T(s.StoreActions.updateSelectMemberListInSpace(t))}},V=j&&j.teamId===W;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:ae().teamInfo,children:[j&&(0,i.jsxs)("div",{className:ae().selectTeamInfo,children:[(0,i.jsx)(u.u,{title:j.teamTitle,placement:"bottomLeft",textEllipsis:!0,children:(0,i.jsx)("div",{className:ae().selectTeam,children:j.teamTitle})}),j&&(0,i.jsxs)("span",{children:["\uff08",j.memberCount,(0,s.t)(s.Strings.person),"\uff09"]})]}),Z&&(0,i.jsx)(o.Alert,{type:"default",content:(0,s.t)(s.Strings.dingtalk_admin_contact_syncing_tips),style:{marginTop:24}}),(0,i.jsxs)("div",{className:ae().tableWrap,children:[E&&E.permissions.includes(s.ConfigConstant.PermissionCode.MEMBER)&&j&&!(0,s.isIdassPrivateDeployment)()&&(0,i.jsxs)("div",{className:ae().btnWTopTable,children:[!V&&!R&&(0,i.jsx)(o.Button,{onClick:function(){C((function(){h(!0)}),A)},children:(0,s.t)(s.Strings.add_member)}),V&&!R&&(0,i.jsx)(o.Button,{onClick:function(){C((function(){S(!0)}),A)},disabled:!k.length,children:(0,s.t)(s.Strings.distribute_a_team)}),!V&&!R&&(0,i.jsx)(o.Button,{onClick:function(){C((function(){w&&N.some((function(e){return F(e)}))?u.u_.warning({title:(0,s.t)(s.Strings.warning),content:(0,s.t)(s.Strings.warning_can_not_remove_yourself_or_primary_admin),okText:(0,s.t)(s.Strings.got_it),type:"warning"}):function(e){var t=e.map((function(e){return e.memberId}));u.u_.confirm({title:(0,s.t)(s.Strings.kindly_reminder),content:(0,s.t)(s.Strings.remove_from_team_confirm_tip),onOk:function(){return z(t)},type:"danger"})}(N)}),A)},variant:"jelly",color:"danger",disabled:!k.length,children:(0,s.t)(s.Strings.batch_remove)})]}),(0,i.jsx)(_e,{searchMemberRes:e.searchMemberRes,setSearchMemberRes:e.setSearchMemberRes})]})]}),m&&(0,i.jsx)(B,{cancelModalVisible:function(){d(!1)},removeCallback:function(){l(1)},pageNo:r}),!b&&f&&(0,i.jsx)(D,{onCancel:function(){return S(!1)},inEditMember:!1}),b&&(0,i.jsx)(P,{onCancel:function(){return h(!1)}})]})},fe=Q.Z,Se=function(){var e=(0,a.useState)(!1),t=e[0],n=e[1],r=(0,a.useState)([]),l=r[0],o=r[1];return(0,m.Z)((function(){s.Player.doTrigger(s.Events.space_setting_member_manage_shown)})),(0,i.jsx)("div",{className:Y().memberManageWrapper,children:(0,i.jsxs)(fe,{minSize:199,maxSize:800,defaultSize:199,className:Y().spaceMemberSplit,children:[(0,i.jsx)(U,{setSearchMemberRes:function(e){return o(e)},setRightLoading:n}),t?(0,i.jsx)("div",{className:Y().loading,children:(0,i.jsx)(ne,{})}):(0,i.jsx)(pe,{searchMemberRes:l,setSearchMemberRes:o})]})})},ge=Se},34577:function(e){e.exports={memberTag:"style_memberTag__vrlOF",primaryTag:"style_primaryTag__bR4HB",subTag:"style_subTag__2hGvF",inactiveTag:"style_inactiveTag__MS__h"}},661788:function(e){e.exports={loadingWrapper:"style_loadingWrapper__jomOF"}},664044:function(e){e.exports={antiEllipsis:"style_antiEllipsis__N0WJN",noSelect:"style_noSelect__D_Qqy",antSelectOptionCommon:"style_ant-select-option-common__71pvk",flexCenter:"style_flexCenter__Gh5QA",inputErrorMsg:"style_inputErrorMsg__Aq8nW",tree:"style_tree__9Kwtk",lightTree:"style_lightTree__BWanl",darkTree:"style_darkTree__Ph3ze",memberTable:"style_memberTable__HJyUR",pagination:"style_pagination__8Y11q",listItem:"style_listItem__Ilmuk",tipText:"style_tipText__78tbP",teamItem:"style_teamItem__wg1if"}},554037:function(e){e.exports={antiEllipsis:"style_antiEllipsis__r794w",noSelect:"style_noSelect__eGjJ9",antSelectOptionCommon:"style_ant-select-option-common__Jy_FB",flexCenter:"style_flexCenter__kjc08",inputErrorMsg:"style_inputErrorMsg__JNY3W",tree:"style_tree__0TDsP",lightTree:"style_lightTree__1Fsyh",darkTree:"style_darkTree__fLSms",adjustMemberModal:"style_adjustMemberModal__ABJMV",portrait:"style_portrait__0agL4",item:"style_item__LJ9QM",content:"style_content___nano",wecomLayer:"style_wecomLayer__REDkZ",label:"style_label__X3nD8",err:"style_err__HKf6R",deptItem:"style_deptItem__AMQMC",teamWrapper:"style_teamWrapper__h25pP",teamText:"style_teamText__ntBJ1",teamRemoveIcon:"style_teamRemoveIcon__bbo0I",addBtn:"style_addBtn__XhW_y"}},629931:function(e){e.exports={antiEllipsis:"style_antiEllipsis__BTMzb",noSelect:"style_noSelect__egNdW",antSelectOptionCommon:"style_ant-select-option-common__uPjki",flexCenter:"style_flexCenter__hg_t8",inputErrorMsg:"style_inputErrorMsg__CqaZL",tree:"style_tree__IUwvW",lightTree:"style_lightTree__5jux8",darkTree:"style_darkTree__Lt5X_",memberManageWrapper:"style_memberManageWrapper__F2avK",loading:"style_loading__VMRpq",spaceMemberSplit:"style_spaceMemberSplit__RdWuD"}},310263:function(e){e.exports={antiEllipsis:"style_antiEllipsis___8CXr",noSelect:"style_noSelect__JRPKS",antSelectOptionCommon:"style_ant-select-option-common__GgqIk",flexCenter:"style_flexCenter__ZmZNT",inputErrorMsg:"style_inputErrorMsg__gYXy3",tree:"style_tree__YEqHb",lightTree:"style_lightTree__JkPf_",darkTree:"style_darkTree__uRvHl",teamInfo:"style_teamInfo__d7CFi",selectTeamInfo:"style_selectTeamInfo__xv_f8",selectTeam:"style_selectTeam__oG6Sd",tableWrap:"style_tableWrap__93dGy",btnWTopTable:"style_btnWTopTable__18BvD"}},495823:function(e){e.exports={antiEllipsis:"style_antiEllipsis__acjbK",noSelect:"style_noSelect__I1rgQ",antSelectOptionCommon:"style_ant-select-option-common__qxOWJ",flexCenter:"style_flexCenter__uYMFO",inputErrorMsg:"style_inputErrorMsg__0I03S",tree:"style_tree__ijjZz",lightTree:"style_lightTree__H5T9b",darkTree:"style_darkTree__symz2",addressTreeMenuWrapper:"style_addressTreeMenuWrapper__bJi_G",originContent:"style_originContent__bfC_2",inviteOutsiderBtn:"style_inviteOutsiderBtn__ulfiy",treeWrapper:"style_treeWrapper__IRcqK",searchTitle:"style_searchTitle__IwtJQ",portrait:"style_portrait__Gc6iO",inviteBtn:"style_inviteBtn__C2lC9"}},71510:function(e){e.exports={antiEllipsis:"style_antiEllipsis__hff1h",noSelect:"style_noSelect__2We3Z",antSelectOptionCommon:"style_ant-select-option-common__Qd7Y_",flexCenter:"style_flexCenter__Png2f",inputErrorMsg:"style_inputErrorMsg__8z_VZ",tree:"style_tree__lQMCy",lightTree:"style_lightTree__v4V_u",darkTree:"style_darkTree__b_ORB",nameColRender:"style_nameColRender__LFGtB",tipText:"style_tipText__D8Pzi",identity:"style_identity__16ghe",operateCol:"style_operateCol__5jlHo",line:"style_line__W18K6"}}}]);