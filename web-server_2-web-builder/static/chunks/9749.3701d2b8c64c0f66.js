(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9749,1158],{573145:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return oe}});var n,s=a(798788),r=a(745680),i=a(552322),l=a(323440),o=a(39663),c=a(208155),m=a(158519),p=a(914463),d=a(862183),u=a(773941),_=a(864453),g=a(178234),h=a(202784),y=a(829051),f=a(351253),v=a(809800),x=a(781958),I=a(907682),N=a(472670),j=a.n(N),T=a(276635),C=a(996577),E=a.n(C),b=a(451331),A=a(736367),L=a(49096),M=a(585421),S=a(384577),k=a(117763),W=a(101450),F=a(511445),P=(a(192294),a(965348)),B=a.n(P),O=a(347842),w=a(165846),R=a(72779),D=a.n(R),Z=a(647917),G=a(648123),H=a(125947),q=a(52907),U=a(423769),K=h.createElement,z=function(e){return K("svg",(0,U.Z)({viewBox:"0 0 68 26",xmlSpace:"preserve",width:"1em",height:"1em"},e),K("path",{d:"M0 26v-6c7.5 0 14-4.4 17.1-10.7C20.6 3.7 26.9 0 34 0s13.4 3.7 16.9 9.3C54 15.6 60.5 20 68 20v6H0z"}))},J=a(262812),X=a.n(J);!function(e){e.BANNER="banner",e.CARD="card"}(n||(n={}));var Y=200,Q=function(e){var t,a=(0,f.useThemeColors)(),s=e.img,r=e.name,o=e.description,m=e.templateId,p=e.creator,d=e.deleteTemplate,u=e.usingTemplate,_=e.nodeType,g=e.onClick,v=e.bannerDesc,x=e.tags,I=e.height,N=void 0===I?160:I,j=e.type,T=void 0===j?n.BANNER:j,C=e.isOfficial,E=void 0===C||C,b=e.bannerType,A=void 0===b?l.ConfigConstant.BannerType.LARGE:b,L=(0,h.useState)(!1),M=L[0],S=L[1],k=(0,y.useSelector)((function(e){return{user:e.user.info,spaceResource:e.spacePermissionManage.spaceResource}}),y.shallowEqual),W=k.user,F=k.spaceResource,P=function(){S(!1),m&&d&&d(m)},B=function(){S(!1),null===u||void 0===u||u(m)},R=Boolean(u||d),U=function(e){var t=JSON.parse(e),a="",n=0;if(t.hasOwnProperty("blocks")){var s=!0,r=!1,i=void 0;try{for(var l,o=t.blocks[Symbol.iterator]();!(s=(l=o.next()).done);s=!0){var c=l.value;if("paragraph"===c.type&&n<=Y){if(c.data.text.length+a.length>Y)return a+=c.data.text.slice(0,Y-n);a+=c.data.text,n+=c.data.text.length}}}catch(m){r=!0,i=m}finally{try{s||null==o.return||o.return()}finally{if(r)throw i}}}else"string"===typeof t.text?a=t.text.slice(0,Y):"string"===typeof t.data&&(a=t.data.replace(/<\/?.+?>/g,"").slice(0,Y));return a},K=function(e){var t=JSON.parse(e),a="",n=0;if(t.data&&Array.isArray(t.data.ops)){var s=!0,r=!1,i=void 0;try{for(var l,o=t.data.ops[Symbol.iterator]();!(s=(l=o.next()).done);s=!0){var c=l.value;if(!c.attributes&&n<=Y){if(c.insert.length+a.length>Y)return a+=c.insert.slice(0,Y-n);a+=c.insert,n+=c.insert.length}}}catch(m){r=!0,i=m}finally{try{s||null==o.return||o.return()}finally{if(r)throw i}}}else"string"===typeof t.render&&(a=t.render.replace(/<\/?.+?>/g,"").slice(0,Y));return a};return(0,i.jsxs)("div",{className:D()(X().templateItem,(0,O.Z)({},X().card,T==n.CARD)),onClick:function(e){g&&g({event:e,templateId:m})},children:[R&&(0,i.jsx)("div",{onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},children:(0,i.jsx)(c.d,{minWidthCompatible:c._.md,children:(0,i.jsx)(q.l,{className:X().moreBtnWrapper,showPopup:M,setShowPopup:S,popup:function(){var e=!E&&((null===W||void 0===W?void 0:W.isMainAdmin)||(null===F||void 0===F?void 0:F.permissions.includes(l.ConfigConstant.PermissionCode.TEMPLATE))||p&&p.userId===(null===W||void 0===W?void 0:W.uuid));return(0,i.jsxs)("div",{className:X().moreContextMenu,children:[(0,i.jsxs)("div",{className:X().contextMenuItem,onClick:B,children:[(0,i.jsx)(w.PlanetOutlined,{className:X().icon}),(0,i.jsx)("div",{className:X().name,children:(0,l.t)(l.Strings.use_the_template)})]}),e&&(0,i.jsxs)("div",{className:X().contextMenuItem,onClick:P,children:[(0,i.jsx)(w.DeleteOutlined,{className:X().icon}),(0,i.jsx)("div",{className:X().name,children:(0,l.t)(l.Strings.delete)})]})]})}(),popupStyle:{width:240,zIndex:101},popupAlign:{points:["tl","tl"],offset:[0,40],overflow:{adjustX:!0,adjustY:!0}},trigger:(0,i.jsx)(G.X,{size:"x-small",shape:"circle",shadow:!0,icon:(0,i.jsx)(w.MoreOutlined,{color:a.secondLevelText}),className:X().moreBtn})})})}),(0,i.jsxs)("div",{className:D()(X().wrapper,(t={},(0,O.Z)(t,X().banner,T===n.BANNER),(0,O.Z)(t,X().mediumBanner,A===l.ConfigConstant.BannerType.MIDDLE),t)),style:{height:"".concat(N,"px")},children:[(0,i.jsx)("div",{className:X().backgroundImage,style:{backgroundImage:"url(".concat(s,")")}}),p&&!E&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(z,{className:X().avatarBackground}),(0,i.jsx)("div",{className:X().userAvatar,"data-name":p.name,children:(0,i.jsx)(Z.qE,{id:p.userId,src:p.avatar,title:p.name,size:Z.DZ.Size32})})]}),v&&T===n.BANNER&&(0,i.jsxs)("div",{className:D()("bannerDesc",X().bannerDesc),children:[(0,i.jsx)(f.Typography,{variant:"h6",className:D()("title",X().title),style:v.color?{color:v.color}:void 0,children:v.title}),(0,i.jsx)("div",{className:D()("desc",X().desc),style:v.color?{color:v.color}:void 0,children:v.desc})]})]}),T!==n.BANNER&&(0,i.jsxs)("div",{className:X().templateInfo,children:[(0,i.jsx)(f.Typography,{variant:"h6",className:X().name,ellipsis:!0,children:r}),(0,i.jsx)(f.Typography,{className:X().desc,ellipsis:{rows:2},variant:"body3",children:o&&function(e,t){return t===l.ConfigConstant.NodeType.DATASHEET?K(e):t===l.ConfigConstant.NodeType.FOLDER?U(e):e}(o,_)}),x&&0!==x.length&&(0,i.jsx)("div",{className:X().tags,children:x.map((function(e,t){return(0,i.jsx)(H.V,{className:X().tag,children:e},t)}))})]})]})},V=a(637374),$=a.n(V),ee=(0,l.integrateCdnHost)(l.Settings.workbench_folder_default_cover_list.value.split(",")[0]),te=function(e,t){return(0,l.getImageThumbSrc)(e,{h:Math.ceil(2*t),quality:90})},ae=function(e){var t,a,n=e.setUsingTemplate,s=(0,h.useState)(),r=s[0],o=s[1],c=(0,y.useSelector)((function(e){return e.pageParams.categoryId})),m=(0,y.useSelector)((function(e){return e.space.activeId})),p=(0,h.useContext)(W.G).recommendData,d=(0,M.Sy)();(0,h.useEffect)((function(){p?o(p):l.Api.templateRecommend().then((function(e){var t=e.data,a=t.data;t.success&&o(a)}))}),[p]);var _=function(e){var t=e.templateId;u.F.push(l.Navigation.TEMPLATE,{params:{spaceId:m,templateId:t,categoryId:c||l.ConfigConstant.TEMPLATE_CHOICE_CATEGORY_ID}})},g=function(e){var t=e.templateId;u.F.push(l.Navigation.TEMPLATE,{params:{spaceId:m,albumId:t,categoryId:"album"}})};if(!r)return console.log({cc:r}),null;var I=(0,T.take)(r.top,(null===(t=r.top)||void 0===t?void 0:t.length)-2),N=I[0];return(0,i.jsxs)("div",{className:$().templateChoiceWrapper,children:[(0,i.jsx)(v.Z,{className:$().templateChoice,children:(0,i.jsxs)(x.Z,{span:24,children:[r.top&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:$().topBannerWrapper,id:l.TEMPLATE_CENTER_ID.TOP_HOT_BANNER,children:1===I.length?(0,i.jsx)(Q,{templateId:N.templateId,height:280,img:te(N.image,280),onClick:_,bannerDesc:{title:N.title,color:null===N||void 0===N?void 0:N.color,desc:N.desc},usingTemplate:n}):(0,i.jsx)(F.lr,{showThumbs:!1,showArrows:!1,showStatus:!1,autoPlay:!0,infiniteLoop:!0,swipeable:!0,children:I.map((function(e){return(0,i.jsx)(Q,{templateId:e.templateId,height:280,img:te(e.image,280),onClick:_,bannerDesc:{title:e.title,color:null===e||void 0===e?void 0:e.color,desc:e.desc},usingTemplate:n},e.templateId)}))})}),(0,i.jsx)("div",{className:$().recommendWrapper,children:(0,T.takeRight)(r.top,2).map((function(e){return(0,i.jsx)("div",{className:$().recommendItem,children:(0,i.jsx)(Q,{height:160,templateId:e.templateId,img:te(e.image,160),onClick:_,bannerDesc:{title:e.title,desc:e.desc},bannerType:l.ConfigConstant.BannerType.MIDDLE,usingTemplate:n})},e.image)}))})]}),null===(a=r.albumGroups)||void 0===a?void 0:a.map((function(e){return(0,i.jsx)(v.Z,{children:(0,i.jsxs)(x.Z,{span:24,className:$().category,children:[(0,i.jsx)(v.Z,{className:$().categoryName,children:(0,i.jsx)(x.Z,{span:24,children:e.name})}),(0,i.jsx)("div",{className:$().templateList,children:e.albums.map((function(e){return(0,i.jsx)("div",{className:B().albumItemWrapper,children:(0,i.jsx)(Q,{bannerDesc:{title:e.name,desc:e.description},templateId:e.albumId,height:200,img:te(e.cover||ee,200),onClick:g,isOfficial:!0})},e.albumId)}))})]})},e.name)})),r.templateGroups&&r.templateGroups.map((function(e){return(0,i.jsx)(v.Z,{children:(0,i.jsxs)(x.Z,{span:24,className:$().category,children:[(0,i.jsx)(v.Z,{className:$().categoryName,children:(0,i.jsx)(x.Z,{span:24,children:e.name})}),(0,i.jsx)("div",{className:$().templateList,children:e.templates.map((function(e){return(0,i.jsx)("div",{className:$().templateItemWrapper,children:(0,i.jsx)(Q,{templateId:e.templateId,type:"card",nodeType:e.nodeType,img:te(e.cover||ee,160),name:e.templateName,description:e.description,tags:e.tags,onClick:_,usingTemplate:n,isOfficial:!0})},e.templateId)}))})]})},e.name)}))]})}),d.TEMPLATE_FEEDBACK_FORM_URL&&!(0,M.k)()&&(0,i.jsx)(f.Typography,{className:$().notFoundTip,variant:"body2",align:"center",children:(0,i.jsx)("span",{className:$().text,onClick:function(){return(0,b.S)("".concat(d.TEMPLATE_FEEDBACK_FORM_URL))},children:(0,l.t)(l.Strings.template_not_found)})})]})},ne=(0,l.integrateCdnHost)(l.Settings.workbench_folder_default_cover_list.value.split(",")[0]),se=function(e){var t=e.setUsingTemplate,n=e.templateCategory,o=(0,h.useContext)(I.J).templateListData,c=(0,h.useState)((function(){return o||null})),m=c[0],d=c[1],g=(0,h.useState)(!0),N=g[0],C=g[1],W=(0,A.T)(),F=(0,y.useSelector)((function(e){return e.user.info})),P=(0,y.useSelector)((function(e){return e.space.activeId})),O=(0,y.useSelector)((function(e){return e.pageParams.categoryId})),w=(0,L.T)(),R=w.getTemplateCategoriesReq,D=w.getTemplateListReq,Z=w.deleteTemplateReq,G=(0,_.QT)(Z,{manual:!0}).run,H=(0,_.QT)(D,{manual:!0}),q=H.run,U=H.data,K=H.loading,z=(0,M.Sy)(),J=(0,_.QT)(R,{manual:!0}),X=J.run,Y=J.data,V=(0,y.useSelector)((function(e){return e.theme}))===f.ThemeName.Light?k.Z:S.Z;(0,h.useEffect)((function(){if("tpcprivate"===O&&F)return C(!1),q(P,"",!0),void(!F.isMainAdmin&&W(l.StoreActions.spaceResource()));C(!0),X(O)}),[O,F]),(0,h.useEffect)((function(){N&&d(Y||null),U&&!N&&d(U)}),[N,U,Y]);var $=function(e){Promise.resolve().then(a.bind(a,128680)).then((function(t){t.Modal.confirm({type:"danger",title:(0,l.t)(l.Strings.delete_template_title),content:(0,l.t)(l.Strings.delete_template_content),onOk:function(){ee(e)}})}))},ee=function(){var e=(0,s.Z)((function(e){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return m?[4,G(e)]:[2];case 1:return t.sent()&&d(m.filter((function(t){return t.templateId!==e}))),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),ae=function(e){var t=e.templateId;u.F.push(l.Navigation.TEMPLATE,{params:{spaceId:P,categoryId:O||l.ConfigConstant.TEMPLATE_CHOICE_CATEGORY_ID,templateId:t}})};if(!m||K)return null;var se=n.find((function(e){return e.categoryCode===O})),re=function(e){var t=e.templateId;u.F.push(l.Navigation.TEMPLATE,{params:{spaceId:P,albumId:t,categoryId:"album"}})};return(0,i.jsx)("div",{className:B().templateDetailWrapper,children:(0,T.isEmpty)(m)?(0,i.jsxs)("div",{className:B().listEmpty,children:[(0,i.jsx)(E(),{src:V,alt:(0,l.t)(l.Strings.template_no_template),width:320,height:240}),(0,i.jsx)("div",{className:B().text,children:j()((0,l.t)(l.Strings.how_create_template))})]}):(0,i.jsx)(v.Z,{className:B().templateCategory,children:(0,i.jsxs)(x.Z,{span:24,children:[(0,i.jsx)(v.Z,{children:(0,i.jsxs)(x.Z,{className:B().title,children:[(0,i.jsx)("div",{className:B().categoryName,children:N?se&&se.categoryName:(0,l.t)(l.Strings.all)}),z.TEMPLATE_FEEDBACK_FORM_URL&&!(0,M.k)()&&!(null===p.isWecomFunc||void 0===p.isWecomFunc?void 0:(0,p.isWecomFunc)())&&(0,i.jsx)(f.Typography,{className:B().notFoundTip,variant:"body2",align:"center",children:(0,i.jsx)("span",{className:B().text,onClick:function(){return(0,b.S)("".concat(z.TEMPLATE_FEEDBACK_FORM_URL))},children:(0,l.t)(l.Strings.template_not_found)})})]})}),(0,i.jsx)(i.Fragment,{children:Array.isArray(m)?(0,i.jsx)("div",{className:B().templateList,children:m.map((function(e){return(0,i.jsx)("div",{className:B().templateItemWrapper,children:(0,i.jsx)(Q,{type:"card",nodeType:e.nodeType,templateId:e.templateId,img:te(e.cover||ne,160),name:e.templateName,description:e.description,tags:e.tags,isOfficial:N,creator:{name:e.nickName,avatar:e.avatar,userId:e.uuid},deleteTemplate:$,usingTemplate:t,onClick:ae})},e.templateId)}))}):(0,i.jsxs)(i.Fragment,{children:[!(0,T.isEmpty)(m.albums)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:(0,l.t)(l.Strings.album)}),(0,i.jsx)("div",{className:B().templateList,children:m.albums.map((function(e){return(0,i.jsx)("div",{className:B().albumItemWrapper,children:(0,i.jsx)(Q,{bannerDesc:{title:e.name,desc:e.description},templateId:e.albumId,height:200,img:te(e.cover||ne,200),onClick:re,isOfficial:N})},e.albumId)}))})]}),!(0,T.isEmpty)(m.templates)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:(0,l.t)(l.Strings.template)}),(0,i.jsx)("div",{className:B().templateList,children:m.templates.map((function(e){return(0,i.jsx)("div",{className:B().templateItemWrapper,children:(0,i.jsx)(Q,{type:"card",nodeType:e.nodeType,templateId:e.templateId,img:te(e.cover||ne,160),name:e.templateName,description:e.description,tags:e.tags,isOfficial:N,creator:{name:e.nickName,avatar:e.avatar,userId:e.uuid},deleteTemplate:$,usingTemplate:t,onClick:ae})},e.templateId)}))})]})]})})]})})})},re=a(738167),ie=a(921705),le=a.n(ie),oe=function(){var e=(0,h.useState)(""),t=e[0],a=e[1],n=(0,h.useState)(!1),f=n[0],v=n[1],x=(0,y.useSelector)((function(e){return e.user.info})),I=(0,y.useSelector)((function(e){return e.space.activeId})),N=(0,y.useSelector)((function(e){return e.pageParams})),j=N.categoryId,T=N.templateId,C=(0,_.CL)().getLoginStatusReq,E=(0,o.Z)(C,{manual:!0}).run,b="tpcprivate"===j,A=(0,y.useSelector)((function(e){return e.templateCentre.category}));(0,h.useEffect)((function(){!t||I||x?x&&x.spaceId&&t&&!I&&u.F.push(l.Navigation.TEMPLATE,{params:{categoryId:j,templateId:t,spaceId:x.spaceId}}):u.F.redirect(l.Navigation.LOGIN)}),[t]);var L=function(){var e=(0,s.Z)((function(e,a){var n;return(0,r.__generator)(this,(function(s){switch(s.label){case 0:return e?(a===l.ConfigConstant.LoginMode.PHONE?u.F.push(l.Navigation.INVITATION_VALIDATION,{query:{token:e,reference:window.location.href}}):a===l.ConfigConstant.LoginMode.MAIL&&u.F.push(l.Navigation.IMPROVING_INFO,{query:{token:e,reference:window.location.href}}),[3,3]):[3,1];case 1:return[4,E()];case 2:if(!(n=s.sent()))return[2];u.F.push(l.Navigation.TEMPLATE,{params:{categoryId:j,templateId:t,spaceId:n.spaceId}}),s.label=3;case 3:return[2]}}))}));return function(t,a){return e.apply(this,arguments)}}(),M=function(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:le().templateList,children:[(0,i.jsx)(c.d,{maxWidthCompatible:c._.md,children:(0,i.jsx)(d.M,{})}),j===l.ConfigConstant.TEMPLATE_CHOICE_CATEGORY_ID&&!T||!j?(0,i.jsx)(ae,{setUsingTemplate:a}):(0,i.jsx)(se,{isOfficial:b,templateCategory:A||[],setUsingTemplate:a})]}),t&&x&&I&&(0,i.jsx)(re.S,{templateId:t,onCancel:a}),f&&p.LoginModal&&(0,i.jsx)(p.LoginModal,{onCancel:function(){return v(!1)},afterLogin:L})]})};return(0,i.jsxs)("div",{className:le().templatePreview,children:[(0,g.Zt)()&&(0,i.jsxs)("div",{style:{display:"none"},children:[(0,i.jsx)(m.q,{}),M()]}),(0,i.jsxs)(c.d,{minWidthCompatible:c._.md,children:[(0,i.jsx)(m.q,{}),M()]}),(0,i.jsx)(c.d,{maxWidthCompatible:c._.md,children:M()})]})}},965348:function(e){e.exports={albumItemWrapper:"style_albumItemWrapper__0tyBY",templateDetailWrapper:"style_templateDetailWrapper__3MKZq",listEmpty:"style_listEmpty__4J5EJ",text:"style_text___LYfG",templateCategory:"style_templateCategory__e7G4G",title:"style_title__3QNWG",categoryName:"style_categoryName__8n6Lb",notFoundTip:"style_notFoundTip__m5kAC",templateList:"style_templateList__tCMbr",templateItemWrapper:"style_templateItemWrapper__CNO7e"}},637374:function(e){e.exports={templateChoiceWrapper:"style_templateChoiceWrapper__oVlyN",notFoundTip:"style_notFoundTip__MW9yO",text:"style_text__3_dza",templateChoice:"style_templateChoice__1RiGK",category:"style_category__patr_",categoryName:"style_categoryName__j8sGE",topBannerWrapper:"style_topBannerWrapper__WAWT4",recommendWrapper:"style_recommendWrapper__BW2ar",recommendItem:"style_recommendItem__QHG_7",templateList:"style_templateList__st_xp",templateItemWrapper:"style_templateItemWrapper__KrWoI"}},262812:function(e){e.exports={antiEllipsis:"style_antiEllipsis__C2Gtz",noSelect:"style_noSelect__AN_8w",antSelectOptionCommon:"style_ant-select-option-common__lnuvK",flexCenter:"style_flexCenter__ZlJ0a",inputErrorMsg:"style_inputErrorMsg__qv_Nl",tree:"style_tree__1ZuUE",lightTree:"style_lightTree__H6gAY",darkTree:"style_darkTree__MdWCG",templateItem:"style_templateItem__FgBu1",card:"style_card__zzL3E",moreBtnWrapper:"style_moreBtnWrapper__HFcsH",moreBtn:"style_moreBtn__2ap1P",banner:"style_banner__8e7dN",backgroundImage:"style_backgroundImage__QU1P5",wrapper:"style_wrapper__h7XeF",avatarBackground:"style_avatarBackground__nHJPf",bannerDesc:"style_bannerDesc__lcf_C",title:"style_title__KSNXm",desc:"style_desc__aGiLT",mediumBanner:"style_mediumBanner__Km8YX",userAvatar:"style_userAvatar__Pj18J",templateInfo:"style_templateInfo__3_W_I",name:"style_name__3FkfM",tags:"style_tags__NF5He",tag:"style_tag__NbuMT",moreContextMenu:"style_moreContextMenu__gm54a",contextMenuItem:"style_contextMenuItem__jdlaO",icon:"style_icon__RWX_u"}},921705:function(e){e.exports={templatePreview:"style_templatePreview__pXs4d",headerBar:"style_headerBar___A7A8",templateList:"style_templateList__3PbjW",optBtn:"style_optBtn__HF1PV",title:"style_title__J9oEQ",sideBarMask:"style_sideBarMask__flUXd"}}}]);